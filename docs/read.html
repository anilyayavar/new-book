<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 9 Getting data in and out of R | R for Audit Analytics</title>

    <meta name="author" content="Anil Goyal" />
  
   <meta name="description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 9 Getting data in and out of R | R for Audit Analytics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://anilyayavar.github.io/new-book/" />
  <meta property="og:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <meta property="og:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Getting data in and out of R | R for Audit Analytics" />
  
  <meta name="twitter:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
  <meta name="twitter:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.8.0/transition.js"></script>
    <script src="libs/bs3compat-0.8.0/tabs.js"></script>
    <script src="libs/bs3compat-0.8.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
    <style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Audit Analytics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="read" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Getting data in and out of R</h1>
<p>Till now, we have created our own datasets or we have used sample datasets available in R. In practical usage, there will hardly be any case when we get the data imported in R by itself. So we have to import and load our data sets in R, for our analytics tasks. Even after completing the analytics, the summarised data, other reports, charts, etc. need to be exported. This chapter is intended to do all these tasks.</p>
<p>First section deals about functions related to reading external data i.e. importing objects into R. This is followed by another section dealing with writing data to external files i.e. exporting data out of R.</p>
<div id="importing-external-data-in-r---base-r-methods" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Importing external data in R - Base R methods</h2>
<p>Base R has many functions which can fulfill nearly any of our jobs to import external data into R. However, there are packages which are customised to do certain tasks in easier way and thus, we will also learn two of the packages from <code>tidyverse</code> also.</p>
<p>There are some important functions in base R, which are used frequently to import external data into R environment. Let us discuss these one by one.</p>
<div id="reading-tables-through-read.table-andor-read.csv" class="section level3 unnumbered">
<h3>Reading tables through <code>read.table()</code> and/or <code>read.csv()</code></h3>
<p>Basically these two functions are most commonly used functions in R, to get tabular data out of flat files. The two functions namely <code>read.table()</code> and <code>read.csv()</code> are used respectively to read tabular data out of flat files having simple text format (.txt) and comma separated values (.csv) formats respectively. There are three more cousins to these functions.</p>
<ul>
<li><code>read.csv2()</code> to read csv files where <code>;</code> is used as delimiter and <code>,</code> is used for decimals instead.</li>
<li><code>read.delim()</code> to read delimited files where <code>tab character</code> has been used as delimiter and <code>.</code> as decimal.</li>
<li><code>read.delim2()</code>, similarly to read delimited files where <code>tab character</code> has been used as delimiter and <code>,</code> as decimal.</li>
</ul>
<p>Most important arguments to these functions are -</p>
<ul>
<li><code>file</code> the name of the file along with complete path as string<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>.</li>
<li><code>header</code> a logical value indicating if first line of the file has to be read as header or not.</li>
<li><code>sep</code> a string indicating a separator value to separate columns.</li>
<li><code>colClasses</code> a character vector indicating type of the columns if these are to be read explicitly in these types/formats only.</li>
<li><code>skip</code> an integer, indicating how many rows (from beginning) are to be skipped.</li>
</ul>
<p>Readers may check results of <code>?read.table()</code> to get a complete list of arguments of these functions.</p>
<p>Example: Let us try to download data related to <em>World Happiness Report 201=21</em> which is available on data.world portal.</p>
<pre><code>wh2021 &lt;- read.csv(&quot;https://query.data.world/s/qbsbmxlfj54sl4mq3y6uxsr3pkhhmo&quot;)
# Check dimensions
dim(wh2021)
# Check column names
colnames(wh2021)</code></pre>
<p>We can see that dataset named <code>wh2021</code> having <code>20</code> columns and <code>149</code> rows is now available in our environment.</p>
<blockquote>
<p><strong>Tip: Use <code>"clipboard"</code> in file argument for pasting copied data into R. E.g. Copy a few rows and cells from excel spreadsheet and run this command <code>read.delim("clipboard", header = FALSE)</code>.</strong></p>
</blockquote>
</div>
<div id="read-data-into-a-vector-through-scan-or-readline" class="section level3 unnumbered">
<h3>Read data into a vector through <code>scan()</code> or <code>readline()</code></h3>
<p>As afore-mentioned functions <code>read.table()</code> <em>et al</em> are used in reading data into tables, we may also require reading data into a vector or simple list. The two functions <code>scan()</code> and <code>readline()</code> are used for these purposes.</p>
<p>The basic syntax of <code>scan()</code> is -</p>
<pre><code>scan(file = &quot;&quot;,
     what = double(),
     nmax = -1,
     ...
)</code></pre>
<p>Where -</p>
<ul>
<li><code>file</code> is name of the file, or link</li>
<li><code>what</code> is format/data type to be read. Default type is double</li>
<li><code>nmax</code> is mux number of data values to be read, default is <code>-1</code> which means all.</li>
</ul>
<p>There are many other usefule arguments, for which please check results of <code>?scan</code> in your console.</p>
<p>Example -</p>
<pre><code>scan(&quot;http://mattmahoney.net/iq/digits.txt&quot;, nmax = 10)</code></pre>
<p>This function is sometimes useful to read data from keyboard into a vector. Just use a blank string <code>""</code> in file name. See this example</p>
<p><img src="images/scan.png" /></p>
<p>Function <code>readline()</code> on the other hand does similar job, but with a prompt. See this example</p>
<p><img src="images/readline.png" /></p>
</div>
<div id="reading-text-files-through-readlines" class="section level3 unnumbered">
<h3>Reading text files through <code>readLines()</code></h3>
<p>Function <code>readLines()</code> is used to read text lines from a file (or connection). To see this in action, prepare a text file (say <code>"txt.txt"</code>) and try reading it using <code>readLines("txt.txt")</code>.</p>
</div>
</div>
<div id="exporting-data-out-of-r---base-r-methods" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Exporting data out of R - Base R methods</h2>
<p>Since the nature of most of the data anaytic jobs carried out in R, will be followed after reading the external data which will be followed by wrangling, transformation, modelling, etc., all in R. Exporting files will not be used as much as reading external data. Still, there will be times, when wrangled data tables need to be exported out of R. For each of the different use cases, the following functions will almost complete our export requirements.</p>
<p>Let’s learn these.</p>
<div id="writing-tabular-data-through-write.table-andor-write.csv" class="section level3 unnumbered">
<h3>Writing tabular data through <code>write.table()</code> and/or <code>write.csv()</code></h3>
<p>Exporting data frames, whether after cleaning, wrangling, or transformation, etc., can be exported using these functions. Latter will be used to write data frames in csv formats specifically. The syntax is -</p>
<pre><code>write.table(x, file = &quot;&quot;, sep = &quot; &quot;, ...)
write.csv(x, file = &quot;&quot;, ...)
write.csv2(x, file = &quot;&quot;, ...)</code></pre>
<p>where -</p>
<ul>
<li><code>x</code> is the data frame object to be exported</li>
<li><code>file</code> is used to give file name (along with path)</li>
<li><code>sep</code> is separator</li>
<li><code>...</code> - there are many more arguments which are used to cutomised export needs. See <code>?write.table()</code> for full details.</li>
</ul>
<p>E.g. - The following command will export <code>iris</code> data frame as <code>iris.csv</code> file in the current working directory.</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="read.html#cb708-1" tabindex="-1"></a><span class="fu">write.csv</span>(iris, <span class="st">&#39;iris.csv&#39;</span>)</span></code></pre></div>
</div>
<div id="writing-character-data-line-by-line-to-a-file-through-writelines" class="section level3 unnumbered">
<h3>Writing character data line by line to a file through <code>writeLines()</code></h3>
<p>Similar to <code>readLines</code>, function <code>writeLines()</code> will write the text data into a file with given file name. Type the following code in your console and check that a new file with name <code>my_new_file.txt</code> has been created with the given contents in your current working directory.</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="read.html#cb709-1" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="st">&quot;Andrew 25</span></span>
<span id="cb709-2"><a href="read.html#cb709-2" tabindex="-1"></a><span class="st">           Bob 45</span></span>
<span id="cb709-3"><a href="read.html#cb709-3" tabindex="-1"></a><span class="st">           Charles 56&quot;</span>, <span class="st">&quot;my_new_file.txt&quot;</span>)</span></code></pre></div>
</div>
<div id="using-dput-to-get-a-code-representation-of-r-object" class="section level3 unnumbered">
<h3>Using <code>dput()</code> to get a code representation of R object</h3>
<p>This function will output the code representation of the given R object. This function is particularly useful, when you are searching for help online and you need to give some sample data to reproduce the problem. E.g. on <a href="https://stackoverflow.com/"><em>Stack Overflow</em></a> when asking for a solution to a specific problem, <a href="https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example">reproducible data</a> needs to be furnished. Please also refer to section <a href="read.html#reprex">9.3.3</a> for more.</p>
<p>Example-1:</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="read.html#cb710-1" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Name =</span> <span class="fu">c</span>(<span class="st">&quot;Andrew&quot;</span>, <span class="st">&quot;Bob&quot;</span>, <span class="st">&quot;Charles&quot;</span>),</span>
<span id="cb710-2"><a href="read.html#cb710-2" tabindex="-1"></a>                      <span class="at">Age =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">56</span>))</span>
<span id="cb710-3"><a href="read.html#cb710-3" tabindex="-1"></a><span class="fu">dput</span>(my_data)</span></code></pre></div>
<pre><code>## structure(list(Name = c(&quot;Andrew&quot;, &quot;Bob&quot;, &quot;Charles&quot;), Age = c(25, 
## 45, 56)), class = &quot;data.frame&quot;, row.names = c(NA, -3L))</code></pre>
<p>And while reproducing someone else’s dput-</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="read.html#cb712-1" tabindex="-1"></a>now_mydata <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">list</span>(<span class="at">Name =</span> <span class="fu">c</span>(<span class="st">&quot;Andrew&quot;</span>, <span class="st">&quot;Bob&quot;</span>, <span class="st">&quot;Charles&quot;</span>), <span class="at">Age =</span> <span class="fu">c</span>(<span class="dv">25</span>, </span>
<span id="cb712-2"><a href="read.html#cb712-2" tabindex="-1"></a><span class="dv">45</span>, <span class="dv">56</span>)), <span class="at">class =</span> <span class="st">&quot;data.frame&quot;</span>, <span class="at">row.names =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="sc">-</span><span class="dv">3</span><span class="dt">L</span>))</span>
<span id="cb712-3"><a href="read.html#cb712-3" tabindex="-1"></a></span>
<span id="cb712-4"><a href="read.html#cb712-4" tabindex="-1"></a>now_mydata</span></code></pre></div>
<pre><code>##      Name Age
## 1  Andrew  25
## 2     Bob  45
## 3 Charles  56</code></pre>
</div>
</div>
<div id="using-external-packages-for-readingwriting-data" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Using external packages for reading/writing data</h2>
<div id="package-readr" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Package <code>readr</code></h3>
<p>The <code>readr</code> package<span class="citation"><a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></span> is part of core <code>tidyverse</code> and is loaded directly when we load it through <code>library(tidyverse)</code>. It provides a range of analogous functions for each of the reading functions in base R.</p>
<table>
<thead>
<tr class="header">
<th align="center">Base R</th>
<th align="center">readr</th>
<th align="left">Uses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">read.table</td>
<td align="center">read_table</td>
<td align="left">Reading table</td>
</tr>
<tr class="even">
<td align="center">read.csv</td>
<td align="center">read_csv</td>
<td align="left">Reading CSV file with comma as sep</td>
</tr>
<tr class="odd">
<td align="center">read.csv2</td>
<td align="center">read_csv2</td>
<td align="left">Reading CSV file with semi-colon as sep</td>
</tr>
<tr class="even">
<td align="center">read.delim</td>
<td align="center">read_delim</td>
<td align="left">Reading files with any delimiter</td>
</tr>
<tr class="odd">
<td align="center">read.fwf</td>
<td align="center">read_fwf</td>
<td align="left">Reading fixed width files</td>
</tr>
<tr class="even">
<td align="center">read.tsv</td>
<td align="center">read_tsv</td>
<td align="left">Reading tab delimited file</td>
</tr>
<tr class="odd">
<td align="center">--</td>
<td align="center">write_delim</td>
<td align="left">Writing files with any delimiter</td>
</tr>
<tr class="even">
<td align="center">write.csv</td>
<td align="center">write_csv</td>
<td align="left">Writing files with comma delimiter</td>
</tr>
<tr class="odd">
<td align="center">write.csv2</td>
<td align="center">write_csv2</td>
<td align="left">Writing files with semi-colon delimiter</td>
</tr>
<tr class="even">
<td align="center">--</td>
<td align="center">write_tsv</td>
<td align="left">writing a tab delimited file</td>
</tr>
</tbody>
</table>
<p>So a question may be asked here that what’s the difference between these two sets of functions. Firstly, <code>readr</code> alternatives are much faster than their base R counterparts. Secondly, it provides an informative problem report when parsing leads to unexpected results.</p>
<p>For these, check results of these examples-</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="read.html#cb714-1" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="fu">readr_example</span>(<span class="st">&quot;chickens.csv&quot;</span>))</span></code></pre></div>
<pre><code>## Rows: 5 Columns: 4
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (3): chicken, sex, motto
## dbl (1): eggs_laid
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## # A tibble: 5 × 4
##   chicken                 sex     eggs_laid motto                               
##   &lt;chr&gt;                   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;                               
## 1 Foghorn Leghorn         rooster         0 That&#39;s a joke, ah say, that&#39;s a jok…
## 2 Chicken Little          hen             3 The sky is falling!                 
## 3 Ginger                  hen            12 Listen. We&#39;ll either die free chick…
## 4 Camilla the Chicken     hen             7 Bawk, buck, ba-gawk.                
## 5 Ernie The Giant Chicken rooster         0 Put Captain Solo in the cargo hold.</code></pre>
<p>Note that the column types, while parsing the data frame, have now been printed. These column types have been guessed by <code>readr</code> actually. If the column types are not what were actually required to be parsed, then argument <code>col_types</code> may be used. We can also use <code>spec()</code> function to retrieve the data types guessed by <code>readr</code> later-on, so these can be modified and used again in <code>col_types</code> argument. See this example</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="read.html#cb717-1" tabindex="-1"></a><span class="fu">write.csv</span>(iris, <span class="st">&quot;iris.csv&quot;</span>) <span class="co">#write a dummy data</span></span>
<span id="cb717-2"><a href="read.html#cb717-2" tabindex="-1"></a><span class="fu">spec</span>(<span class="fu">read_csv</span>(<span class="st">&quot;iris.csv&quot;</span>))</span></code></pre></div>
<pre><code>## New names:
## Rows: 150 Columns: 6
## ── Column specification
## ──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; chr
## (1): Species dbl (5): ...1, Sepal.Length, Sepal.Width, Petal.Length,
## Petal.Width
## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
## Specify the column types or set `show_col_types = FALSE` to quiet this message.
## • `` -&gt; `...1`</code></pre>
<pre><code>## cols(
##   ...1 = col_double(),
##   Sepal.Length = col_double(),
##   Sepal.Width = col_double(),
##   Petal.Length = col_double(),
##   Petal.Width = col_double(),
##   Species = col_character()
## )</code></pre>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="read.html#cb720-1" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">&quot;iris.csv&quot;</span>,</span>
<span id="cb720-2"><a href="read.html#cb720-2" tabindex="-1"></a>         <span class="at">col_select =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb720-3"><a href="read.html#cb720-3" tabindex="-1"></a>         <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb720-4"><a href="read.html#cb720-4" tabindex="-1"></a>           <span class="at">Sepal.Length =</span> <span class="fu">col_double</span>(),</span>
<span id="cb720-5"><a href="read.html#cb720-5" tabindex="-1"></a>           <span class="at">Sepal.Width =</span> <span class="fu">col_double</span>(),</span>
<span id="cb720-6"><a href="read.html#cb720-6" tabindex="-1"></a>           <span class="at">Petal.Length =</span> <span class="fu">col_double</span>(),</span>
<span id="cb720-7"><a href="read.html#cb720-7" tabindex="-1"></a>           <span class="at">Petal.Width =</span> <span class="fu">col_double</span>(),</span>
<span id="cb720-8"><a href="read.html#cb720-8" tabindex="-1"></a>           <span class="at">Species =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;setosa&#39;</span>, <span class="st">&#39;versicolor&#39;</span>, <span class="st">&#39;virginica&#39;</span>))</span>
<span id="cb720-9"><a href="read.html#cb720-9" tabindex="-1"></a>         )</span>
<span id="cb720-10"><a href="read.html#cb720-10" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...1`</code></pre>
<pre><code>## # A tibble: 2 × 5
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
## 1          5.1         3.5          1.4         0.2 setosa 
## 2          4.9         3            1.4         0.2 setosa</code></pre>
</div>
<div id="package-readxl" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Package <code>readxl</code></h3>
<p>This package is also part of <code>tidyverse</code> but this one has to be loaded specifically using <code>library(readxl)</code>. As the name suggests, it has functions which are useful to read/write data to/from excel files. Excel files (having extension .xls or .xlsx) are slightly different in a way that these may contain several <em>sheets</em> of data at once. The functions <code>read_excel()</code>, <code>read_xlsx</code>, and <code>read_xls</code> have been designed for reading sheets from excel files. The syntax is</p>
<pre><code>read_excel(path, sheet = NULL, range = NULL)
read_xlsx(path, sheet = NULL, range = NULL)
read_xls(path, sheet = NULL, range = NULL)</code></pre>
<p>To get the names of sheets in an excel file we can use <code>excel_sheets()</code> function from the library.</p>
<pre><code>excel_sheets(path)</code></pre>
</div>
<div id="reprex" class="section level3" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Package <code>reprex</code></h3>
<p>This is again part of tidyverse, but has to be loaded specifically by calling <code>library(reprex)</code>. The name <code>reprex</code> is actually short for reproducible example. This is useful particularly when we are stuck in some problem and seek for online help on some forum such as <a href="https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example">Stack Overflow</a>, <a href="https://community.rstudio.com">R Studio Community</a>, etc.</p>
<p>As an example do this in your console</p>
<pre><code>library(reprex)

x &lt;- dput(head(iris))
x</code></pre>
<p>Thereafter run <code>reprex()</code>, a small window in the <code>Viewer</code> tab will be opened like this. Moreover, the code has been copied on the clipboard.</p>
<p><img src="images/reprex.png" /></p>
<p>For more reading please refer <a href="https://www.tidyverse.org/help/">this page.</a><a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p>If backward slash <code>\</code> is used in file paths, these must be <code>escaped</code> as R recognises <code>\</code> as escape character itself. So, <code>"my/location/here/file.txt"</code> and <code>"my\\file\\here\\file.txt"</code> are the correct way of giving file name<a href="read.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>Hadley Wickham, Jim Hester, and Jennifer Bryan, <em>Readr: Read Rectangular Text Data</em>, 2024, <a href="https://readr.tidyverse.org">https://readr.tidyverse.org</a>.<a href="read.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p><a href="https://www.tidyverse.org/help/" class="uri">https://www.tidyverse.org/help/</a><a href="read.html#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Audit Analytics</strong>" was written by Anil Goyal. It was last built on 2024-11-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
