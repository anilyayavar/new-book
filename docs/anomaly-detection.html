<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 25 Anomaly Detection | Data Analytics in Audit, using R</title>
  <meta name="description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly baseR and Tidyverse." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 25 Anomaly Detection | Data Analytics in Audit, using R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly baseR and Tidyverse." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 25 Anomaly Detection | Data Analytics in Audit, using R" />
  
  <meta name="twitter:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly baseR and Tidyverse." />
  

<meta name="author" content="Anil Goyal" />


<meta name="date" content="2024-04-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="finding-string-similarity.html"/>
<link rel="next" href="data-envelopment-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analytics in Audit using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-not-just-a-letter"><i class="fa fa-check"></i>R, not just a letter</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i>Why R?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-author.html"><a href="about-author.html"><i class="fa fa-check"></i>About author</a></li>
<li class="chapter" data-level="" data-path="gearing-up.html"><a href="gearing-up.html"><i class="fa fa-check"></i>Gearing up</a>
<ul>
<li class="chapter" data-level="0.1" data-path="gearing-up.html"><a href="gearing-up.html#download-and-installation"><i class="fa fa-check"></i><b>0.1</b> Download and installation</a></li>
<li class="chapter" data-level="0.2" data-path="gearing-up.html"><a href="gearing-up.html#writing-your-first-code"><i class="fa fa-check"></i><b>0.2</b> Writing your first code</a></li>
<li class="chapter" data-level="0.3" data-path="gearing-up.html"><a href="gearing-up.html#remember"><i class="fa fa-check"></i><b>0.3</b> Remember</a></li>
<li class="chapter" data-level="0.4" data-path="gearing-up.html"><a href="gearing-up.html#r-studio-ide"><i class="fa fa-check"></i><b>0.4</b> R studio IDE</a></li>
<li class="chapter" data-level="0.5" data-path="gearing-up.html"><a href="gearing-up.html#packages-and-libraries"><i class="fa fa-check"></i><b>0.5</b> Packages and libraries</a>
<ul>
<li class="chapter" data-level="0.5.1" data-path="gearing-up.html"><a href="gearing-up.html#double-colon-operator"><i class="fa fa-check"></i><b>0.5.1</b> Double Colon operator <code>::</code></a></li>
</ul></li>
<li class="chapter" data-level="0.6" data-path="gearing-up.html"><a href="gearing-up.html#help"><i class="fa fa-check"></i><b>0.6</b> Getting Help within R</a></li>
<li class="chapter" data-level="0.7" data-path="gearing-up.html"><a href="gearing-up.html#tidyverse"><i class="fa fa-check"></i><b>0.7</b> tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-basic-r-programming-concepts.html"><a href="part-i-basic-r-programming-concepts.html"><i class="fa fa-check"></i>Part-I: Basic R Programming Concepts</a></li>
<li class="chapter" data-level="1" data-path="r-programming-language.html"><a href="r-programming-language.html"><i class="fa fa-check"></i><b>1</b> R Programming Language</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-programming-language.html"><a href="r-programming-language.html#calculator"><i class="fa fa-check"></i><b>1.1</b> Use R as a calculator</a></li>
<li class="chapter" data-level="1.2" data-path="r-programming-language.html"><a href="r-programming-language.html#basic-concepts"><i class="fa fa-check"></i><b>1.2</b> Basic Concepts</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="r-programming-language.html"><a href="r-programming-language.html#object-assignment"><i class="fa fa-check"></i><b>1.2.1</b> Object Assignment</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-programming-language.html"><a href="r-programming-language.html#atomic-data-types-in-r"><i class="fa fa-check"></i><b>1.3</b> Atomic data types in R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="r-programming-language.html"><a href="r-programming-language.html#logical"><i class="fa fa-check"></i><b>1.3.1</b> Logical</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-programming-language.html"><a href="r-programming-language.html#integer"><i class="fa fa-check"></i><b>1.3.2</b> Integer</a></li>
<li class="chapter" data-level="1.3.3" data-path="r-programming-language.html"><a href="r-programming-language.html#double"><i class="fa fa-check"></i><b>1.3.3</b> Double</a></li>
<li class="chapter" data-level="1.3.4" data-path="r-programming-language.html"><a href="r-programming-language.html#string"><i class="fa fa-check"></i><b>1.3.4</b> Character</a></li>
<li class="chapter" data-level="1.3.5" data-path="r-programming-language.html"><a href="r-programming-language.html#null"><i class="fa fa-check"></i><b>1.3.5</b> NULL</a></li>
<li class="chapter" data-level="1.3.6" data-path="r-programming-language.html"><a href="r-programming-language.html#complex"><i class="fa fa-check"></i><b>1.3.6</b> Complex</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-programming-language.html"><a href="r-programming-language.html#data-structuresobject-types-in-r"><i class="fa fa-check"></i><b>1.4</b> Data structures/Object Types in R</a>
<ul>
<li class="chapter" data-level="" data-path="r-programming-language.html"><a href="r-programming-language.html#homogeneous-objects"><i class="fa fa-check"></i>Homogeneous objects</a></li>
<li class="chapter" data-level="1.4.1" data-path="r-programming-language.html"><a href="r-programming-language.html#vectors"><i class="fa fa-check"></i><b>1.4.1</b> Vectors</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-programming-language.html"><a href="r-programming-language.html#matrix-matrices"><i class="fa fa-check"></i><b>1.4.2</b> Matrix (Matrices)</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-programming-language.html"><a href="r-programming-language.html#arrays"><i class="fa fa-check"></i><b>1.4.3</b> Arrays</a></li>
<li class="chapter" data-level="" data-path="r-programming-language.html"><a href="r-programming-language.html#heterogeneous-objects"><i class="fa fa-check"></i>Heterogeneous objects</a></li>
<li class="chapter" data-level="1.4.4" data-path="r-programming-language.html"><a href="r-programming-language.html#lists"><i class="fa fa-check"></i><b>1.4.4</b> Lists</a></li>
<li class="chapter" data-level="1.4.5" data-path="r-programming-language.html"><a href="r-programming-language.html#data-frame"><i class="fa fa-check"></i><b>1.4.5</b> Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-programming-language.html"><a href="r-programming-language.html#other-data-types"><i class="fa fa-check"></i><b>1.5</b> Other Data types</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="r-programming-language.html"><a href="r-programming-language.html#factors"><i class="fa fa-check"></i><b>1.5.1</b> Factors</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-programming-language.html"><a href="r-programming-language.html#date"><i class="fa fa-check"></i><b>1.5.2</b> Date</a></li>
<li class="chapter" data-level="1.5.3" data-path="r-programming-language.html"><a href="r-programming-language.html#date-time-posixct"><i class="fa fa-check"></i><b>1.5.3</b> Date-time (<code>POSIXct</code>)</a></li>
<li class="chapter" data-level="1.5.4" data-path="r-programming-language.html"><a href="r-programming-language.html#duration-difftime"><i class="fa fa-check"></i><b>1.5.4</b> Duration (<code>difftime</code>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="subset.html"><a href="subset.html"><i class="fa fa-check"></i><b>2</b> Subsetting R objects or accesing specific elements</a>
<ul>
<li class="chapter" data-level="2.1" data-path="subset.html"><a href="subset.html#subsetting-vectors"><i class="fa fa-check"></i><b>2.1</b> Subsetting vectors</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="subset.html"><a href="subset.html#subsetting-through-a-vector-of-positive-integers"><i class="fa fa-check"></i><b>2.1.1</b> Subsetting through a vector of positive integers</a></li>
<li class="chapter" data-level="2.1.2" data-path="subset.html"><a href="subset.html#subsetting-through-a-vector-of-negative-integers"><i class="fa fa-check"></i><b>2.1.2</b> Subsetting through a vector of negative integers</a></li>
<li class="chapter" data-level="2.1.3" data-path="subset.html"><a href="subset.html#subsetting-through-a-logical-vector"><i class="fa fa-check"></i><b>2.1.3</b> Subsetting through a logical vector</a></li>
<li class="chapter" data-level="2.1.4" data-path="subset.html"><a href="subset.html#subsetting-through-a-character-vector"><i class="fa fa-check"></i><b>2.1.4</b> Subsetting through a character vector</a></li>
<li class="chapter" data-level="2.1.5" data-path="subset.html"><a href="subset.html#subsetting-through-nothing"><i class="fa fa-check"></i><b>2.1.5</b> Subsetting through nothing</a></li>
<li class="chapter" data-level="2.1.6" data-path="subset.html"><a href="subset.html#subsetting-through-zero"><i class="fa fa-check"></i><b>2.1.6</b> Subsetting through Zero</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="subset.html"><a href="subset.html#subsetting-matrices-and-arrays"><i class="fa fa-check"></i><b>2.2</b> Subsetting Matrices and arrays</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="subset.html"><a href="subset.html#indexing-through-multiple-vectors"><i class="fa fa-check"></i><b>2.2.1</b> Indexing through Multiple vectors</a></li>
<li class="chapter" data-level="2.2.2" data-path="subset.html"><a href="subset.html#subsetting-through-one-vector"><i class="fa fa-check"></i><b>2.2.2</b> Subsetting through one vector</a></li>
<li class="chapter" data-level="2.2.3" data-path="subset.html"><a href="subset.html#subsetting-through-a-matrix"><i class="fa fa-check"></i><b>2.2.3</b> Subsetting through a matrix</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="subset.html"><a href="subset.html#subsetting-lists"><i class="fa fa-check"></i><b>2.3</b> Subsetting lists</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="subset.html"><a href="subset.html#subsetting-lists-with"><i class="fa fa-check"></i><b>2.3.1</b> Subsetting lists with <code>[]</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="subset.html"><a href="subset.html#subsetting-lists-with-1"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting lists with <code>[[]]</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="subset.html"><a href="subset.html#chaining-or-multiple-subsetting"><i class="fa fa-check"></i><b>2.3.3</b> Chaining or multiple subsetting</a></li>
<li class="chapter" data-level="2.3.4" data-path="subset.html"><a href="subset.html#subsetting-with"><i class="fa fa-check"></i><b>2.3.4</b> Subsetting with <code>$</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="subset.html"><a href="subset.html#data-frames"><i class="fa fa-check"></i><b>2.4</b> Data frames</a></li>
<li class="chapter" data-level="2.5" data-path="subset.html"><a href="subset.html#subsetting-and-assignment"><i class="fa fa-check"></i><b>2.5</b> Subsetting and assignment</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="func.html"><a href="func.html"><i class="fa fa-check"></i><b>3</b> Functions and operations in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="func.html"><a href="func.html#cust"><i class="fa fa-check"></i><b>3.1</b> Custom Functions</a>
<ul>
<li class="chapter" data-level="" data-path="func.html"><a href="func.html#special-argument-ellipsis-..."><i class="fa fa-check"></i>Special argument ellipsis <code>...</code></a></li>
<li class="chapter" data-level="" data-path="func.html"><a href="func.html#environment-issues"><i class="fa fa-check"></i>Environment issues</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="func.html"><a href="func.html#existing-and-useful-functions-in-base-r"><i class="fa fa-check"></i><b>3.2</b> Existing and useful functions in base R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="func.html"><a href="func.html#conditions-and-logical-operatorsoperands"><i class="fa fa-check"></i><b>3.2.1</b> Conditions and logical operators/operands</a></li>
<li class="chapter" data-level="" data-path="func.html"><a href="func.html#vectorisation-of-operations-and-functions"><i class="fa fa-check"></i>Vectorisation of operations and functions</a></li>
<li class="chapter" data-level="" data-path="func.html"><a href="func.html#recycling"><i class="fa fa-check"></i>Recycling</a></li>
<li class="chapter" data-level="" data-path="func.html"><a href="func.html#handling-missing-values-na-in-these-operations"><i class="fa fa-check"></i>Handling Missing values <code>NA</code> in these operations</a></li>
<li class="chapter" data-level="" data-path="func.html"><a href="func.html#use-of-above-logical-operators-for-subsetting"><i class="fa fa-check"></i>Use of above logical operators for subsetting</a></li>
<li class="chapter" data-level="" data-path="func.html"><a href="func.html#conditions-with-ifelse"><i class="fa fa-check"></i>Conditions with <code>ifelse</code></a></li>
<li class="chapter" data-level="" data-path="func.html"><a href="func.html#functions-all-and-any"><i class="fa fa-check"></i>Functions <code>all()</code> and <code>any()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="func.html"><a href="func.html#common-arithmetical-functions"><i class="fa fa-check"></i><b>3.3</b> Common arithmetical Functions</a>
<ul>
<li class="chapter" data-level="" data-path="func.html"><a href="func.html#missing-values"><i class="fa fa-check"></i>Missing values</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="func.html"><a href="func.html#some-statistical-functions"><i class="fa fa-check"></i><b>3.4</b> Some Statistical functions</a></li>
<li class="chapter" data-level="3.5" data-path="func.html"><a href="func.html#prob"><i class="fa fa-check"></i><b>3.5</b> Functions related to sampling and probability distributions</a></li>
<li class="chapter" data-level="3.6" data-path="func.html"><a href="func.html#other-mathematical-functions"><i class="fa fa-check"></i><b>3.6</b> Other Mathematical functions</a></li>
<li class="chapter" data-level="3.7" data-path="func.html"><a href="func.html#string-manipulation-functions"><i class="fa fa-check"></i><b>3.7</b> String Manipulation functions</a></li>
<li class="chapter" data-level="3.8" data-path="func.html"><a href="func.html#other-functions"><i class="fa fa-check"></i><b>3.8</b> Other functions</a></li>
<li class="chapter" data-level="3.9" data-path="func.html"><a href="func.html#pipes"><i class="fa fa-check"></i><b>3.9</b> Pipes</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="func.html"><a href="func.html#magrittrdplyr-pipe"><i class="fa fa-check"></i><b>3.9.1</b> Magrittr/Dplyr pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.9.2" data-path="func.html"><a href="func.html#base-r-pipe-version-4.2.0"><i class="fa fa-check"></i><b>3.9.2</b> Base R pipe <code>|&gt;</code> (Version 4.2.0 +)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="control-statements.html"><a href="control-statements.html"><i class="fa fa-check"></i><b>4</b> Control statements</a>
<ul>
<li class="chapter" data-level="4.1" data-path="control-statements.html"><a href="control-statements.html#control-flowloops"><i class="fa fa-check"></i><b>4.1</b> Control flow/Loops</a>
<ul>
<li class="chapter" data-level="" data-path="control-statements.html"><a href="control-statements.html#if-else"><i class="fa fa-check"></i><code>if else</code></a></li>
<li class="chapter" data-level="" data-path="control-statements.html"><a href="control-statements.html#for-loop"><i class="fa fa-check"></i><code>for</code> loop</a></li>
<li class="chapter" data-level="" data-path="control-statements.html"><a href="control-statements.html#while-loop"><i class="fa fa-check"></i><code>while</code> loop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functional-programming.html"><a href="functional-programming.html"><i class="fa fa-check"></i><b>5</b> Functional Programming</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functional-programming.html"><a href="functional-programming.html#what-is-functional-programming"><i class="fa fa-check"></i><b>5.1</b> What is functional programming?</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="functional-programming.html"><a href="functional-programming.html#usage-of-functional-programming-in-r"><i class="fa fa-check"></i><b>5.1.1</b> Usage of functional programming in R</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="functional-programming.html"><a href="functional-programming.html#apply-family-of-functions"><i class="fa fa-check"></i><b>5.2</b> <code>apply</code> family of functions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="functional-programming.html"><a href="functional-programming.html#function-apply"><i class="fa fa-check"></i><b>5.2.1</b> Function <code>apply()</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="functional-programming.html"><a href="functional-programming.html#function-lapply"><i class="fa fa-check"></i><b>5.2.2</b> Function <code>lapply()</code></a></li>
<li class="chapter" data-level="5.2.3" data-path="functional-programming.html"><a href="functional-programming.html#function-sapply"><i class="fa fa-check"></i><b>5.2.3</b> Function <code>sapply()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="functional-programming.html"><a href="functional-programming.html#other-loop-functions"><i class="fa fa-check"></i><b>5.3</b> Other loop functions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="functional-programming.html"><a href="functional-programming.html#function-replicate"><i class="fa fa-check"></i><b>5.3.1</b> Function <code>replicate()</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="functional-programming.html"><a href="functional-programming.html#function-split"><i class="fa fa-check"></i><b>5.3.2</b> Function <code>split()</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="functional-programming.html"><a href="functional-programming.html#tapply"><i class="fa fa-check"></i><b>5.3.3</b> <code>tapply()</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="functional-programming.html"><a href="functional-programming.html#by-function"><i class="fa fa-check"></i><b>5.3.4</b> <code>by()</code> function</a></li>
<li class="chapter" data-level="5.3.5" data-path="functional-programming.html"><a href="functional-programming.html#specifying-the-output-type-with-vapply"><i class="fa fa-check"></i><b>5.3.5</b> Specifying the output type with <code>vapply()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="functional-programming.html"><a href="functional-programming.html#purrr"><i class="fa fa-check"></i><b>5.4</b> Functional Programming in <code>purrr</code></a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="functional-programming.html"><a href="functional-programming.html#iterate-over-single-listvector-with-map_-family-of-functions"><i class="fa fa-check"></i><b>5.4.1</b> Iterate over single list/vector with <code>map_*()</code> family of functions</a></li>
<li class="chapter" data-level="5.4.2" data-path="functional-programming.html"><a href="functional-programming.html#iterate-over-two-or-more-listsvectors-using-map2_-pmap_-family"><i class="fa fa-check"></i><b>5.4.2</b> Iterate over two or more lists/vectors using <code>map2_*()</code>/ <code>pmap_*()</code> family</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualisations-in-base-r.html"><a href="visualisations-in-base-r.html"><i class="fa fa-check"></i><b>6</b> Visualisations in Base R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visualisations-in-base-r.html"><a href="visualisations-in-base-r.html#using-plot"><i class="fa fa-check"></i><b>6.1</b> Using <code>plot()</code></a></li>
<li class="chapter" data-level="6.2" data-path="visualisations-in-base-r.html"><a href="visualisations-in-base-r.html#bar-plots-using-barplot"><i class="fa fa-check"></i><b>6.2</b> Bar plots using <code>barplot()</code></a></li>
<li class="chapter" data-level="6.3" data-path="visualisations-in-base-r.html"><a href="visualisations-in-base-r.html#histograms-using-hist"><i class="fa fa-check"></i><b>6.3</b> Histograms using <code>hist()</code></a></li>
<li class="chapter" data-level="6.4" data-path="visualisations-in-base-r.html"><a href="visualisations-in-base-r.html#boxplots-and-variants-using-boxplot"><i class="fa fa-check"></i><b>6.4</b> Boxplot(s) and variants using <code>boxplot()</code></a></li>
<li class="chapter" data-level="6.5" data-path="visualisations-in-base-r.html"><a href="visualisations-in-base-r.html#saving-and-exporting-charts"><i class="fa fa-check"></i><b>6.5</b> Saving and exporting charts</a></li>
<li class="chapter" data-level="6.6" data-path="visualisations-in-base-r.html"><a href="visualisations-in-base-r.html#use-of-par"><i class="fa fa-check"></i><b>6.6</b> Use of <code>par()</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Visualisation with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#core-concepts-of-grammar-of-graphics"><i class="fa fa-check"></i><b>7.1</b> Core concepts of <strong>grammar of graphics</strong></a></li>
<li class="chapter" data-level="7.2" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#prerequisites"><i class="fa fa-check"></i><b>7.2</b> Prerequisites:</a></li>
<li class="chapter" data-level="7.3" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#ggplot2-in-action"><i class="fa fa-check"></i><b>7.3</b> GGPLOT2 in action</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#building-a-basic-plot"><i class="fa fa-check"></i><b>7.3.1</b> Building a basic plot</a></li>
<li class="chapter" data-level="7.3.2" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#more-on-aesthetics"><i class="fa fa-check"></i><b>7.3.2</b> More on Aesthetics</a></li>
<li class="chapter" data-level="7.3.3" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#geoms"><i class="fa fa-check"></i><b>7.3.3</b> More on Geoms</a></li>
<li class="chapter" data-level="7.3.4" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#faceting"><i class="fa fa-check"></i><b>7.3.4</b> Faceting</a></li>
<li class="chapter" data-level="7.3.5" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#labels"><i class="fa fa-check"></i><b>7.3.5</b> Labels</a></li>
<li class="chapter" data-level="7.3.6" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#modifying-scales"><i class="fa fa-check"></i><b>7.3.6</b> Modifying scales</a></li>
<li class="chapter" data-level="7.3.7" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#themes"><i class="fa fa-check"></i><b>7.3.7</b> Themes</a></li>
<li class="chapter" data-level="7.3.8" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#savingexporting-plots"><i class="fa fa-check"></i><b>7.3.8</b> Saving/exporting plots</a></li>
<li class="chapter" data-level="7.3.9" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#ggplot2-tips-and-other-extensionssupporting-libraries"><i class="fa fa-check"></i><b>7.3.9</b> GGPLOT2 Tips and other extensions/supporting libraries</a></li>
<li class="chapter" data-level="7.3.10" data-path="visualisation-with-ggplot2.html"><a href="visualisation-with-ggplot2.html#more-to-read"><i class="fa fa-check"></i><b>7.3.10</b> More to read</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-dealing-with-tabular-data.html"><a href="part-ii-dealing-with-tabular-data.html"><i class="fa fa-check"></i>Part-II: Dealing with tabular data</a></li>
<li class="chapter" data-level="8" data-path="read.html"><a href="read.html"><i class="fa fa-check"></i><b>8</b> Getting data in and out of R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="read.html"><a href="read.html#importing-external-data-in-r---base-r-methods"><i class="fa fa-check"></i><b>8.1</b> Importing external data in R - Base R methods</a>
<ul>
<li class="chapter" data-level="" data-path="read.html"><a href="read.html#reading-tables-through-read.table-andor-read.csv"><i class="fa fa-check"></i>Reading tables through <code>read.table()</code> and/or <code>read.csv()</code></a></li>
<li class="chapter" data-level="" data-path="read.html"><a href="read.html#read-data-into-a-vector-through-scan-or-readline"><i class="fa fa-check"></i>Read data into a vector through <code>scan()</code> or <code>readline()</code></a></li>
<li class="chapter" data-level="" data-path="read.html"><a href="read.html#reading-text-files-through-readlines"><i class="fa fa-check"></i>Reading text files through <code>readLines()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="read.html"><a href="read.html#exporting-data-out-of-r---base-r-methods"><i class="fa fa-check"></i><b>8.2</b> Exporting data out of R - Base R methods</a>
<ul>
<li class="chapter" data-level="" data-path="read.html"><a href="read.html#writing-tabular-data-through-write.table-andor-write.csv"><i class="fa fa-check"></i>Writing tabular data through <code>write.table()</code> and/or <code>write.csv()</code></a></li>
<li class="chapter" data-level="" data-path="read.html"><a href="read.html#writing-character-data-line-by-line-to-a-file-through-writelines"><i class="fa fa-check"></i>Writing character data line by line to a file through <code>writeLines()</code></a></li>
<li class="chapter" data-level="" data-path="read.html"><a href="read.html#using-dput-to-get-a-code-representation-of-r-object"><i class="fa fa-check"></i>Using <code>dput()</code> to get a code representation of R object</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="read.html"><a href="read.html#using-external-packages-for-readingwriting-data"><i class="fa fa-check"></i><b>8.3</b> Using external packages for reading/writing data</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="read.html"><a href="read.html#package-readr"><i class="fa fa-check"></i><b>8.3.1</b> Package <code>readr</code></a></li>
<li class="chapter" data-level="8.3.2" data-path="read.html"><a href="read.html#package-readxl"><i class="fa fa-check"></i><b>8.3.2</b> Package <code>readxl</code></a></li>
<li class="chapter" data-level="8.3.3" data-path="read.html"><a href="read.html#reprex"><i class="fa fa-check"></i><b>8.3.3</b> Package <code>reprex</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html"><i class="fa fa-check"></i><b>9</b> Data Transformation in <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#prerequisites-1"><i class="fa fa-check"></i><b>9.1</b> Prerequisites</a></li>
<li class="chapter" data-level="9.2" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#column-verbs"><i class="fa fa-check"></i><b>9.2</b> Column verbs</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#select"><i class="fa fa-check"></i><b>9.2.1</b> <code>select()</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#mutate"><i class="fa fa-check"></i><b>9.2.2</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="9.2.3" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#rename"><i class="fa fa-check"></i><b>9.2.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="9.2.4" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#relocate"><i class="fa fa-check"></i><b>9.2.4</b> <code>relocate()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#row-verbs"><i class="fa fa-check"></i><b>9.3</b> Row verbs</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#filter"><i class="fa fa-check"></i><b>9.3.1</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.3.2" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#slice_func"><i class="fa fa-check"></i><b>9.3.2</b> <code>slice()</code> / <code>slice_*()</code></a></li>
<li class="chapter" data-level="9.3.3" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#arrange"><i class="fa fa-check"></i><b>9.3.3</b> <code>arrange()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#group-verbs"><i class="fa fa-check"></i><b>9.4</b> Group verbs</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#group_by"><i class="fa fa-check"></i><b>9.4.1</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="9.4.2" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#summarise"><i class="fa fa-check"></i><b>9.4.2</b> <code>summarise()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#other-useful-functions-in-dplyr"><i class="fa fa-check"></i><b>9.5</b> Other Useful functions in <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#if_else"><i class="fa fa-check"></i><code>if_else()</code></a></li>
<li class="chapter" data-level="" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#case_when"><i class="fa fa-check"></i><code>case_when()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="data-transformation-in-dplyr.html"><a href="data-transformation-in-dplyr.html#window-functionsoperations"><i class="fa fa-check"></i><b>9.6</b> Window functions/operations</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html"><i class="fa fa-check"></i><b>10</b> Combining Tables/tabular data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#simple-joinsconcatenation"><i class="fa fa-check"></i><b>10.1</b> Simple joins/concatenation</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#column-binding"><i class="fa fa-check"></i><b>10.1.1</b> Column binding</a></li>
<li class="chapter" data-level="10.1.2" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#row-binding"><i class="fa fa-check"></i><b>10.1.2</b> Row binding</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#relational-joins"><i class="fa fa-check"></i><b>10.2</b> Relational joins</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#inner-joins"><i class="fa fa-check"></i><b>10.2.1</b> Inner Joins</a></li>
<li class="chapter" data-level="10.2.2" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#left-joins"><i class="fa fa-check"></i><b>10.2.2</b> Left Joins</a></li>
<li class="chapter" data-level="10.2.3" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#right-joins"><i class="fa fa-check"></i><b>10.2.3</b> Right Joins</a></li>
<li class="chapter" data-level="10.2.4" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#full-joins"><i class="fa fa-check"></i><b>10.2.4</b> Full Joins</a></li>
<li class="chapter" data-level="" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#many-to-many-joins"><i class="fa fa-check"></i>Many-to-many Joins</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#filtering-joins"><i class="fa fa-check"></i><b>10.3</b> Filtering Joins</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#semi-joins"><i class="fa fa-check"></i><b>10.3.1</b> Semi Joins</a></li>
<li class="chapter" data-level="10.3.2" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#anti-joins"><i class="fa fa-check"></i><b>10.3.2</b> Anti Joins</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#relational-but-non-equi-joins"><i class="fa fa-check"></i><b>10.4</b> Relational, but non-equi joins</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#inequality-joins"><i class="fa fa-check"></i><b>10.4.1</b> Inequality Joins</a></li>
<li class="chapter" data-level="10.4.2" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#rolling-joins"><i class="fa fa-check"></i><b>10.4.2</b> Rolling Joins</a></li>
<li class="chapter" data-level="10.4.3" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#overlap-joins"><i class="fa fa-check"></i><b>10.4.3</b> Overlap Joins</a></li>
<li class="chapter" data-level="10.4.4" data-path="combining-tablestabular-data.html"><a href="combining-tablestabular-data.html#cross-joins"><i class="fa fa-check"></i><b>10.4.4</b> Cross Joins</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="data-wrangling-in-tidyr.html"><a href="data-wrangling-in-tidyr.html"><i class="fa fa-check"></i><b>11</b> Data Wrangling in <code>tidyr</code></a>
<ul>
<li class="chapter" data-level="11.1" data-path="data-wrangling-in-tidyr.html"><a href="data-wrangling-in-tidyr.html#prerequisites-2"><i class="fa fa-check"></i><b>11.1</b> Prerequisites</a></li>
<li class="chapter" data-level="11.2" data-path="data-wrangling-in-tidyr.html"><a href="data-wrangling-in-tidyr.html#concepts-of-tidy-data"><i class="fa fa-check"></i><b>11.2</b> Concepts of tidy data</a></li>
<li class="chapter" data-level="11.3" data-path="data-wrangling-in-tidyr.html"><a href="data-wrangling-in-tidyr.html#reshaping-data"><i class="fa fa-check"></i><b>11.3</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="data-wrangling-in-tidyr.html"><a href="data-wrangling-in-tidyr.html#longer-format-through-function-pivot_longer"><i class="fa fa-check"></i><b>11.3.1</b> LONGER format through function <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="11.3.2" data-path="data-wrangling-in-tidyr.html"><a href="data-wrangling-in-tidyr.html#wider-format-through-pivot_wider"><i class="fa fa-check"></i><b>11.3.2</b> WIDER format through <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="data-wrangling-in-tidyr.html"><a href="data-wrangling-in-tidyr.html#separate-columns-into-multiple-columns-join-columns-into-one-column"><i class="fa fa-check"></i><b>11.3.3</b> Separate Column(s) into multiple columns/ Join columns into one column</a></li>
<li class="chapter" data-level="11.3.4" data-path="data-wrangling-in-tidyr.html"><a href="data-wrangling-in-tidyr.html#separate-rows-into-multiple-rows"><i class="fa fa-check"></i><b>11.3.4</b> Separate row(s) into multiple rows</a></li>
<li class="chapter" data-level="11.3.5" data-path="data-wrangling-in-tidyr.html"><a href="data-wrangling-in-tidyr.html#expand-table-to-handle-missing-rowsvalues"><i class="fa fa-check"></i><b>11.3.5</b> Expand table to handle missing rows/values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-statistics-with-r.html"><a href="part-iii-statistics-with-r.html"><i class="fa fa-check"></i>Part-III: Statistics with R</a></li>
<li class="chapter" data-level="12" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>12</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="12.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#using-base-r"><i class="fa fa-check"></i><b>12.1</b> Using base R</a></li>
<li class="chapter" data-level="12.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#dplyr-functions"><i class="fa fa-check"></i><b>12.2</b> Dplyr functions</a></li>
<li class="chapter" data-level="12.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#using-another-package-psych"><i class="fa fa-check"></i><b>12.3</b> Using another package <code>psych</code></a></li>
<li class="chapter" data-level="12.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#using-skimr"><i class="fa fa-check"></i><b>12.4</b> Using <code>skimr</code></a></li>
<li class="chapter" data-level="12.5" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#viewing-relationships-between-different-variables"><i class="fa fa-check"></i><b>12.5</b> Viewing relationships between different variables</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="probability-in-r.html"><a href="probability-in-r.html"><i class="fa fa-check"></i><b>13</b> Probability in R</a>
<ul>
<li class="chapter" data-level="13.1" data-path="probability-in-r.html"><a href="probability-in-r.html#p-set-of-functions"><i class="fa fa-check"></i><b>13.1</b> <code>p*()</code> set of functions</a></li>
<li class="chapter" data-level="13.2" data-path="probability-in-r.html"><a href="probability-in-r.html#q-set-of-functions"><i class="fa fa-check"></i><b>13.2</b> <code>q*()</code> set of functions</a></li>
<li class="chapter" data-level="13.3" data-path="probability-in-r.html"><a href="probability-in-r.html#d-set-of-functions"><i class="fa fa-check"></i><b>13.3</b> <code>d*()</code> set of functions</a></li>
<li class="chapter" data-level="13.4" data-path="probability-in-r.html"><a href="probability-in-r.html#r-set-of-functions"><i class="fa fa-check"></i><b>13.4</b> <code>r*()</code> set of functions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>14</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="linear-regression.html"><a href="linear-regression.html#basic-concepts-1"><i class="fa fa-check"></i><b>14.1</b> Basic concepts</a></li>
<li class="chapter" data-level="14.2" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression-in-r"><i class="fa fa-check"></i><b>14.2</b> Simple Linear Regression in R</a></li>
<li class="chapter" data-level="14.3" data-path="linear-regression.html"><a href="linear-regression.html#assumptions-of-linear-regression"><i class="fa fa-check"></i><b>14.3</b> Assumptions of Linear Regression</a></li>
<li class="chapter" data-level="14.4" data-path="linear-regression.html"><a href="linear-regression.html#interpreting-the-output-of-lm"><i class="fa fa-check"></i><b>14.4</b> Interpreting the output of <code>lm</code></a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="linear-regression.html"><a href="linear-regression.html#call"><i class="fa fa-check"></i><b>14.4.1</b> <code>call</code></a></li>
<li class="chapter" data-level="14.4.2" data-path="linear-regression.html"><a href="linear-regression.html#residuals"><i class="fa fa-check"></i><b>14.4.2</b> <code>Residuals</code></a></li>
<li class="chapter" data-level="14.4.3" data-path="linear-regression.html"><a href="linear-regression.html#coefficients"><i class="fa fa-check"></i><b>14.4.3</b> <code>Coefficients</code></a></li>
<li class="chapter" data-level="14.4.4" data-path="linear-regression.html"><a href="linear-regression.html#signif.-codes"><i class="fa fa-check"></i><b>14.4.4</b> <code>Signif. codes</code></a></li>
<li class="chapter" data-level="14.4.5" data-path="linear-regression.html"><a href="linear-regression.html#residual-standard-error"><i class="fa fa-check"></i><b>14.4.5</b> <code>Residual standard error</code></a></li>
<li class="chapter" data-level="14.4.6" data-path="linear-regression.html"><a href="linear-regression.html#r-squared-both-multiple-and-adjusted"><i class="fa fa-check"></i><b>14.4.6</b> <code>R-Squared</code> both Multiple and Adjusted</a></li>
<li class="chapter" data-level="14.4.7" data-path="linear-regression.html"><a href="linear-regression.html#f-statistic-and-p-value"><i class="fa fa-check"></i><b>14.4.7</b> <code>F-Statistic</code> and <code>p-value</code></a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="linear-regression.html"><a href="linear-regression.html#model-evaluation-metrics"><i class="fa fa-check"></i><b>14.5</b> Model Evaluation Metrics</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="linear-regression.html"><a href="linear-regression.html#mae---mean-absolute-error"><i class="fa fa-check"></i><b>14.5.1</b> MAE - Mean Absolute Error</a></li>
<li class="chapter" data-level="14.5.2" data-path="linear-regression.html"><a href="linear-regression.html#mse---mean-square-error-and-rmse---root-mean-square-error"><i class="fa fa-check"></i><b>14.5.2</b> MSE - Mean Square Error and RMSE - Root Mean Square Error</a></li>
<li class="chapter" data-level="14.5.3" data-path="linear-regression.html"><a href="linear-regression.html#mape---mean-absolute-percentage-error"><i class="fa fa-check"></i><b>14.5.3</b> MAPE - Mean Absolute Percentage Error</a></li>
<li class="chapter" data-level="14.5.4" data-path="linear-regression.html"><a href="linear-regression.html#r---squared-and-adjusted-r-squared"><i class="fa fa-check"></i><b>14.5.4</b> R - Squared and adjusted R-squared</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="linear-regression.html"><a href="linear-regression.html#plotting-the-results-and-their-interpretion"><i class="fa fa-check"></i><b>14.6</b> Plotting the results and their interpretion</a></li>
<li class="chapter" data-level="14.7" data-path="linear-regression.html"><a href="linear-regression.html#using-lm-for-predictions"><i class="fa fa-check"></i><b>14.7</b> Using <code>lm</code> for predictions</a></li>
<li class="chapter" data-level="14.8" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>14.8</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="14.9" data-path="linear-regression.html"><a href="linear-regression.html#including-categorical-or-factor-variables-in-lm"><i class="fa fa-check"></i><b>14.9</b> Including categorical or factor variables in <code>lm</code></a>
<ul>
<li class="chapter" data-level="14.9.1" data-path="linear-regression.html"><a href="linear-regression.html#parallel-slopes-regression"><i class="fa fa-check"></i><b>14.9.1</b> Parallel slopes regression</a></li>
<li class="chapter" data-level="14.9.2" data-path="linear-regression.html"><a href="linear-regression.html#extending-multiple-linear-regression-by-including-interactions"><i class="fa fa-check"></i><b>14.9.2</b> Extending multiple linear regression by including <code>interactions</code></a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="linear-regression.html"><a href="linear-regression.html#multi-collinearity-and-variance-inflation-factor-vif"><i class="fa fa-check"></i><b>14.10</b> Multi-collinearity and Variance Inflation Factor (VIF)</a></li>
<li class="chapter" data-level="14.11" data-path="linear-regression.html"><a href="linear-regression.html#one-complete-example"><i class="fa fa-check"></i><b>14.11</b> One Complete Example</a></li>
<li class="chapter" data-level="14.12" data-path="linear-regression.html"><a href="linear-regression.html#simpsons-paradox"><i class="fa fa-check"></i><b>14.12</b> Simpson’s paradox</a></li>
<li class="chapter" data-level="14.13" data-path="linear-regression.html"><a href="linear-regression.html#conclusion-and-final-thoughts"><i class="fa fa-check"></i><b>14.13</b> Conclusion and Final thoughts</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="time-series-analysis.html"><a href="time-series-analysis.html"><i class="fa fa-check"></i><b>15</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="15.1" data-path="time-series-analysis.html"><a href="time-series-analysis.html#components-of-time-series"><i class="fa fa-check"></i><b>15.1</b> Components of Time series</a></li>
<li class="chapter" data-level="15.2" data-path="time-series-analysis.html"><a href="time-series-analysis.html#additive-or-multiplicative-components"><i class="fa fa-check"></i><b>15.2</b> Additive or multiplicative components</a></li>
<li class="chapter" data-level="15.3" data-path="time-series-analysis.html"><a href="time-series-analysis.html#practical-examples-in-r"><i class="fa fa-check"></i><b>15.3</b> Practical examples in R</a>
<ul>
<li class="chapter" data-level="" data-path="time-series-analysis.html"><a href="time-series-analysis.html#pre-requisites"><i class="fa fa-check"></i>Pre-requisites</a></li>
<li class="chapter" data-level="15.3.1" data-path="time-series-analysis.html"><a href="time-series-analysis.html#creating-a-time-series-object-in-r"><i class="fa fa-check"></i><b>15.3.1</b> Creating a time series object in R</a></li>
<li class="chapter" data-level="15.3.2" data-path="time-series-analysis.html"><a href="time-series-analysis.html#plotting-time-series-objects"><i class="fa fa-check"></i><b>15.3.2</b> Plotting Time Series Objects</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="time-series-analysis.html"><a href="time-series-analysis.html#time-series-modelling-and-forecasting"><i class="fa fa-check"></i><b>15.4</b> Time series modelling and forecasting</a>
<ul>
<li class="chapter" data-level="" data-path="time-series-analysis.html"><a href="time-series-analysis.html#data-based-techniques"><i class="fa fa-check"></i>Data-based techniques</a></li>
<li class="chapter" data-level="15.4.1" data-path="time-series-analysis.html"><a href="time-series-analysis.html#naive-method"><i class="fa fa-check"></i><b>15.4.1</b> Naive method</a></li>
<li class="chapter" data-level="15.4.2" data-path="time-series-analysis.html"><a href="time-series-analysis.html#moving-averages"><i class="fa fa-check"></i><b>15.4.2</b> Moving averages</a></li>
<li class="chapter" data-level="15.4.3" data-path="time-series-analysis.html"><a href="time-series-analysis.html#exponential-smoothing"><i class="fa fa-check"></i><b>15.4.3</b> Exponential smoothing</a></li>
<li class="chapter" data-level="" data-path="time-series-analysis.html"><a href="time-series-analysis.html#seasonal-decomposition-methods"><i class="fa fa-check"></i>Seasonal decomposition methods</a></li>
<li class="chapter" data-level="15.4.4" data-path="time-series-analysis.html"><a href="time-series-analysis.html#classical-seasonal-decomposition"><i class="fa fa-check"></i><b>15.4.4</b> Classical seasonal decomposition</a></li>
<li class="chapter" data-level="15.4.5" data-path="time-series-analysis.html"><a href="time-series-analysis.html#seasonal-and-trend-decomposition-using-loess."><i class="fa fa-check"></i><b>15.4.5</b> Seasonal and Trend decomposition using Loess.</a></li>
<li class="chapter" data-level="" data-path="time-series-analysis.html"><a href="time-series-analysis.html#model-based-techniques"><i class="fa fa-check"></i>Model-based techniques</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="time-series-analysis.html"><a href="time-series-analysis.html#plotting-different-elements-of-time-series"><i class="fa fa-check"></i><b>15.5</b> Plotting different elements of time series</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-techniques-for-auditfraud-detection.html"><a href="part-iv-techniques-for-auditfraud-detection.html"><i class="fa fa-check"></i>Part IV: Techniques for Audit/Fraud detection</a></li>
<li class="chapter" data-level="16" data-path="data-cleaning-in-r.html"><a href="data-cleaning-in-r.html"><i class="fa fa-check"></i><b>16</b> Data Cleaning in R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="data-cleaning-in-r.html"><a href="data-cleaning-in-r.html#cleaning-column-names."><i class="fa fa-check"></i><b>16.1</b> Cleaning Column names.</a></li>
<li class="chapter" data-level="16.2" data-path="data-cleaning-in-r.html"><a href="data-cleaning-in-r.html#handling-duplicate-records"><i class="fa fa-check"></i><b>16.2</b> Handling duplicate records</a></li>
<li class="chapter" data-level="16.3" data-path="data-cleaning-in-r.html"><a href="data-cleaning-in-r.html#remove-constant-redundant-columns"><i class="fa fa-check"></i><b>16.3</b> Remove Constant (Redundant) columns</a></li>
<li class="chapter" data-level="16.4" data-path="data-cleaning-in-r.html"><a href="data-cleaning-in-r.html#remove-empty-rows-andor-columns"><i class="fa fa-check"></i><b>16.4</b> Remove empty rows and/or columns</a></li>
<li class="chapter" data-level="16.5" data-path="data-cleaning-in-r.html"><a href="data-cleaning-in-r.html#fix-excel-dates-stored-as-serial-numbers"><i class="fa fa-check"></i><b>16.5</b> Fix excel dates stored as serial numbers</a></li>
<li class="chapter" data-level="16.6" data-path="data-cleaning-in-r.html"><a href="data-cleaning-in-r.html#convert-a-mix-of-date-and-datetime-formats-to-date"><i class="fa fa-check"></i><b>16.6</b> Convert a mix of date and datetime formats to date</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="random-sampling-in-r.html"><a href="random-sampling-in-r.html"><i class="fa fa-check"></i><b>17</b> Random sampling in R</a>
<ul>
<li class="chapter" data-level="" data-path="random-sampling-in-r.html"><a href="random-sampling-in-r.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="17.1" data-path="random-sampling-in-r.html"><a href="random-sampling-in-r.html#simple-random-sampling-with-and-without-replacement"><i class="fa fa-check"></i><b>17.1</b> Simple Random Sampling (With and without replacement)</a></li>
<li class="chapter" data-level="17.2" data-path="random-sampling-in-r.html"><a href="random-sampling-in-r.html#srs"><i class="fa fa-check"></i><b>17.2</b> Systematic random sampling</a></li>
<li class="chapter" data-level="17.3" data-path="random-sampling-in-r.html"><a href="random-sampling-in-r.html#probability-proportionate-to-size-with-or-without-replacement-a.k.a-monetary-unit-sampling"><i class="fa fa-check"></i><b>17.3</b> Probability Proportionate to size (with or without replacement) a.k.a monetary unit sampling</a></li>
<li class="chapter" data-level="17.4" data-path="random-sampling-in-r.html"><a href="random-sampling-in-r.html#stratified-random-sampling"><i class="fa fa-check"></i><b>17.4</b> Stratified random sampling</a></li>
<li class="chapter" data-level="17.5" data-path="random-sampling-in-r.html"><a href="random-sampling-in-r.html#cluster-sampling"><i class="fa fa-check"></i><b>17.5</b> Cluster sampling</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html"><i class="fa fa-check"></i><b>18</b> Benford Tests/Analysis</a>
<ul>
<li class="chapter" data-level="18.1" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#introduction-and-historical-context"><i class="fa fa-check"></i><b>18.1</b> Introduction and Historical context</a></li>
<li class="chapter" data-level="18.2" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#benfords-law-properties-and-extensions"><i class="fa fa-check"></i><b>18.2</b> Benford’s Law, properties and extensions</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#law-of-first-digit"><i class="fa fa-check"></i><b>18.2.1</b> Law of first digit</a></li>
<li class="chapter" data-level="18.2.2" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#scale-invariance"><i class="fa fa-check"></i><b>18.2.2</b> Scale Invariance</a></li>
<li class="chapter" data-level="18.2.3" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#first-two-digits"><i class="fa fa-check"></i><b>18.2.3</b> First two digits</a></li>
<li class="chapter" data-level="18.2.4" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#second-order-test"><i class="fa fa-check"></i><b>18.2.4</b> Second order test</a></li>
<li class="chapter" data-level="18.2.5" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#summation-test"><i class="fa fa-check"></i><b>18.2.5</b> Summation Test</a></li>
<li class="chapter" data-level="18.2.6" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#limitations-of-benford-tests"><i class="fa fa-check"></i><b>18.2.6</b> Limitations of Benford Tests</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#goodness-of-fit-metrics"><i class="fa fa-check"></i><b>18.3</b> Goodness of fit metrics</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#chis"><i class="fa fa-check"></i><b>18.3.1</b> Chi-square statistic</a></li>
<li class="chapter" data-level="18.3.2" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#z-score"><i class="fa fa-check"></i><b>18.3.2</b> Z-score</a></li>
<li class="chapter" data-level="18.3.3" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#mean-absolute-deviation"><i class="fa fa-check"></i><b>18.3.3</b> Mean absolute deviation</a></li>
<li class="chapter" data-level="18.3.4" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#other-descriptive-statistics"><i class="fa fa-check"></i><b>18.3.4</b> Other descriptive Statistics</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#important"><i class="fa fa-check"></i><b>18.4</b> Important</a></li>
<li class="chapter" data-level="18.5" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#pracben"><i class="fa fa-check"></i><b>18.5</b> Practical approach in R</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#other-useful-functions-in-package"><i class="fa fa-check"></i><b>18.5.1</b> Other Useful functions in package</a></li>
<li class="chapter" data-level="18.5.2" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#example-2-corporate-payments-data"><i class="fa fa-check"></i><b>18.5.2</b> Example-2: Corporate payments data</a></li>
<li class="chapter" data-level="18.5.3" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#example-3-lakes-perimeter"><i class="fa fa-check"></i><b>18.5.3</b> Example-3: Lakes Perimeter</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="benford-testsanalysis.html"><a href="benford-testsanalysis.html#conclusion-2"><i class="fa fa-check"></i><b>18.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="finding-duplicates.html"><a href="finding-duplicates.html"><i class="fa fa-check"></i><b>19</b> Finding duplicates</a>
<ul>
<li class="chapter" data-level="" data-path="finding-duplicates.html"><a href="finding-duplicates.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="dup_net.html"><a href="dup_net.html"><i class="fa fa-check"></i><b>20</b> Network analysis</a>
<ul>
<li class="chapter" data-level="20.1" data-path="dup_net.html"><a href="dup_net.html#relatedconnected-entities---case--ii"><i class="fa fa-check"></i><b>20.1</b> Related/Connected Entities - case -II</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="detecting-gaps-in-sequences.html"><a href="detecting-gaps-in-sequences.html"><i class="fa fa-check"></i><b>21</b> Detecting gaps in sequences</a>
<ul>
<li class="chapter" data-level="21.1" data-path="detecting-gaps-in-sequences.html"><a href="detecting-gaps-in-sequences.html#when-sequence-numbers-are-available-as-numeric-column"><i class="fa fa-check"></i><b>21.1</b> When sequence numbers are available as <code>numeric</code> column</a></li>
<li class="chapter" data-level="21.2" data-path="detecting-gaps-in-sequences.html"><a href="detecting-gaps-in-sequences.html#when-sequence-numbers-are-available-as-character-column"><i class="fa fa-check"></i><b>21.2</b> When sequence numbers are available as <code>character()</code> column</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="merging-large-number-of-similar-datasets-into-one.html"><a href="merging-large-number-of-similar-datasets-into-one.html"><i class="fa fa-check"></i><b>22</b> Merging large number of similar datasets into one</a>
<ul>
<li class="chapter" data-level="22.1" data-path="merging-large-number-of-similar-datasets-into-one.html"><a href="merging-large-number-of-similar-datasets-into-one.html#case-1-merging-multiple-excel-sheets-into-one-data-frame"><i class="fa fa-check"></i><b>22.1</b> <strong>Case-1</strong>: Merging multiple excel sheets into one data frame</a></li>
<li class="chapter" data-level="22.2" data-path="merging-large-number-of-similar-datasets-into-one.html"><a href="merging-large-number-of-similar-datasets-into-one.html#case-2-merging-multiple-files-into-one-data-frame"><i class="fa fa-check"></i><b>22.2</b> <strong>Case-2</strong>: Merging multiple files into one data frame</a></li>
<li class="chapter" data-level="22.3" data-path="merging-large-number-of-similar-datasets-into-one.html"><a href="merging-large-number-of-similar-datasets-into-one.html#case-3-split-and-save-one-data-frame-into-multiple-excelcsv-files-simultaneously."><i class="fa fa-check"></i><b>22.3</b> <strong>Case-3</strong>: Split and save one data frame into multiple excel/csv files simultaneously.</a></li>
<li class="chapter" data-level="22.4" data-path="merging-large-number-of-similar-datasets-into-one.html"><a href="merging-large-number-of-similar-datasets-into-one.html#case-4-splitting-one-data-into-muliple-files-having-multiple-sheets"><i class="fa fa-check"></i><b>22.4</b> <strong>Case-4</strong>: Splitting one data into muliple files having multiple sheets</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="sentiment-analysis-through-word-cloud.html"><a href="sentiment-analysis-through-word-cloud.html"><i class="fa fa-check"></i><b>23</b> Sentiment Analysis through Word-Cloud</a>
<ul>
<li class="chapter" data-level="23.1" data-path="sentiment-analysis-through-word-cloud.html"><a href="sentiment-analysis-through-word-cloud.html#step-1prepare-data-and-load-libraries"><i class="fa fa-check"></i><b>23.1</b> Step-1:Prepare data and load libraries</a></li>
<li class="chapter" data-level="23.2" data-path="sentiment-analysis-through-word-cloud.html"><a href="sentiment-analysis-through-word-cloud.html#step-2-reshape-the-.txt-data-frame-into-one-column"><i class="fa fa-check"></i><b>23.2</b> Step-2: Reshape the .txt data frame into one column</a></li>
<li class="chapter" data-level="23.3" data-path="sentiment-analysis-through-word-cloud.html"><a href="sentiment-analysis-through-word-cloud.html#step-3-tokenize-the-datawords"><i class="fa fa-check"></i><b>23.3</b> Step-3: Tokenize the data/words</a></li>
<li class="chapter" data-level="23.4" data-path="sentiment-analysis-through-word-cloud.html"><a href="sentiment-analysis-through-word-cloud.html#step-4-clean-stop-words"><i class="fa fa-check"></i><b>23.4</b> Step-4: Clean stop words</a></li>
<li class="chapter" data-level="23.5" data-path="sentiment-analysis-through-word-cloud.html"><a href="sentiment-analysis-through-word-cloud.html#step-5-plotgenerate-word-cloud"><i class="fa fa-check"></i><b>23.5</b> Step-5: Plot/generate word cloud</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html"><i class="fa fa-check"></i><b>24</b> Finding string similarity</a>
<ul>
<li class="chapter" data-level="24.1" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#lexical-matching"><i class="fa fa-check"></i><b>24.1</b> Lexical matching</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#levenshtein-algorithm"><i class="fa fa-check"></i><b>24.1.1</b> Levenshtein algorithm</a></li>
<li class="chapter" data-level="24.1.2" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#hamming-distance"><i class="fa fa-check"></i><b>24.1.2</b> Hamming distance</a></li>
<li class="chapter" data-level="24.1.3" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#jaro-winkler"><i class="fa fa-check"></i><b>24.1.3</b> Jaro-Winkler</a></li>
<li class="chapter" data-level="24.1.4" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#q-gram"><i class="fa fa-check"></i><b>24.1.4</b> Q-Gram</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#phonetic-matching"><i class="fa fa-check"></i><b>24.2</b> Phonetic matching</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#soundex"><i class="fa fa-check"></i><b>24.2.1</b> Soundex</a></li>
<li class="chapter" data-level="24.2.2" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#metaphone"><i class="fa fa-check"></i><b>24.2.2</b> Metaphone</a></li>
<li class="chapter" data-level="24.2.3" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#double-metaphone"><i class="fa fa-check"></i><b>24.2.3</b> Double Metaphone</a></li>
<li class="chapter" data-level="24.2.4" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#metaphone-3"><i class="fa fa-check"></i><b>24.2.4</b> Metaphone 3</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="finding-string-similarity.html"><a href="finding-string-similarity.html#examples"><i class="fa fa-check"></i><b>24.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="anomaly-detection.html"><a href="anomaly-detection.html"><i class="fa fa-check"></i><b>25</b> Anomaly Detection</a>
<ul>
<li class="chapter" data-level="25.1" data-path="anomaly-detection.html"><a href="anomaly-detection.html#definition-and-types-of-anomalies"><i class="fa fa-check"></i><b>25.1</b> Definition and types of anomalies</a></li>
<li class="chapter" data-level="" data-path="anomaly-detection.html"><a href="anomaly-detection.html#anomaly-detection-in-r"><i class="fa fa-check"></i>Anomaly detection, in R</a></li>
<li class="chapter" data-level="25.2" data-path="anomaly-detection.html"><a href="anomaly-detection.html#by-inspection"><i class="fa fa-check"></i><b>25.2</b> By inspection</a></li>
<li class="chapter" data-level="25.3" data-path="anomaly-detection.html"><a href="anomaly-detection.html#grubbs-test"><i class="fa fa-check"></i><b>25.3</b> Grubb’s Test</a></li>
<li class="chapter" data-level="25.4" data-path="anomaly-detection.html"><a href="anomaly-detection.html#seasonal-hybrid-esd-algorithm"><i class="fa fa-check"></i><b>25.4</b> Seasonal Hybrid ESD Algorithm</a></li>
<li class="chapter" data-level="25.5" data-path="anomaly-detection.html"><a href="anomaly-detection.html#k-nearest-neighbour-distance-score"><i class="fa fa-check"></i><b>25.5</b> k-Nearest Neighbour Distance Score</a></li>
<li class="chapter" data-level="25.6" data-path="anomaly-detection.html"><a href="anomaly-detection.html#local-outlier-factor"><i class="fa fa-check"></i><b>25.6</b> Local Outlier Factor</a></li>
<li class="chapter" data-level="25.7" data-path="anomaly-detection.html"><a href="anomaly-detection.html#isolation-treesforest"><i class="fa fa-check"></i><b>25.7</b> Isolation Trees/Forest</a></li>
<li class="chapter" data-level="25.8" data-path="anomaly-detection.html"><a href="anomaly-detection.html#including-categorical-variables-in-lof"><i class="fa fa-check"></i><b>25.8</b> Including categorical variables in LOF</a></li>
<li class="chapter" data-level="25.9" data-path="anomaly-detection.html"><a href="anomaly-detection.html#time-series-anomalies"><i class="fa fa-check"></i><b>25.9</b> Time Series Anomalies</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="data-envelopment-analysis.html"><a href="data-envelopment-analysis.html"><i class="fa fa-check"></i><b>26</b> Data Envelopment Analysis</a>
<ul>
<li class="chapter" data-level="26.1" data-path="data-envelopment-analysis.html"><a href="data-envelopment-analysis.html#how-it-works"><i class="fa fa-check"></i><b>26.1</b> How it works?</a></li>
<li class="chapter" data-level="26.2" data-path="data-envelopment-analysis.html"><a href="data-envelopment-analysis.html#use-cases"><i class="fa fa-check"></i><b>26.2</b> Use-cases</a></li>
<li class="chapter" data-level="26.3" data-path="data-envelopment-analysis.html"><a href="data-envelopment-analysis.html#possible-uses-in-audit"><i class="fa fa-check"></i><b>26.3</b> Possible uses in Audit</a></li>
<li class="chapter" data-level="26.4" data-path="data-envelopment-analysis.html"><a href="data-envelopment-analysis.html#a-practical-example-in-r"><i class="fa fa-check"></i><b>26.4</b> A practical example in R</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="data-envelopment-analysis.html"><a href="data-envelopment-analysis.html#pre-requisites-1"><i class="fa fa-check"></i><b>26.4.1</b> Pre-requisites</a></li>
<li class="chapter" data-level="26.4.2" data-path="data-envelopment-analysis.html"><a href="data-envelopment-analysis.html#sample-data-set"><i class="fa fa-check"></i><b>26.4.2</b> Sample data-set</a></li>
<li class="chapter" data-level="26.4.3" data-path="data-envelopment-analysis.html"><a href="data-envelopment-analysis.html#performing-dea-in-r"><i class="fa fa-check"></i><b>26.4.3</b> Performing DEA in R</a></li>
<li class="chapter" data-level="26.4.4" data-path="data-envelopment-analysis.html"><a href="data-envelopment-analysis.html#interpreting-above-results"><i class="fa fa-check"></i><b>26.4.4</b> Interpreting above results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html"><i class="fa fa-check"></i><b>27</b> Reverse geo-coding</a>
<ul>
<li class="chapter" data-level="27.1" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html#introduction"><i class="fa fa-check"></i><b>27.1</b> Introduction</a></li>
<li class="chapter" data-level="27.2" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html#widely-used-databases"><i class="fa fa-check"></i><b>27.2</b> Widely used databases</a></li>
<li class="chapter" data-level="27.3" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html#example-in-r"><i class="fa fa-check"></i><b>27.3</b> Example in R</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html#prerequisites-5"><i class="fa fa-check"></i><b>27.3.1</b> Prerequisites</a></li>
<li class="chapter" data-level="27.3.2" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html#function-to-be-used"><i class="fa fa-check"></i><b>27.3.2</b> Function to be used</a></li>
<li class="chapter" data-level="27.3.3" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html#practical-data-set"><i class="fa fa-check"></i><b>27.3.3</b> Practical data-set</a></li>
<li class="chapter" data-level="27.3.4" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html#using-it-in-a-dataset"><i class="fa fa-check"></i><b>27.3.4</b> Using it in a dataset</a></li>
<li class="chapter" data-level="27.3.5" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html#view-above-results"><i class="fa fa-check"></i><b>27.3.5</b> View above results</a></li>
<li class="chapter" data-level="27.3.6" data-path="reverse-geo-coding.html"><a href="reverse-geo-coding.html#alternate-syntax-for-those-who-do-not-want-to-use-purrrpmap_dfr"><i class="fa fa-check"></i><b>27.3.6</b> Alternate syntax (for those who do not want to use <code>purrr::pmap_dfr</code>)</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html"><i class="fa fa-check"></i><b>A</b> Regex - A quick introduction</a>
<ul>
<li class="chapter" data-level="A.1" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#basic-regex---literal-characters"><i class="fa fa-check"></i><b>A.1</b> Basic Regex - Literal Characters</a></li>
<li class="chapter" data-level="A.2" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#metacharacters"><i class="fa fa-check"></i><b>A.2</b> Metacharacters</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#character-sets"><i class="fa fa-check"></i><b>A.2.1</b> Character sets</a></li>
<li class="chapter" data-level="A.2.2" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#non-printable-characters-meta-characters-short-hand-character-classes"><i class="fa fa-check"></i><b>A.2.2</b> Non-printable characters/ Meta characters (short-hand character classes)</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#quantifiers"><i class="fa fa-check"></i><b>A.3</b> Quantifiers</a></li>
<li class="chapter" data-level="A.4" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#alternation"><i class="fa fa-check"></i><b>A.4</b> Alternation</a></li>
<li class="chapter" data-level="A.5" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#anchors"><i class="fa fa-check"></i><b>A.5</b> Anchors</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#beginning-and-end-anchors"><i class="fa fa-check"></i><b>A.5.1</b> Beginning and End Anchors</a></li>
<li class="chapter" data-level="A.5.2" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#word-boundary-anchors"><i class="fa fa-check"></i><b>A.5.2</b> Word Boundary Anchors</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#capture-groups"><i class="fa fa-check"></i><b>A.6</b> Capture Groups</a></li>
<li class="chapter" data-level="A.7" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#lookarounds"><i class="fa fa-check"></i><b>A.7</b> Lookarounds</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#lookahead"><i class="fa fa-check"></i><b>A.7.1</b> Lookahead</a></li>
<li class="chapter" data-level="A.7.2" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#lookbehind"><i class="fa fa-check"></i><b>A.7.2</b> Lookbehind</a></li>
<li class="chapter" data-level="A.7.3" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#negative-lookahead-and-lookbehinds"><i class="fa fa-check"></i><b>A.7.3</b> Negative Lookahead and Lookbehinds</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#comments"><i class="fa fa-check"></i><b>A.8</b> Comments</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#comments-within-regex"><i class="fa fa-check"></i><b>A.8.1</b> Comments within regex</a></li>
<li class="chapter" data-level="A.8.2" data-path="regex---a-quick-introduction.html"><a href="regex---a-quick-introduction.html#verbose-mode-multi-line-comments"><i class="fa fa-check"></i><b>A.8.2</b> Verbose Mode (multi-line comments)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="file.html"><a href="file.html"><i class="fa fa-check"></i><b>B</b> File handling operations in R</a>
<ul>
<li class="chapter" data-level="B.1" data-path="file.html"><a href="file.html#handling-files"><i class="fa fa-check"></i><b>B.1</b> Handling files</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="file.html"><a href="file.html#creating-a-file-within-r-using-file.create"><i class="fa fa-check"></i><b>B.1.1</b> Creating a file within R, using <code>file.create()</code></a></li>
<li class="chapter" data-level="B.1.2" data-path="file.html"><a href="file.html#checking-whether-a-file-exists-using-file.exists"><i class="fa fa-check"></i><b>B.1.2</b> Checking whether a file exists, using <code>file.exists()</code></a></li>
<li class="chapter" data-level="B.1.3" data-path="file.html"><a href="file.html#renaming-file-with-file.rename"><i class="fa fa-check"></i><b>B.1.3</b> Renaming file with <code>file.rename()</code></a></li>
<li class="chapter" data-level="B.1.4" data-path="file.html"><a href="file.html#copying-file-with-file.copy-function"><i class="fa fa-check"></i><b>B.1.4</b> Copying file with <code>file.copy()</code> function</a></li>
<li class="chapter" data-level="B.1.5" data-path="file.html"><a href="file.html#deleting-file-with-file.remove"><i class="fa fa-check"></i><b>B.1.5</b> Deleting file with <code>file.remove()</code></a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="file.html"><a href="file.html#handling-directories"><i class="fa fa-check"></i><b>B.2</b> Handling directories</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="file.html"><a href="file.html#getset-path-of-current-working-directory-using-getwd-setwd"><i class="fa fa-check"></i><b>B.2.1</b> Get/Set path of current working directory using <code>getwd()</code>/ <code>setwd()</code></a></li>
<li class="chapter" data-level="B.2.2" data-path="file.html"><a href="file.html#create-new-directory-using-dir.create-and-other-operations"><i class="fa fa-check"></i><b>B.2.2</b> Create new directory using <code>dir.create()</code> and other operations</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="file.html"><a href="file.html#an-important-function-for-opening-a-dialog-box-for-selecting-files-and-folder"><i class="fa fa-check"></i><b>B.3</b> An important function for opening a dialog box for selecting files and folder</a></li>
<li class="chapter" data-level="B.4" data-path="file.html"><a href="file.html#other-useful-functions-for-listingremoving-variables"><i class="fa fa-check"></i><b>B.4</b> Other useful functions for listing/removing variables</a></li>
<li class="chapter" data-level="B.5" data-path="file.html"><a href="file.html#using-save-to-save-objectscollection-of-objects"><i class="fa fa-check"></i><b>B.5</b> Using <code>save()</code> to save objects/collection of objects</a></li>
<li class="chapter" data-level="B.6" data-path="file.html"><a href="file.html#projects"><i class="fa fa-check"></i><b>B.6</b> Projects</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="various-datasets-in-base-r-used-in-this-book.html"><a href="various-datasets-in-base-r-used-in-this-book.html"><i class="fa fa-check"></i><b>C</b> Various Datasets, in base R, used in this book</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analytics in Audit, using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anomaly-detection" class="section level1 hasAnchor" number="25">
<h1><span class="header-section-number">Chapter 25</span> Anomaly Detection<a href="anomaly-detection.html#anomaly-detection" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Anomalies play a significant role in the field of audit. As auditors start examining data whether it be financial statements, or transactions, or other relevant data, the detection of anomalies can provide valuable insights and help identify potential issues or irregularities. Anomalies often indicate the presence of fraudulent activities. Unusual or unexpected patterns in financial transactions or account balances may suggest potential fraud or misappropriation of assets. Auditors actively search for anomalies that may indicate fraudulent behavior, such as fictitious transactions, unauthorized access, or unusual changes in financial data.</p>
<p>Anomalies in the audit context serve as indicators of potential issues, including fraud, material misstatements, control weaknesses, compliance violations, and process inefficiencies. Detecting and investigating anomalies is crucial for auditors to provide accurate and reliable financial information, enhance internal controls, and support informed decision-making by stakeholders.</p>
<div id="definition-and-types-of-anomalies" class="section level2 hasAnchor" number="25.1">
<h2><span class="header-section-number">25.1</span> Definition and types of anomalies<a href="anomaly-detection.html#definition-and-types-of-anomalies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Anomalies are patterns or data points that deviate significantly from the expected or normal behavior within a dataset. These are also known as outliers, novelties, or deviations and can provide valuable insights into unusual events or behavior in various domains.</p>
<p>Types of anomalies:</p>
<ul>
<li><p><strong>Point Anomalies:</strong> Individual data points that are considered anomalous when compared to the rest of the dataset. For example, a temperature sensor reading that is significantly different from the expected range.</p></li>
<li><p><strong>Contextual Anomalies:</strong> Data points that are considered anomalous within a specific context or subset of the dataset. For instance, a sudden increase in obsolete website traffic.</p></li>
<li><p><strong>Collective Anomalies:</strong> Groups of data points that exhibit anomalous behavior when analyzed together but might appear normal when considered individually. An example is a sudden drop in sales for multiple related products.</p></li>
</ul>
</div>
<div id="anomaly-detection-in-r" class="section level2 unnumbered hasAnchor">
<h2>Anomaly detection, in R<a href="anomaly-detection.html#anomaly-detection-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="by-inspection" class="section level2 hasAnchor" number="25.2">
<h2><span class="header-section-number">25.2</span> By inspection<a href="anomaly-detection.html#by-inspection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Several times, anomalies or outliers are detectable by observation. The <code>summary()</code> function prints the <em>maximum</em>, <em>minimum</em>, <em>upper</em> and <em>lower quartiles</em>, and the <em>mean</em> and <em>median</em>, and can give a sense for how far an extreme point lies from the rest of the data. E.g. Let’s visualise the mean annual temperatures in degrees Fahrenheit in New Haven, Connecticut, from 1912 to 1971, through a boxplot (Refer Figure <a href="anomaly-detection.html#fig:an1">25.1</a>. This data is available in base R, as <code>nhtemp</code>.</p>
<div class="sourceCode" id="cb1247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1247-1"><a href="anomaly-detection.html#cb1247-1" tabindex="-1"></a><span class="fu">summary</span>(nhtemp)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   47.90   50.58   51.20   51.16   51.90   54.60</code></pre>
<p>The easiest way to get a sense for how unusual a particular value is is by using a graphical summary like a boxplot. In R, this is created using the <code>boxplot</code> function. The <code>boxplot</code> function takes a column of values as an input argument, here illustrated with the temperature data, and produces a box and whiskers representation of the distribution of the values. The extreme values are represented as distinct points, making them easier to spot. We can also make use of ggplot2. Examples from both base R and ggplot2 are shown in Figure <a href="anomaly-detection.html#fig:an1">25.1</a>.</p>
<div class="sourceCode" id="cb1249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1249-1"><a href="anomaly-detection.html#cb1249-1" tabindex="-1"></a><span class="fu">boxplot</span>(nhtemp, <span class="at">main =</span> <span class="st">&quot;Box plot of nhtemp data&quot;</span>)</span>
<span id="cb1249-2"><a href="anomaly-detection.html#cb1249-2" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length, <span class="at">color =</span> Species )) <span class="sc">+</span></span>
<span id="cb1249-3"><a href="anomaly-detection.html#cb1249-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1249-4"><a href="anomaly-detection.html#cb1249-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1249-5"><a href="anomaly-detection.html#cb1249-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Petal Lengths in Iris Data&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an1"></span>
<img src="DauR_files/figure-html/an1-1.png" alt="Outliers through Boxplot" width="45%" /><img src="DauR_files/figure-html/an1-2.png" alt="Outliers through Boxplot" width="45%" />
<p class="caption">
Figure 25.1: Outliers through Boxplot
</p>
</div>
<p>It’s important to note that a <strong>point anomaly</strong> is not necessarily always extreme. A point anomaly can also arise as an unusual combination of values across several attributes.</p>
<p>A <strong>collective anomaly</strong>, on the other hand, is a collection of similar data instances that can be considered anomalous together when compared to the rest of the data. For example, a consecutive 5 day period of high temperatures are shown by the red points in the plot. These daily temperatures are unusual because they occur together, and are likely caused by the same underlying weather event. Refer Figure <a href="anomaly-detection.html#fig:an2">25.2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an2"></span>
<img src="DauR_files/figure-html/an2-1.png" alt="Collective Anomalies" width="672" height="27%" />
<p class="caption">
Figure 25.2: Collective Anomalies
</p>
</div>
</div>
<div id="grubbs-test" class="section level2 hasAnchor" number="25.3">
<h2><span class="header-section-number">25.3</span> Grubb’s Test<a href="anomaly-detection.html#grubbs-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We saw that visual assessment of outliers works well when the majority of data points are grouped together and rest of them lie separate. In statistics there are several tests to detect anomalies. <strong>Grubb’s Test</strong> is one of these. Grubb’s test assesses whether the point that lies farthest from the mean in a dataset could be an outlier. This point will either be the largest or smallest value in the data. This test is however based on assumption that data points are normally distributed. So before proceeding for this test, we must be sure that there is a plausible explanation for this assumption. <em>(We can check normality of data points by plotting a histogram. For other methods please refer to chapter on linear regression.)</em></p>
<p>Let’s run this test on <code>nhtemp</code> data example, which we have already seen in <a href="anomaly-detection.html#fig:an1">25.1</a> (Left). So let’s check its normality assumption.</p>
<div class="sourceCode" id="cb1250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1250-1"><a href="anomaly-detection.html#cb1250-1" tabindex="-1"></a><span class="fu">hist</span>(nhtemp, <span class="at">breaks =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an3"></span>
<img src="DauR_files/figure-html/an3-1.png" alt="Histogram for Grubb's test" width="672" height="27%" />
<p class="caption">
Figure 25.3: Histogram for Grubb’s test
</p>
</div>
<p>In figure <a href="anomaly-detection.html#fig:an3">25.3</a> we can see that our assumption is nearly satisfied. Let’s run the test.</p>
<div class="sourceCode" id="cb1251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1251-1"><a href="anomaly-detection.html#cb1251-1" tabindex="-1"></a><span class="fu">library</span>(outliers)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;outliers&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     outlier</code></pre>
<div class="sourceCode" id="cb1254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1254-1"><a href="anomaly-detection.html#cb1254-1" tabindex="-1"></a>outliers<span class="sc">::</span><span class="fu">grubbs.test</span>(nhtemp)</span></code></pre></div>
<pre><code>## 
##  Grubbs test for one outlier
## 
## data:  nhtemp
## G = 2.71806, U = 0.87266, p-value = 0.1539
## alternative hypothesis: highest value 54.6 is an outlier</code></pre>
<p>As p value is <code>0.15</code> we do not have strong evidence to reject null hypothesis that extreme maximum value is an outlier.</p>
</div>
<div id="seasonal-hybrid-esd-algorithm" class="section level2 hasAnchor" number="25.4">
<h2><span class="header-section-number">25.4</span> Seasonal Hybrid ESD Algorithm<a href="anomaly-detection.html#seasonal-hybrid-esd-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we have seen that above test may not be appropriate for anomaly detection (normality assumption as well as detection of extreme values only), particularly detecting anomalies from a time series that may have seasonal variations. We may install <code>AnomalyDetection</code> package development version from github using <code>devtools::install_github("twitter/AnomalyDetection")</code>. Example: in <code>JohnsonJohnson</code> data having quarterly sales data, we can use the following syntax.</p>
<div class="sourceCode" id="cb1256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1256-1"><a href="anomaly-detection.html#cb1256-1" tabindex="-1"></a><span class="co">#devtools::install_github(&quot;twitter/AnomalyDetection&quot;)</span></span>
<span id="cb1256-2"><a href="anomaly-detection.html#cb1256-2" tabindex="-1"></a><span class="fu">library</span>(AnomalyDetection)</span>
<span id="cb1256-3"><a href="anomaly-detection.html#cb1256-3" tabindex="-1"></a><span class="fu">AnomalyDetectionVec</span>(<span class="fu">as.vector</span>(JohnsonJohnson), </span>
<span id="cb1256-4"><a href="anomaly-detection.html#cb1256-4" tabindex="-1"></a>                    <span class="at">period =</span> <span class="dv">4</span>, <span class="co"># Sesaonality</span></span>
<span id="cb1256-5"><a href="anomaly-detection.html#cb1256-5" tabindex="-1"></a>                    <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="co"># set FALSE when plot not needed</span></span>
<span id="cb1256-6"><a href="anomaly-detection.html#cb1256-6" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="st">&#39;both&#39;</span> <span class="co"># set &#39;pos&#39; for higher values</span></span>
<span id="cb1256-7"><a href="anomaly-detection.html#cb1256-7" tabindex="-1"></a>                                       <span class="co"># or &#39;neg&#39; for lower values</span></span>
<span id="cb1256-8"><a href="anomaly-detection.html#cb1256-8" tabindex="-1"></a>                    )</span></code></pre></div>
<pre><code>## $anoms
##   index anoms
## 1    74 12.06
## 2    75 12.15
## 3    77 14.04
## 4    78 12.96
## 5    79 14.85
## 6    81 16.20
## 7    82 14.67
## 8    83 16.02
## 
## $plot</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an4"></span>
<img src="DauR_files/figure-html/an4-1.png" alt="Seasonal Hybrid ESD Algorithm" width="672" height="28%" />
<p class="caption">
Figure 25.4: Seasonal Hybrid ESD Algorithm
</p>
</div>
<p>In Figure <a href="anomaly-detection.html#fig:an4">25.4</a>, we can see that in output <code>$anoms</code> containing anomalies are denoted in blue dots.</p>
</div>
<div id="k-nearest-neighbour-distance-score" class="section level2 hasAnchor" number="25.5">
<h2><span class="header-section-number">25.5</span> k-Nearest Neighbour Distance Score<a href="anomaly-detection.html#k-nearest-neighbour-distance-score" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of greatest limitation of above two methods was that, these were applicable on univariate data series, whereas, in real world, data analysis will rarely be univariate. The <code>knn</code> technique works on multivariate data, but for visulaisation purposes, we will first visulaise the results on bivariate data only.</p>
<p><strong>K-Nearest Neighbour</strong> or <strong>KNN</strong> is a distance-based classifier, meaning that it implicitly assumes that the smaller the distance between two points, the more similar they are. For bivariate data, we can understand the algorithm by plotting the data-points in a two dimensional scatter plot. Now as the distance between any two points are usually calculated using <em>Euclidean Distance Metric</em>, we should ensure that the data is normalised/scaled before proceeding for distance calculation.</p>
<p><strong>Problem Statement-1:</strong> Let us try to identify outliers in <code>virginica</code> Species’ flower measurements. So let’s prepare the data. We will make use of <code>scale</code> function available in base R, to normalise the data. Remember that <code>scale</code> returns a matrix, so we may need to convert it into data.frame while using <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb1258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1258-1"><a href="anomaly-detection.html#cb1258-1" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb1258-2"><a href="anomaly-detection.html#cb1258-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> iris[<span class="dv">101</span><span class="sc">:</span><span class="dv">150</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb1258-3"><a href="anomaly-detection.html#cb1258-3" tabindex="-1"></a><span class="co">#  Scale the data</span></span>
<span id="cb1258-4"><a href="anomaly-detection.html#cb1258-4" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">scale</span>(df)</span></code></pre></div>
<p>Let us visualise the data (in first two dimensions only). However, as our data is scaled already, we can try to visualise all the dimensions using a boxplot. See both figures in <a href="anomaly-detection.html#fig:an5">25.5</a>. The points/ouliers have been numbered (on the basis of row numbers) for interpretaion purposes.</p>
<div class="sourceCode" id="cb1259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1259-1"><a href="anomaly-detection.html#cb1259-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb1259-2"><a href="anomaly-detection.html#cb1259-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1259-3"><a href="anomaly-detection.html#cb1259-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1259-4"><a href="anomaly-detection.html#cb1259-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Sepal.Length, Sepal.Width)) <span class="sc">+</span></span>
<span id="cb1259-5"><a href="anomaly-detection.html#cb1259-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;seagreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb1259-6"><a href="anomaly-detection.html#cb1259-6" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> row), <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>()) <span class="sc">+</span></span>
<span id="cb1259-7"><a href="anomaly-detection.html#cb1259-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb1259-8"><a href="anomaly-detection.html#cb1259-8" tabindex="-1"></a></span>
<span id="cb1259-9"><a href="anomaly-detection.html#cb1259-9" tabindex="-1"></a><span class="co"># Helper Function</span></span>
<span id="cb1259-10"><a href="anomaly-detection.html#cb1259-10" tabindex="-1"></a>find_outlier <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1259-11"><a href="anomaly-detection.html#cb1259-11" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">&lt;</span> <span class="fu">quantile</span>(x, .<span class="dv">25</span>) <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(x) <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="fu">quantile</span>(x, .<span class="dv">75</span>) <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(x))</span>
<span id="cb1259-12"><a href="anomaly-detection.html#cb1259-12" tabindex="-1"></a>}</span>
<span id="cb1259-13"><a href="anomaly-detection.html#cb1259-13" tabindex="-1"></a></span>
<span id="cb1259-14"><a href="anomaly-detection.html#cb1259-14" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb1259-15"><a href="anomaly-detection.html#cb1259-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1259-16"><a href="anomaly-detection.html#cb1259-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1259-17"><a href="anomaly-detection.html#cb1259-17" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>row, <span class="at">names_to =</span> <span class="st">&quot;Dimension&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Values&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1259-18"><a href="anomaly-detection.html#cb1259-18" tabindex="-1"></a>  <span class="fu">group_by</span>(Dimension) <span class="sc">%&gt;%</span> </span>
<span id="cb1259-19"><a href="anomaly-detection.html#cb1259-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">outlier =</span> <span class="fu">ifelse</span>(<span class="fu">find_outlier</span>(Values), row, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1259-20"><a href="anomaly-detection.html#cb1259-20" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Dimension, Values)) <span class="sc">+</span></span>
<span id="cb1259-21"><a href="anomaly-detection.html#cb1259-21" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1259-22"><a href="anomaly-detection.html#cb1259-22" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>outlier), <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">hjust=</span><span class="sc">-</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1259-23"><a href="anomaly-detection.html#cb1259-23" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an5"></span>
<img src="DauR_files/figure-html/an5-1.png" alt="Sepal Length Vs. Widths in Virginica" width="45%" /><img src="DauR_files/figure-html/an5-2.png" alt="Sepal Length Vs. Widths in Virginica" width="45%" />
<p class="caption">
Figure 25.5: Sepal Length Vs. Widths in Virginica
</p>
</div>
<p>Now, let’s proceed to identify outliers in R. We will make use of <code>get.knn</code> function from <code>FNN</code> package. However, <code>k</code> parameter is required beforehand.</p>
<div class="sourceCode" id="cb1260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1260-1"><a href="anomaly-detection.html#cb1260-1" tabindex="-1"></a><span class="co"># Load the library</span></span>
<span id="cb1260-2"><a href="anomaly-detection.html#cb1260-2" tabindex="-1"></a><span class="fu">library</span>(FNN)</span>
<span id="cb1260-3"><a href="anomaly-detection.html#cb1260-3" tabindex="-1"></a><span class="co"># get kNN object, using k = 5</span></span>
<span id="cb1260-4"><a href="anomaly-detection.html#cb1260-4" tabindex="-1"></a>viginica_knn <span class="ot">&lt;-</span> FNN<span class="sc">::</span><span class="fu">get.knn</span>(df[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">5</span>)</span></code></pre></div>
<p>The <code>knn</code> object created above will have two sub-objects (both matrices having columns equal to chosen <code>k</code>), one having nearest neighbors’ indices and another having distances from those. Let’s view their top 6 rows.</p>
<div class="sourceCode" id="cb1261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1261-1"><a href="anomaly-detection.html#cb1261-1" tabindex="-1"></a><span class="fu">head</span>(viginica_knn<span class="sc">$</span>nn.index)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]   37   16   49   11   45
## [2,]    2   15   22   35   14
## [3,]   30   40   42    8   13
## [4,]   34   27   29   33   28
## [5,]    5   17   46   38   41
## [6,]   36    8   30   23   31</code></pre>
<div class="sourceCode" id="cb1263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1263-1"><a href="anomaly-detection.html#cb1263-1" tabindex="-1"></a><span class="fu">head</span>(viginica_knn<span class="sc">$</span>nn.dist)</span></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 0.3100808 0.3476803 0.3476803 0.4416741 0.6290499
## [2,] 0.0000000 0.3100808 0.4416741 0.5645648 0.6397904
## [3,] 0.1572625 0.4416741 0.4416741 0.4416741 0.4717874
## [4,] 0.3100808 0.3476803 0.3476803 0.3476803 0.4416741
## [5,] 0.0000000 0.0000000 0.3145250 0.3476803 0.4416741
## [6,] 0.1572625 0.5645648 0.6290499 0.6397904 0.6953605</code></pre>
<p>Using <code>rowMeans</code> we can calculate mean distance for each data point. The bigger this score is, the chances of that record being an outlier are relatively higher. Let’s also store that mean distance in a variable/column say <code>score</code> in main dataset, and visualise the results by setting the point-size with this mean distance (actually its square root). In Figure <a href="anomaly-detection.html#fig:an8">25.6</a>, we may notice that points lying far away are bigger becuase their chances of being outliers is high.</p>
<div class="sourceCode" id="cb1265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1265-1"><a href="anomaly-detection.html#cb1265-1" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(viginica_knn<span class="sc">$</span>nn.dist)</span>
<span id="cb1265-2"><a href="anomaly-detection.html#cb1265-2" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb1265-3"><a href="anomaly-detection.html#cb1265-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1265-4"><a href="anomaly-detection.html#cb1265-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>(),</span>
<span id="cb1265-5"><a href="anomaly-detection.html#cb1265-5" tabindex="-1"></a>         <span class="at">score =</span> score) <span class="sc">%&gt;%</span> </span>
<span id="cb1265-6"><a href="anomaly-detection.html#cb1265-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Sepal.Length, Sepal.Width)) <span class="sc">+</span></span>
<span id="cb1265-7"><a href="anomaly-detection.html#cb1265-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> score),<span class="at">color =</span> <span class="st">&quot;seagreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb1265-8"><a href="anomaly-detection.html#cb1265-8" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> row), <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>()) <span class="sc">+</span></span>
<span id="cb1265-9"><a href="anomaly-detection.html#cb1265-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1265-10"><a href="anomaly-detection.html#cb1265-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;KNN method of outlier&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an8"></span>
<img src="DauR_files/figure-html/an8-1.png" alt="k-Nearest Neighbour Distance" width="672" height="28%" />
<p class="caption">
Figure 25.6: k-Nearest Neighbour Distance
</p>
</div>
<p>Now, we can run the algorithm to find the outlier on the basis of all variables in the dataset.</p>
<div class="sourceCode" id="cb1266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1266-1"><a href="anomaly-detection.html#cb1266-1" tabindex="-1"></a>virginica_knn <span class="ot">&lt;-</span> FNN<span class="sc">::</span><span class="fu">get.knn</span>(df, <span class="dv">5</span>)</span>
<span id="cb1266-2"><a href="anomaly-detection.html#cb1266-2" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(virginica_knn<span class="sc">$</span>nn.dist)</span>
<span id="cb1266-3"><a href="anomaly-detection.html#cb1266-3" tabindex="-1"></a><span class="co"># Which point is farthest-Outlier</span></span>
<span id="cb1266-4"><a href="anomaly-detection.html#cb1266-4" tabindex="-1"></a><span class="fu">which.max</span>(score)</span></code></pre></div>
<pre><code>## [1] 32</code></pre>
</div>
<div id="local-outlier-factor" class="section level2 hasAnchor" number="25.6">
<h2><span class="header-section-number">25.6</span> Local Outlier Factor<a href="anomaly-detection.html#local-outlier-factor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As against kNN which uses distances of k neighbors, this algorithm uses density of each data point vis-a-vis density of its nearest neighbors. kNN distance seems to be good at detecting points that are really far from their neighbors, sometimes called global anomalies, but sometimes fail to capture all of the points that might be considered anomalous like local anomalies. Local Anomalies may lie near to a cluster still they won’t be like their neighbors. To understand it better, see the plot in Figure <a href="anomaly-detection.html#fig:an9">25.7</a> consisting of dummy data.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an9"></span>
<img src="DauR_files/figure-html/an9-1.png" alt="Local Outlier factor" width="672" height="28%" />
<p class="caption">
Figure 25.7: Local Outlier factor
</p>
</div>
<p>The red points may be global outliers, being far from its immediate neigbors, yet the blue points may be local anomalies as these are not like their immediate neighbors and may be local anomalies.</p>
<p>As stated, LOF segregates the data points based on the ratio of density of that point with that of densities of its neighbors. A score <code>&gt; 1</code> thus indicates that the data point may be an anomaly. Let’s see that on same problem statement.</p>
<div class="sourceCode" id="cb1268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1268-1"><a href="anomaly-detection.html#cb1268-1" tabindex="-1"></a><span class="fu">library</span>(dbscan)</span>
<span id="cb1268-2"><a href="anomaly-detection.html#cb1268-2" tabindex="-1"></a>lof_score <span class="ot">&lt;-</span> <span class="fu">lof</span>(df, <span class="dv">5</span>)</span>
<span id="cb1268-3"><a href="anomaly-detection.html#cb1268-3" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb1268-4"><a href="anomaly-detection.html#cb1268-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1268-5"><a href="anomaly-detection.html#cb1268-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>(),</span>
<span id="cb1268-6"><a href="anomaly-detection.html#cb1268-6" tabindex="-1"></a>         <span class="at">score =</span> lof_score) <span class="sc">%&gt;%</span> </span>
<span id="cb1268-7"><a href="anomaly-detection.html#cb1268-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Sepal.Length, Sepal.Width)) <span class="sc">+</span></span>
<span id="cb1268-8"><a href="anomaly-detection.html#cb1268-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> score),<span class="at">color =</span> <span class="st">&quot;seagreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb1268-9"><a href="anomaly-detection.html#cb1268-9" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> row), <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>()) <span class="sc">+</span></span>
<span id="cb1268-10"><a href="anomaly-detection.html#cb1268-10" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">guide =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb1268-11"><a href="anomaly-detection.html#cb1268-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1268-12"><a href="anomaly-detection.html#cb1268-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;LOF method of outlier&quot;</span>)</span>
<span id="cb1268-13"><a href="anomaly-detection.html#cb1268-13" tabindex="-1"></a></span>
<span id="cb1268-14"><a href="anomaly-detection.html#cb1268-14" tabindex="-1"></a>df_prcomp <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(df, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1268-15"><a href="anomaly-detection.html#cb1268-15" tabindex="-1"></a></span>
<span id="cb1268-16"><a href="anomaly-detection.html#cb1268-16" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb1268-17"><a href="anomaly-detection.html#cb1268-17" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1268-18"><a href="anomaly-detection.html#cb1268-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>(),</span>
<span id="cb1268-19"><a href="anomaly-detection.html#cb1268-19" tabindex="-1"></a>         <span class="at">score =</span> lof_score,</span>
<span id="cb1268-20"><a href="anomaly-detection.html#cb1268-20" tabindex="-1"></a>         <span class="at">PC1 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb1268-21"><a href="anomaly-detection.html#cb1268-21" tabindex="-1"></a>         <span class="at">PC2 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1268-22"><a href="anomaly-detection.html#cb1268-22" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2)) <span class="sc">+</span></span>
<span id="cb1268-23"><a href="anomaly-detection.html#cb1268-23" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> score),<span class="at">color =</span> <span class="st">&quot;seagreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb1268-24"><a href="anomaly-detection.html#cb1268-24" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> row), <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>()) <span class="sc">+</span></span>
<span id="cb1268-25"><a href="anomaly-detection.html#cb1268-25" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">guide =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb1268-26"><a href="anomaly-detection.html#cb1268-26" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1268-27"><a href="anomaly-detection.html#cb1268-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;LOF method of outlier</span><span class="sc">\n</span><span class="st">Visualised on principal components&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an10"></span>
<img src="DauR_files/figure-html/an10-1.png" alt="LOF" width="48%" /><img src="DauR_files/figure-html/an10-2.png" alt="LOF" width="48%" />
<p class="caption">
Figure 25.8: LOF
</p>
</div>
<p>Clearly, in Figure <a href="anomaly-detection.html#fig:an10">25.8</a> (left), where we have plotted the data in 2 dimensions only despite that we have attempted to find the LOF on the basis of all four dimensions. We can see presence of local anomalies, within the clustered data points. E.g. points nos. 31, 23, etc. were earlier given more weight instead of point nos.15, 10, etc. which are now given more weight. However, if we want to visaulise it on first two principal components, we can do that (Refer Figure <a href="anomaly-detection.html#fig:an10">25.8</a> (Right)). We can also verify this.</p>
<div class="sourceCode" id="cb1269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1269-1"><a href="anomaly-detection.html#cb1269-1" tabindex="-1"></a><span class="co"># Biggest Anomaly - kNN</span></span>
<span id="cb1269-2"><a href="anomaly-detection.html#cb1269-2" tabindex="-1"></a><span class="fu">which.max</span>(score)</span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<div class="sourceCode" id="cb1271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1271-1"><a href="anomaly-detection.html#cb1271-1" tabindex="-1"></a><span class="co"># Biggest Anomaly - LOF</span></span>
<span id="cb1271-2"><a href="anomaly-detection.html#cb1271-2" tabindex="-1"></a><span class="fu">which.max</span>(lof_score)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>Histograms of both <code>knn</code> and <code>LOF</code> scores can also be drawn, as in Figure <a href="anomaly-detection.html#fig:an12">25.9</a>.</p>
<div class="sourceCode" id="cb1273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1273-1"><a href="anomaly-detection.html#cb1273-1" tabindex="-1"></a><span class="fu">hist</span>(score, <span class="at">breaks =</span> <span class="dv">40</span>, </span>
<span id="cb1273-2"><a href="anomaly-detection.html#cb1273-2" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of KNN scores in IRIS-Virginica data&quot;</span>)</span>
<span id="cb1273-3"><a href="anomaly-detection.html#cb1273-3" tabindex="-1"></a><span class="fu">hist</span>(lof_score, <span class="at">breaks =</span> <span class="dv">40</span>, </span>
<span id="cb1273-4"><a href="anomaly-detection.html#cb1273-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of LOF scores in IRIS-Virginica data&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an12"></span>
<img src="DauR_files/figure-html/an12-1.png" alt="Histogram - KNN(Left) and LOF (Right)" width="48%" /><img src="DauR_files/figure-html/an12-2.png" alt="Histogram - KNN(Left) and LOF (Right)" width="48%" />
<p class="caption">
Figure 25.9: Histogram - KNN(Left) and LOF (Right)
</p>
</div>
</div>
<div id="isolation-treesforest" class="section level2 hasAnchor" number="25.7">
<h2><span class="header-section-number">25.7</span> Isolation Trees/Forest<a href="anomaly-detection.html#isolation-treesforest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Isolation Forest is an unsupervised tree based model, which actually works on path length instead of distance or density measures. Tree based models use decision tree(s) to determine the value/class of an observation given its value. In other words, it determines or try to identify a path from the root node to a leaf node based on the value of the observation in question. Forest (or Random Forest) are actually collection of smaller trees and thus using ensemble learning methods to make decision, instead of a single complex tree.</p>
<p>Let us work on the same problem statement above. Firstly, we will build a single decision tree. WE will use a development version package <code>isofor</code> which can be downloaded using <code>remotes::install_github("Zelazny7/isofor")</code>. To build forest/tree we will use function <code>iForest</code>. Its argument <code>nt</code> will determine the number of trees to be built in ensemble. Another important argument is <code>phi</code> which determines the number of samples to draw without replacement to construct each tree. So let’s use <code>nt = 1</code> and <code>phi = 100</code>.</p>
<div class="sourceCode" id="cb1274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1274-1"><a href="anomaly-detection.html#cb1274-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;Zelazny7/isofor&quot;)</span></span>
<span id="cb1274-2"><a href="anomaly-detection.html#cb1274-2" tabindex="-1"></a><span class="fu">library</span>(isofor)</span>
<span id="cb1274-3"><a href="anomaly-detection.html#cb1274-3" tabindex="-1"></a><span class="co"># Generate a single tree</span></span>
<span id="cb1274-4"><a href="anomaly-detection.html#cb1274-4" tabindex="-1"></a><span class="co"># Specify number of samples explicitly</span></span>
<span id="cb1274-5"><a href="anomaly-detection.html#cb1274-5" tabindex="-1"></a>viginica_1 <span class="ot">&lt;-</span> <span class="fu">iForest</span>(df, <span class="at">nt =</span> <span class="dv">1</span>, <span class="at">phi =</span> <span class="dv">100</span>)</span>
<span id="cb1274-6"><a href="anomaly-detection.html#cb1274-6" tabindex="-1"></a></span>
<span id="cb1274-7"><a href="anomaly-detection.html#cb1274-7" tabindex="-1"></a><span class="co"># Generate isolation score</span></span>
<span id="cb1274-8"><a href="anomaly-detection.html#cb1274-8" tabindex="-1"></a>iso_score_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(viginica_1, df)</span>
<span id="cb1274-9"><a href="anomaly-detection.html#cb1274-9" tabindex="-1"></a></span>
<span id="cb1274-10"><a href="anomaly-detection.html#cb1274-10" tabindex="-1"></a><span class="co"># View fisrt 10 scores</span></span>
<span id="cb1274-11"><a href="anomaly-detection.html#cb1274-11" tabindex="-1"></a>iso_score_1[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1] 0.3372822 0.3437950 0.3694749 0.4425250 0.3694749 0.4517359 0.8198250
##  [8] 0.6085593 0.4989121 0.6085593</code></pre>
<p><em>Score interpretations</em>: The closer the score is to 1, the more likely the point is an anomaly. However, if their scores are below 0.5, they are probably just normal points within the trend.</p>
<p>Let’s just visualise the scores on Principal Component plot again.</p>
<div class="sourceCode" id="cb1276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1276-1"><a href="anomaly-detection.html#cb1276-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb1276-2"><a href="anomaly-detection.html#cb1276-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1276-3"><a href="anomaly-detection.html#cb1276-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>(),</span>
<span id="cb1276-4"><a href="anomaly-detection.html#cb1276-4" tabindex="-1"></a>         <span class="at">score =</span> iso_score_1,</span>
<span id="cb1276-5"><a href="anomaly-detection.html#cb1276-5" tabindex="-1"></a>         <span class="at">PC1 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb1276-6"><a href="anomaly-detection.html#cb1276-6" tabindex="-1"></a>         <span class="at">PC2 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1276-7"><a href="anomaly-detection.html#cb1276-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2)) <span class="sc">+</span></span>
<span id="cb1276-8"><a href="anomaly-detection.html#cb1276-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> score),<span class="at">color =</span> <span class="st">&quot;seagreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb1276-9"><a href="anomaly-detection.html#cb1276-9" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> row), <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>()) <span class="sc">+</span></span>
<span id="cb1276-10"><a href="anomaly-detection.html#cb1276-10" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">guide =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb1276-11"><a href="anomaly-detection.html#cb1276-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1276-12"><a href="anomaly-detection.html#cb1276-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Isolation Tree based outlier</span><span class="sc">\n</span><span class="st">Visualised on principal components&quot;</span>)</span>
<span id="cb1276-13"><a href="anomaly-detection.html#cb1276-13" tabindex="-1"></a></span>
<span id="cb1276-14"><a href="anomaly-detection.html#cb1276-14" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb1276-15"><a href="anomaly-detection.html#cb1276-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1276-16"><a href="anomaly-detection.html#cb1276-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>(),</span>
<span id="cb1276-17"><a href="anomaly-detection.html#cb1276-17" tabindex="-1"></a>         <span class="at">score =</span> iso_score_1,</span>
<span id="cb1276-18"><a href="anomaly-detection.html#cb1276-18" tabindex="-1"></a>         <span class="at">PC1 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb1276-19"><a href="anomaly-detection.html#cb1276-19" tabindex="-1"></a>         <span class="at">PC2 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb1276-20"><a href="anomaly-detection.html#cb1276-20" tabindex="-1"></a>         <span class="at">is_outlier =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(<span class="fu">ntile</span>(iso_score_1, <span class="dv">10</span>) <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;N&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1276-21"><a href="anomaly-detection.html#cb1276-21" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2)) <span class="sc">+</span></span>
<span id="cb1276-22"><a href="anomaly-detection.html#cb1276-22" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> score, <span class="at">color =</span> is_outlier)) <span class="sc">+</span></span>
<span id="cb1276-23"><a href="anomaly-detection.html#cb1276-23" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> row), <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>()) <span class="sc">+</span></span>
<span id="cb1276-24"><a href="anomaly-detection.html#cb1276-24" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">O =</span> <span class="st">&quot;red&quot;</span>, <span class="at">N =</span> <span class="st">&quot;black&quot;</span>), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb1276-25"><a href="anomaly-detection.html#cb1276-25" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">guide =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb1276-26"><a href="anomaly-detection.html#cb1276-26" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1276-27"><a href="anomaly-detection.html#cb1276-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Isolation Tree based outlier</span><span class="sc">\n</span><span class="st">Top-10%&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an24"></span>
<img src="DauR_files/figure-html/an24-1.png" alt="Isolation Tree Method" width="48%" /><img src="DauR_files/figure-html/an24-2.png" alt="Isolation Tree Method" width="48%" />
<p class="caption">
Figure 25.10: Isolation Tree Method
</p>
</div>
<p>Let’s also try a forest (ensemble) approach. Refer Figure <a href="anomaly-detection.html#fig:an14">25.11</a>, we can see that scores are modified using ensemble methods. However, when we gradually increase number of trees, these scores will stabilise.</p>
<div class="sourceCode" id="cb1277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1277-1"><a href="anomaly-detection.html#cb1277-1" tabindex="-1"></a>iso_100 <span class="ot">&lt;-</span> <span class="fu">iForest</span>(df, <span class="at">nt =</span> <span class="dv">100</span>, <span class="at">phi =</span> <span class="dv">100</span>)</span>
<span id="cb1277-2"><a href="anomaly-detection.html#cb1277-2" tabindex="-1"></a></span>
<span id="cb1277-3"><a href="anomaly-detection.html#cb1277-3" tabindex="-1"></a><span class="co"># Generate scores</span></span>
<span id="cb1277-4"><a href="anomaly-detection.html#cb1277-4" tabindex="-1"></a></span>
<span id="cb1277-5"><a href="anomaly-detection.html#cb1277-5" tabindex="-1"></a>iso_score_100 <span class="ot">&lt;-</span> <span class="fu">predict</span>(iso_100, df)</span>
<span id="cb1277-6"><a href="anomaly-detection.html#cb1277-6" tabindex="-1"></a></span>
<span id="cb1277-7"><a href="anomaly-detection.html#cb1277-7" tabindex="-1"></a><span class="co"># View Results</span></span>
<span id="cb1277-8"><a href="anomaly-detection.html#cb1277-8" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb1277-9"><a href="anomaly-detection.html#cb1277-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1277-10"><a href="anomaly-detection.html#cb1277-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>(),</span>
<span id="cb1277-11"><a href="anomaly-detection.html#cb1277-11" tabindex="-1"></a>         <span class="at">score =</span> iso_score_100,</span>
<span id="cb1277-12"><a href="anomaly-detection.html#cb1277-12" tabindex="-1"></a>         <span class="at">PC1 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb1277-13"><a href="anomaly-detection.html#cb1277-13" tabindex="-1"></a>         <span class="at">PC2 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb1277-14"><a href="anomaly-detection.html#cb1277-14" tabindex="-1"></a>         <span class="at">is_outlier =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(<span class="fu">ntile</span>(iso_score_100, <span class="dv">10</span>) <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;N&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1277-15"><a href="anomaly-detection.html#cb1277-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2)) <span class="sc">+</span></span>
<span id="cb1277-16"><a href="anomaly-detection.html#cb1277-16" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> score, <span class="at">color =</span> is_outlier)) <span class="sc">+</span></span>
<span id="cb1277-17"><a href="anomaly-detection.html#cb1277-17" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> row), <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>()) <span class="sc">+</span></span>
<span id="cb1277-18"><a href="anomaly-detection.html#cb1277-18" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">O =</span> <span class="st">&quot;red&quot;</span>, <span class="at">N =</span> <span class="st">&quot;black&quot;</span>), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb1277-19"><a href="anomaly-detection.html#cb1277-19" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">guide =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb1277-20"><a href="anomaly-detection.html#cb1277-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1277-21"><a href="anomaly-detection.html#cb1277-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Isolation Tree based outlier</span><span class="sc">\n</span><span class="st">Number of Trees = 100&quot;</span>)</span>
<span id="cb1277-22"><a href="anomaly-detection.html#cb1277-22" tabindex="-1"></a></span>
<span id="cb1277-23"><a href="anomaly-detection.html#cb1277-23" tabindex="-1"></a><span class="fu">plot</span>(iso_score_1, iso_score_100, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb1277-24"><a href="anomaly-detection.html#cb1277-24" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Comparision of Tree Vs. Forest Method&quot;</span>)</span>
<span id="cb1277-25"><a href="anomaly-detection.html#cb1277-25" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an14"></span>
<img src="DauR_files/figure-html/an14-1.png" alt="100 Isolation Trees (Left) Comparison of 1 vs. 100 trees (Right)" width="48%" /><img src="DauR_files/figure-html/an14-2.png" alt="100 Isolation Trees (Left) Comparison of 1 vs. 100 trees (Right)" width="48%" />
<p class="caption">
Figure 25.11: 100 Isolation Trees (Left) Comparison of 1 vs. 100 trees (Right)
</p>
</div>
<p><strong>Contour plots:</strong> We can also visualise the results of scores of anomaly detection, using contour plots. See the plot in Figure <a href="anomaly-detection.html#fig:an16">25.12</a>.</p>
<div class="sourceCode" id="cb1278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1278-1"><a href="anomaly-detection.html#cb1278-1" tabindex="-1"></a><span class="co"># Create PRCOMP data</span></span>
<span id="cb1278-2"><a href="anomaly-detection.html#cb1278-2" tabindex="-1"></a>df_grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1278-3"><a href="anomaly-detection.html#cb1278-3" tabindex="-1"></a>  <span class="at">PC1 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb1278-4"><a href="anomaly-detection.html#cb1278-4" tabindex="-1"></a>  <span class="at">PC2 =</span> df_prcomp<span class="sc">$</span>x[,<span class="dv">2</span>]</span>
<span id="cb1278-5"><a href="anomaly-detection.html#cb1278-5" tabindex="-1"></a>)</span>
<span id="cb1278-6"><a href="anomaly-detection.html#cb1278-6" tabindex="-1"></a></span>
<span id="cb1278-7"><a href="anomaly-detection.html#cb1278-7" tabindex="-1"></a><span class="co"># Create Sequences</span></span>
<span id="cb1278-8"><a href="anomaly-detection.html#cb1278-8" tabindex="-1"></a>pc1_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(df_prcomp<span class="sc">$</span>x[,<span class="dv">1</span>]), <span class="fu">max</span>(df_prcomp<span class="sc">$</span>x[,<span class="dv">1</span>]), <span class="at">length.out =</span> <span class="dv">25</span>)</span>
<span id="cb1278-9"><a href="anomaly-detection.html#cb1278-9" tabindex="-1"></a>pc2_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(df_prcomp<span class="sc">$</span>x[,<span class="dv">2</span>]), <span class="fu">max</span>(df_prcomp<span class="sc">$</span>x[,<span class="dv">2</span>]), <span class="at">length.out =</span> <span class="dv">25</span>)</span>
<span id="cb1278-10"><a href="anomaly-detection.html#cb1278-10" tabindex="-1"></a><span class="co"># Create Grid</span></span>
<span id="cb1278-11"><a href="anomaly-detection.html#cb1278-11" tabindex="-1"></a>my_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">PC1 =</span> pc1_seq, <span class="at">PC2 =</span> pc2_seq)</span>
<span id="cb1278-12"><a href="anomaly-detection.html#cb1278-12" tabindex="-1"></a></span>
<span id="cb1278-13"><a href="anomaly-detection.html#cb1278-13" tabindex="-1"></a><span class="co"># Create model for Pr comp</span></span>
<span id="cb1278-14"><a href="anomaly-detection.html#cb1278-14" tabindex="-1"></a>iso_model <span class="ot">&lt;-</span> <span class="fu">iForest</span>(df_grid, <span class="at">nt =</span> <span class="dv">100</span>, <span class="at">phi =</span> <span class="dv">100</span>)</span>
<span id="cb1278-15"><a href="anomaly-detection.html#cb1278-15" tabindex="-1"></a><span class="co"># append scores</span></span>
<span id="cb1278-16"><a href="anomaly-detection.html#cb1278-16" tabindex="-1"></a>my_grid<span class="sc">$</span>scores <span class="ot">&lt;-</span> <span class="fu">predict</span>(iso_model, my_grid)</span>
<span id="cb1278-17"><a href="anomaly-detection.html#cb1278-17" tabindex="-1"></a></span>
<span id="cb1278-18"><a href="anomaly-detection.html#cb1278-18" tabindex="-1"></a><span class="co"># Draw Plot</span></span>
<span id="cb1278-19"><a href="anomaly-detection.html#cb1278-19" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1278-20"><a href="anomaly-detection.html#cb1278-20" tabindex="-1"></a><span class="fu">contourplot</span>(scores <span class="sc">~</span> PC1 <span class="sc">+</span> PC2, <span class="at">data =</span> my_grid, <span class="at">region =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an16"></span>
<img src="DauR_files/figure-html/an16-1.png" alt="Contour Plot" width="90%" />
<p class="caption">
Figure 25.12: Contour Plot
</p>
</div>
<p><strong>Including categorical variables</strong> One benefit of using forest tree method of anomaly detection, is that we can include categorical values also. Only condition is that these should be of <code>factor</code> type.</p>
<p><strong>Problem Statement-2:</strong> Let’s now try to find out anomalies on full <code>iris</code> data. We can check column types before proceeding.</p>
<div class="sourceCode" id="cb1279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1279-1"><a href="anomaly-detection.html#cb1279-1" tabindex="-1"></a><span class="fu">sapply</span>(iris, class)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;     &quot;factor&quot;</code></pre>
<p>Our condition is met. So we can proceed directly to build a decision tree/Forest. For sake of simplicity, let’s build a simple tree (one). Refer Figure <a href="anomaly-detection.html#fig:an18">25.13</a>.</p>
<div class="sourceCode" id="cb1281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1281-1"><a href="anomaly-detection.html#cb1281-1" tabindex="-1"></a><span class="co"># New Iforest Model</span></span>
<span id="cb1281-2"><a href="anomaly-detection.html#cb1281-2" tabindex="-1"></a>iso_model_new <span class="ot">&lt;-</span> <span class="fu">iForest</span>(iris, <span class="at">nt =</span> <span class="dv">1</span>, <span class="at">phi =</span> <span class="dv">100</span>)</span>
<span id="cb1281-3"><a href="anomaly-detection.html#cb1281-3" tabindex="-1"></a>new_scores <span class="ot">&lt;-</span> <span class="fu">predict</span>(iso_model_new, iris)</span>
<span id="cb1281-4"><a href="anomaly-detection.html#cb1281-4" tabindex="-1"></a><span class="fu">head</span>(new_scores)</span></code></pre></div>
<pre><code>## [1] 0.3687105 0.3687105 0.3687105 0.3687105 0.3687105 0.6607827</code></pre>
<div class="sourceCode" id="cb1283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1283-1"><a href="anomaly-detection.html#cb1283-1" tabindex="-1"></a><span class="co"># Full PRCOMP for Visual</span></span>
<span id="cb1283-2"><a href="anomaly-detection.html#cb1283-2" tabindex="-1"></a>iris_pr <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb1283-3"><a href="anomaly-detection.html#cb1283-3" tabindex="-1"></a></span>
<span id="cb1283-4"><a href="anomaly-detection.html#cb1283-4" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb1283-5"><a href="anomaly-detection.html#cb1283-5" tabindex="-1"></a>  <span class="at">PC1 =</span> iris_pr<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb1283-6"><a href="anomaly-detection.html#cb1283-6" tabindex="-1"></a>  <span class="at">PC2 =</span> iris_pr<span class="sc">$</span>x[,<span class="dv">2</span>]</span>
<span id="cb1283-7"><a href="anomaly-detection.html#cb1283-7" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1283-8"><a href="anomaly-detection.html#cb1283-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score =</span> new_scores,</span>
<span id="cb1283-9"><a href="anomaly-detection.html#cb1283-9" tabindex="-1"></a>         <span class="at">Species =</span> iris<span class="sc">$</span>Species) <span class="sc">%&gt;%</span> </span>
<span id="cb1283-10"><a href="anomaly-detection.html#cb1283-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb1283-11"><a href="anomaly-detection.html#cb1283-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> score)) <span class="sc">+</span></span>
<span id="cb1283-12"><a href="anomaly-detection.html#cb1283-12" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1283-13"><a href="anomaly-detection.html#cb1283-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1283-14"><a href="anomaly-detection.html#cb1283-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Decision Tree</span><span class="sc">\n</span><span class="st">Visualised on Principal Components&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an18"></span>
<img src="DauR_files/figure-html/an18-1.png" alt="Including categorical variable" width="98%" />
<p class="caption">
Figure 25.13: Including categorical variable
</p>
</div>
</div>
<div id="including-categorical-variables-in-lof" class="section level2 hasAnchor" number="25.8">
<h2><span class="header-section-number">25.8</span> Including categorical variables in LOF<a href="anomaly-detection.html#including-categorical-variables-in-lof" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can also include categorical variable in <code>Local outlier factor</code> using <code>gower distance</code> calculation method. Gower method lets us calculate distance between categorical observations, most importantly when the categories are not ordered. To calculate it we can use function <code>daisy</code> from library <code>cluster</code> in R. Let’s see LOF score calculation on the above example. The plot generated can be seen in Figure <a href="anomaly-detection.html#fig:an20">25.14</a>.</p>
<div class="sourceCode" id="cb1284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1284-1"><a href="anomaly-detection.html#cb1284-1" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb1284-2"><a href="anomaly-detection.html#cb1284-2" tabindex="-1"></a>iris_dist <span class="ot">&lt;-</span> <span class="fu">daisy</span>(iris, <span class="at">metric =</span> <span class="st">&quot;gower&quot;</span>)</span>
<span id="cb1284-3"><a href="anomaly-detection.html#cb1284-3" tabindex="-1"></a>iris_lof <span class="ot">&lt;-</span> <span class="fu">lof</span>(iris_dist, <span class="at">minPts =</span> <span class="dv">5</span>)</span>
<span id="cb1284-4"><a href="anomaly-detection.html#cb1284-4" tabindex="-1"></a></span>
<span id="cb1284-5"><a href="anomaly-detection.html#cb1284-5" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb1284-6"><a href="anomaly-detection.html#cb1284-6" tabindex="-1"></a>  <span class="at">PC1 =</span> iris_pr<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb1284-7"><a href="anomaly-detection.html#cb1284-7" tabindex="-1"></a>  <span class="at">PC2 =</span> iris_pr<span class="sc">$</span>x[,<span class="dv">2</span>]</span>
<span id="cb1284-8"><a href="anomaly-detection.html#cb1284-8" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1284-9"><a href="anomaly-detection.html#cb1284-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score =</span> iris_lof,</span>
<span id="cb1284-10"><a href="anomaly-detection.html#cb1284-10" tabindex="-1"></a>         <span class="at">Species =</span> iris<span class="sc">$</span>Species) <span class="sc">%&gt;%</span> </span>
<span id="cb1284-11"><a href="anomaly-detection.html#cb1284-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb1284-12"><a href="anomaly-detection.html#cb1284-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> score)) <span class="sc">+</span></span>
<span id="cb1284-13"><a href="anomaly-detection.html#cb1284-13" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1284-14"><a href="anomaly-detection.html#cb1284-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1284-15"><a href="anomaly-detection.html#cb1284-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;LOF Scores</span><span class="sc">\n</span><span class="st">Visualised on Principal Components&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an20"></span>
<img src="DauR_files/figure-html/an20-1.png" alt="Including categorical variable" width="90%" />
<p class="caption">
Figure 25.14: Including categorical variable
</p>
</div>
</div>
<div id="time-series-anomalies" class="section level2 hasAnchor" number="25.9">
<h2><span class="header-section-number">25.9</span> Time Series Anomalies<a href="anomaly-detection.html#time-series-anomalies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In time series data, an anomaly/outlier can be termed as a data point which is not following the common collective trend or seasonal or cyclic pattern of the entire data and is significantly distinct from rest of the data.</p>
<p>To calculate/detect anomalies, in R, we make use of package <code>timetk</code>. The package works on <code>tibble</code> instead of <code>time series</code> data, so we may to prep our data/time series accordingly.</p>
<p><strong>Problem Statement</strong> Let’s find out anomalies, if any on Sunspots data available in base R<a href="#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a>.</p>
<div class="sourceCode" id="cb1285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1285-1"><a href="anomaly-detection.html#cb1285-1" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;1749-01-01&quot;</span>)</span>
<span id="cb1285-2"><a href="anomaly-detection.html#cb1285-2" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2013-09-01&quot;</span>)</span>
<span id="cb1285-3"><a href="anomaly-detection.html#cb1285-3" tabindex="-1"></a>date_sequence <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">&quot;months&quot;</span>)</span>
<span id="cb1285-4"><a href="anomaly-detection.html#cb1285-4" tabindex="-1"></a></span>
<span id="cb1285-5"><a href="anomaly-detection.html#cb1285-5" tabindex="-1"></a>sunspot_df <span class="ot">&lt;-</span> sunspot.month <span class="sc">%&gt;%</span></span>
<span id="cb1285-6"><a href="anomaly-detection.html#cb1285-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1285-7"><a href="anomaly-detection.html#cb1285-7" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1285-8"><a href="anomaly-detection.html#cb1285-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> date_sequence)</span>
<span id="cb1285-9"><a href="anomaly-detection.html#cb1285-9" tabindex="-1"></a></span>
<span id="cb1285-10"><a href="anomaly-detection.html#cb1285-10" tabindex="-1"></a><span class="fu">library</span>(timetk)</span>
<span id="cb1285-11"><a href="anomaly-detection.html#cb1285-11" tabindex="-1"></a>sunspot_df <span class="sc">%&gt;%</span> </span>
<span id="cb1285-12"><a href="anomaly-detection.html#cb1285-12" tabindex="-1"></a>  <span class="fu">plot_anomaly_diagnostics</span>(date, value,</span>
<span id="cb1285-13"><a href="anomaly-detection.html#cb1285-13" tabindex="-1"></a>                           <span class="at">.interactive =</span> <span class="cn">FALSE</span>) </span>
<span id="cb1285-14"><a href="anomaly-detection.html#cb1285-14" tabindex="-1"></a></span>
<span id="cb1285-15"><a href="anomaly-detection.html#cb1285-15" tabindex="-1"></a>sunspot_df <span class="sc">%&gt;%</span> </span>
<span id="cb1285-16"><a href="anomaly-detection.html#cb1285-16" tabindex="-1"></a>  <span class="fu">tk_anomaly_diagnostics</span>(date, value) <span class="sc">%&gt;%</span> </span>
<span id="cb1285-17"><a href="anomaly-detection.html#cb1285-17" tabindex="-1"></a>  <span class="fu">filter</span>(anomaly <span class="sc">==</span> <span class="st">&#39;Yes&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 37 × 11
##    date       observed season trend remainder seasadj remainder_l1 remainder_l2
##    &lt;date&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
##  1 1749-11-01     159. -1.07   76.3      83.4    160.        -64.8         66.7
##  2 1769-09-01     149. -0.524  78.8      70.5    149.        -64.8         66.7
##  3 1769-10-01     158.  1.17   79.3      77.7    157.        -64.8         66.7
##  4 1769-11-01     148. -1.07   79.8      69.4    149.        -64.8         66.7
##  5 1771-05-01     153.  0.963  77.5      74.3    152.        -64.8         66.7
##  6 1777-11-01     146  -1.07   75.7      71.4    147.        -64.8         66.7
##  7 1777-12-01     157. -0.495  77.8      80.0    158.        -64.8         66.7
##  8 1778-01-01     177. -2.18   79.9      99.6    179.        -64.8         66.7
##  9 1778-05-01     239.  0.963  87.3     151.     238.        -64.8         66.7
## 10 1778-06-01     172.  0.368  89.2      82.1    171.        -64.8         66.7
## # ℹ 27 more rows
## # ℹ 3 more variables: anomaly &lt;chr&gt;, recomposed_l1 &lt;dbl&gt;, recomposed_l2 &lt;dbl&gt;</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:an17"></span>
<img src="DauR_files/figure-html/an17-1.png" alt="Time Series Anomalies" width="90%" />
<p class="caption">
Figure 25.15: Time Series Anomalies
</p>
</div>
<p>We can anomalies highlighted in red, in Figure <a href="anomaly-detection.html#fig:an17">25.15</a> and anomalies filtered out in code above. We may also implement Seasonal Hybrid ESD algorithm already discussed above.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="47">
<li id="fn47"><p>Monthly numbers of sunspots, as from the World Data Center, aka SIDC. This is the version of the data that will occasionally be updated when new counts become available.<a href="anomaly-detection.html#fnref47" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="finding-string-similarity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-envelopment-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/25-anomaly.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DauR.pdf", "DauR.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
