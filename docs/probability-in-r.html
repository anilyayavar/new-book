<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 18 Probability in R | R for Audit Analytics</title>

    <meta name="author" content="Anil Goyal" />
  
   <meta name="description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 18 Probability in R | R for Audit Analytics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://anilyayavar.github.io/new-book/" />
  <meta property="og:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <meta property="og:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Probability in R | R for Audit Analytics" />
  
  <meta name="twitter:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
  <meta name="twitter:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.8.0/transition.js"></script>
    <script src="libs/bs3compat-0.8.0/tabs.js"></script>
    <script src="libs/bs3compat-0.8.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
    <style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Audit Analytics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="probability-in-r" class="section level1" number="18">
<h1><span class="header-section-number">Chapter 18</span> Probability in R</h1>
<p>We will keep short here. Instead of learning all the concepts of probability, we will see how to calculate probability, densities, quantiles for nearly any type of distribution. R’s powerhorse has four types of functions for each of the distributions associated called <code>pqdr</code> functions. Actually all these are prefixes. Consider a probability function <span class="math inline">\(P(X=x) = p\)</span> for a variable <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> be the associated probability.</p>
<table>
<colgroup>
<col width="54%" />
<col width="16%" />
<col width="10%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th>Distribution</th>
<th>P</th>
<th>Q</th>
<th>D</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Beta</td>
<td>pbeta</td>
<td>qbeta</td>
<td>dbeta</td>
<td>rbeta</td>
</tr>
<tr class="even">
<td>Binomial</td>
<td>pbinom</td>
<td>qbinom</td>
<td>dbinom</td>
<td>rbinom</td>
</tr>
<tr class="odd">
<td>Cauchy</td>
<td>pcauchy</td>
<td>qcauchy</td>
<td>dcauchy</td>
<td>rcauchy</td>
</tr>
<tr class="even">
<td>Chi-Square</td>
<td>pchisq</td>
<td>qchisq</td>
<td>dchisq</td>
<td>rchisq</td>
</tr>
<tr class="odd">
<td>Exponential</td>
<td>pexp</td>
<td>qexp</td>
<td>dexp</td>
<td>rexp</td>
</tr>
<tr class="even">
<td>F</td>
<td>pf</td>
<td>qf</td>
<td>df</td>
<td>rf</td>
</tr>
<tr class="odd">
<td>Gamma</td>
<td>pgamma</td>
<td>qgamma</td>
<td>dgamma</td>
<td>rgamma</td>
</tr>
<tr class="even">
<td>Geometric</td>
<td>pgeom</td>
<td>qgeom</td>
<td>dgeom</td>
<td>rgeom</td>
</tr>
<tr class="odd">
<td>Hypergeometric</td>
<td>phyper</td>
<td>qhyper</td>
<td>dhyper</td>
<td>rhyper</td>
</tr>
<tr class="even">
<td>Logistic</td>
<td>plogis</td>
<td>qlogis</td>
<td>dlogis</td>
<td>rlogis</td>
</tr>
<tr class="odd">
<td>Log Normal</td>
<td>plnorm</td>
<td>qlnorm</td>
<td>dlnorm</td>
<td>rlnorm</td>
</tr>
<tr class="even">
<td>Negative Binomial</td>
<td>pnbinom</td>
<td>qnbinom</td>
<td>dnbinom</td>
<td>rnbinom</td>
</tr>
<tr class="odd">
<td>Normal</td>
<td>pnorm</td>
<td>qnorm</td>
<td>dnorm</td>
<td>rnorm</td>
</tr>
<tr class="even">
<td>Poisson</td>
<td>ppois</td>
<td>qpois</td>
<td>dpois</td>
<td>rpois</td>
</tr>
<tr class="odd">
<td>Student t</td>
<td>pt</td>
<td>qt</td>
<td>dt</td>
<td>rt</td>
</tr>
<tr class="even">
<td>Studentized Range</td>
<td>ptukey</td>
<td>qtukey</td>
<td>dtukey</td>
<td>rtukey</td>
</tr>
<tr class="odd">
<td>Uniform</td>
<td>punif</td>
<td>qunif</td>
<td>dunif</td>
<td>runif</td>
</tr>
<tr class="even">
<td>Weibull</td>
<td>pweibull</td>
<td>qweibull</td>
<td>dweibull</td>
<td>rweibull</td>
</tr>
<tr class="odd">
<td>Wilcoxon Rank Sum Statistic</td>
<td>pwilcox</td>
<td>qwilcox</td>
<td>dwilcox</td>
<td>rwilcox</td>
</tr>
<tr class="even">
<td>Wilcoxon Signed Rank Statistic</td>
<td>psignrank</td>
<td>qsignrank</td>
<td>dsignrank</td>
<td>rsignrank</td>
</tr>
</tbody>
</table>
<p>All these functions are vectorised. Let us explore these one by one.</p>
<div id="p-set-of-functions" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> <code>p*()</code> set of functions</h2>
<p>These set of functions give the cumulative <strong>p</strong>robability distribution of that probability function.</p>
<p>Example-1. What is the probability of a number being less than or equal to <code>25</code> in <code>Normal</code> distribution with <code>mean = 50</code> and <code>sd = 10</code>.</p>
<div class="sourceCode" id="cb1103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1103-1"><a href="probability-in-r.html#cb1103-1" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 0.006209665</code></pre>
<p>On the contrary, the probability of a number being greater than or equal to 25 in the above distribution is-</p>
<div class="sourceCode" id="cb1105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1105-1"><a href="probability-in-r.html#cb1105-1" tabindex="-1"></a><span class="co"># Either deduct probability from 1 </span></span>
<span id="cb1105-2"><a href="probability-in-r.html#cb1105-2" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 0.9937903</code></pre>
<div class="sourceCode" id="cb1107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1107-1"><a href="probability-in-r.html#cb1107-1" tabindex="-1"></a><span class="co"># Or provide FALSE to lower.tail argument</span></span>
<span id="cb1107-2"><a href="probability-in-r.html#cb1107-2" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.9937903</code></pre>
<p>Example-2: What is the probability of one or more heads out of two tosses of a fair coin (binomial distribution with <code>p = 0.5</code>).</p>
<div class="sourceCode" id="cb1109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1109-1"><a href="probability-in-r.html#cb1109-1" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">p =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.75</code></pre>
</div>
<div id="q-set-of-functions" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> <code>q*()</code> set of functions</h2>
<p>These set of functions, give <strong>q</strong>uantile which is the inverse of cumulative probability function. So if <span class="math inline">\(f\)</span> is cdf (cumulative distribution function) of a given probability distribution then <span class="math inline">\(F\)</span> the quantile is inverse of <code>f</code> i.e. <span class="math inline">\(F = f^{-1}\)</span>. These are related by</p>
<p><span class="math display" id="eq:s1">\[\begin{equation}
p = f(x)
\tag{18.1}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:s2">\[\begin{equation}
x = F(x) = f^{-1}(x)
\tag{18.2}
\end{equation}\]</span></p>
<p>Example- In the above same normal distribution (<code>mean = 50</code> and <code>sd = 10</code>) What is number below which 90% of population will be distributed.</p>
<div class="sourceCode" id="cb1111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1111-1"><a href="probability-in-r.html#cb1111-1" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.9</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 62.81552</code></pre>
<p>Similar to <code>cdf</code> here we may use <code>lower.tail</code> argument to find the number above which a population percent is distributed.</p>
<div class="sourceCode" id="cb1113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1113-1"><a href="probability-in-r.html#cb1113-1" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.9</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 37.18448</code></pre>
</div>
<div id="d-set-of-functions" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> <code>d*()</code> set of functions</h2>
<p>We saw that <code>p</code> group denotes <code>cdf</code>, <code>q</code> group denotes <code>inverse cdf</code>, but <code>d</code> group actually denotes probability <strong>d</strong>ensity function of a given distribution. Simply stating, this returns the height of probability distribution function for a given x value.</p>
<p>So what is expected probability of drawing exactly 2 heads out of two tosses of a single fair coin (i.e. from a binomial distribution with probability <code>p = 0.5</code>).</p>
<div class="sourceCode" id="cb1115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1115-1"><a href="probability-in-r.html#cb1115-1" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.25</code></pre>
</div>
<div id="r-set-of-functions" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> <code>r*()</code> set of functions</h2>
<p>These set of functions are used to generate <strong>r</strong>andom numbers from a Statistical distribution. So to generate <code>10</code> random numbers from Normal distribution with <code>mean = 50</code> and <code>sd = 10</code>, we can use <code>rnorm</code>.</p>
<div class="sourceCode" id="cb1117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1117-1"><a href="probability-in-r.html#cb1117-1" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] 33.10444 62.39496 48.91034 48.82758 51.83083 62.80555 32.72729 66.90184
##  [9] 55.03812 75.28337</code></pre>
<p>We can actually check this using histogram.</p>
<div class="sourceCode" id="cb1119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1119-1"><a href="probability-in-r.html#cb1119-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1119-2"><a href="probability-in-r.html#cb1119-2" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">50</span>, <span class="dv">10</span>), <span class="at">breaks =</span> <span class="dv">50</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-346"></span>
<img src="DauR_files/figure-html/unnamed-chunk-346-1.png" alt="Histogram of Random numbers generated out of Normal distribution" width="75%" />
<p class="caption">
Figure 18.1: Histogram of Random numbers generated out of Normal distribution
</p>
</div>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Audit Analytics</strong>" was written by Anil Goyal. It was last built on 2024-11-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
