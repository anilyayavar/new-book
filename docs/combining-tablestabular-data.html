<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 15 Combining Tables/tabular data | R for Audit Analytics</title>

    <meta name="author" content="Anil Goyal" />
  
   <meta name="description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 15 Combining Tables/tabular data | R for Audit Analytics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://anilyayavar.github.io/new-book/" />
  <meta property="og:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <meta property="og:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Combining Tables/tabular data | R for Audit Analytics" />
  
  <meta name="twitter:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
  <meta name="twitter:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.8.0/transition.js"></script>
    <script src="libs/bs3compat-0.8.0/tabs.js"></script>
    <script src="libs/bs3compat-0.8.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
    <style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Audit Analytics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="combining-tablestabular-data" class="section level1" number="15">
<h1><span class="header-section-number">Chapter 15</span> Combining Tables/tabular data</h1>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-280"></span>
<img src="images/conf.jpg" alt="Most of times, joining two or more tables will be required to perform analytics" width="75%" height="75%" />
<p class="caption">
Figure 15.1: Most of times, joining two or more tables will be required to perform analytics
</p>
</div>
<p>In real world scenarios, there may hardly be a case when we have to analyse one single table. There may be cases when we have to either join tables split into multiple smaller tables (e.g. we can have smaller tables split States-wise), or the tables may be divided into various smaller master and transaction tables (relational databases).</p>
<p>We may thus divide the data tables joining requirements into three broad categories-</p>
<ul>
<li>Simple joins or concatenation</li>
<li>Relational Joins</li>
<li>Filtering Joins</li>
</ul>
<p>Let us discuss each of these with examples.</p>
<div id="simple-joinsconcatenation" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> Simple joins/concatenation</h2>
<p>Many times tables split into smaller tables have to be joined back before proceeding further for data analytics. We may have to join two or more tables either columnwise (e.g. some of the features for all rows have been split into a separate table) or row wise (e.g. all the fields/columns are split into smaller tables like a separate table for each State). Diagramatically these joins may be depicted as shown in figure <a href="combining-tablestabular-data.html#fig:joins">15.2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:joins"></span>
<img src="images/concat_joins.png" alt="Illustration of Simple joins/concatenation" width="99%" />
<p class="caption">
Figure 15.2: Illustration of Simple joins/concatenation
</p>
</div>
<div id="column-binding" class="section level3" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Column binding</h3>
<p>As we have already seen that data frames act like matrices in many ways except to that fact that these support heterogeneous data unlike matrices. We have also discussed the ways two matrices can be joined. Base R has two dedicated functions i.e. <code>cbind()</code> and <code>rbind()</code> for these operations.</p>
<p>In <em>tidyverse</em> (dplyr specifically) we have two similar functions <code>bind_cols()</code> and <code>bind_rows</code> respectively which provide us better functionality for these use cases. The syntax for finction <code>bind_cols()</code> used for concatenating two or more tables <em>column wise</em> is -</p>
<pre><code>bind_cols(
  ...,
  .name_repair = c(&quot;unique&quot;, &quot;universal&quot;, &quot;check_unique&quot;)
)</code></pre>
<p>Where -</p>
<ul>
<li><code>...</code> represent data frames to be combined</li>
<li><code>.name_repair</code> argument chooses method to rename duplicate column names, if any.</li>
</ul>
<p>Example-1:</p>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="combining-tablestabular-data.html#cb936-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>)]</span>
<span id="cb936-2"><a href="combining-tablestabular-data.html#cb936-2" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb936-3"><a href="combining-tablestabular-data.html#cb936-3" tabindex="-1"></a></span>
<span id="cb936-4"><a href="combining-tablestabular-data.html#cb936-4" tabindex="-1"></a><span class="fu">bind_cols</span>(df1, df2, <span class="at">.name_repair =</span> <span class="st">&#39;universal&#39;</span>)</span></code></pre></div>
<pre><code>## New names:
## • `Species` -&gt; `Species...3`
## • `Species` -&gt; `Species...6`</code></pre>
<pre><code>##   Sepal.Length Sepal.Width Species...3 Petal.Length Petal.Width Species...6
## 1          5.1         3.5      setosa          1.4         0.2      setosa
## 2          4.9         3.0      setosa          1.4         0.2      setosa
## 3          4.7         3.2      setosa          1.3         0.2      setosa</code></pre>
<blockquote>
<p>Note: The data frames to be merged should be row-consistent for column binding. Try this <code>bind_cols(iris[1:3, 1:2], iris[1:4, 3:4])</code> and see the results.</p>
</blockquote>
</div>
<div id="row-binding" class="section level3" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Row binding</h3>
<p>The syntax used for appending rows of one or more tables together in one table is -</p>
<pre><code>bind_rows(..., .id = NULL)</code></pre>
<p>where -</p>
<ul>
<li><code>...</code> represent data frames to be combined</li>
<li><code>.id</code> argument creates a new column of identifiers.</li>
</ul>
<p>To understand it better, let us see this example</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="combining-tablestabular-data.html#cb940-1" tabindex="-1"></a>setosa <span class="ot">&lt;-</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb940-2"><a href="combining-tablestabular-data.html#cb940-2" tabindex="-1"></a>versicolor <span class="ot">&lt;-</span> iris[<span class="dv">51</span><span class="sc">:</span><span class="dv">53</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb940-3"><a href="combining-tablestabular-data.html#cb940-3" tabindex="-1"></a>virginica <span class="ot">&lt;-</span> iris[<span class="dv">101</span><span class="sc">:</span><span class="dv">103</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb940-4"><a href="combining-tablestabular-data.html#cb940-4" tabindex="-1"></a></span>
<span id="cb940-5"><a href="combining-tablestabular-data.html#cb940-5" tabindex="-1"></a><span class="fu">bind_rows</span>(setosa, versicolor, virginica, <span class="at">.id =</span> <span class="st">&#39;groups&#39;</span>)</span></code></pre></div>
<pre><code>##   groups Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1      1          5.1         3.5          1.4         0.2
## 2      1          4.9         3.0          1.4         0.2
## 3      1          4.7         3.2          1.3         0.2
## 4      2          7.0         3.2          4.7         1.4
## 5      2          6.4         3.2          4.5         1.5
## 6      2          6.9         3.1          4.9         1.5
## 7      3          6.3         3.3          6.0         2.5
## 8      3          5.8         2.7          5.1         1.9
## 9      3          7.1         3.0          5.9         2.1</code></pre>
<blockquote>
<p>Note: In the above example if the requirement is to store data tables names into the new <em>identifier</em> column just list convert the databases into a list and <code>.id</code> will take element_names as the values in identifiers. Try this <code>bind_rows(list(setosa=setosa, versicolor=versicolor, virginica=virginica), .id = 'Species')</code></p>
</blockquote>
</div>
</div>
<div id="relational-joins" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> Relational joins</h2>
<p>Relational Joins are usually needed to join multiple tables based on <em>primary key</em> and <em>secondary keys</em>. The joins may either be <em>one-to-one</em> key join or <em>one-to-many</em> key joins. Broadly these can either be <em>inner joins</em> or <em>outer joins</em>. Diagrammatically these may be represented as shown in figure <a href="combining-tablestabular-data.html#fig:joinm">15.3</a> wherein it may be noticed that additional columns from <code>right</code> data frame gets appended to <code>left</code> data frame. For this reason, these four joins are also known as mutating joins.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:joinm"></span>
<img src="images/mutating_joins.png" alt="Illustration of Mutating Joins in dplyr" width="99%" />
<p class="caption">
Figure 15.3: Illustration of Mutating Joins in dplyr
</p>
</div>
<p>The syntax of all these joins is nearly same-</p>
<pre><code>*_join(x, y, by = NULL, copy = FALSE, suffix = c(&#39;.x&#39;, &#39;.y&#39;), ... , keep = FALSE)</code></pre>
<p>where -</p>
<ul>
<li><code>x</code> and <code>y</code> are data frames to be joined</li>
<li><code>by</code> is a character vector of column names to be joined by</li>
<li><code>suffix</code> argument provides suffixes to be added to column names, if any of those are duplicate</li>
<li><code>keep</code> argument decides whether the join keys from both x and y be preserved in the output?</li>
</ul>
<p>Let’s discuss each of these joins individually.</p>
<div id="inner-joins" class="section level3" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> Inner Joins</h3>
<p>Inner Joins keeps only those rows where matching keys are present in both the data frames.</p>
<p>Example-1:</p>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="combining-tablestabular-data.html#cb943-1" tabindex="-1"></a>band_members</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   name  band   
##   &lt;chr&gt; &lt;chr&gt;  
## 1 Mick  Stones 
## 2 John  Beatles
## 3 Paul  Beatles</code></pre>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="combining-tablestabular-data.html#cb945-1" tabindex="-1"></a>band_instruments</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   name  plays 
##   &lt;chr&gt; &lt;chr&gt; 
## 1 John  guitar
## 2 Paul  bass  
## 3 Keith guitar</code></pre>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="combining-tablestabular-data.html#cb947-1" tabindex="-1"></a><span class="fu">inner_join</span>(band_members, band_instruments)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(name)`</code></pre>
<pre><code>## # A tibble: 2 × 3
##   name  band    plays 
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
## 1 John  Beatles guitar
## 2 Paul  Beatles bass</code></pre>
</div>
<div id="left-joins" class="section level3" number="15.2.2">
<h3><span class="header-section-number">15.2.2</span> Left Joins</h3>
<p>Left Joins on the other hand preserves all rows of data frame passed as <code>x</code> i.e. first argument irrespective of the fact that matching key record is available in second data table or not.</p>
<p>Example-1:</p>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="combining-tablestabular-data.html#cb950-1" tabindex="-1"></a><span class="fu">left_join</span>(band_members, band_instruments)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(name)`</code></pre>
<pre><code>## # A tibble: 3 × 3
##   name  band    plays 
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
## 1 Mick  Stones  &lt;NA&gt;  
## 2 John  Beatles guitar
## 3 Paul  Beatles bass</code></pre>
</div>
<div id="right-joins" class="section level3" number="15.2.3">
<h3><span class="header-section-number">15.2.3</span> Right Joins</h3>
<p>Right join, is similar to left join and preserves all rows of data frame passed as <code>y</code> i.e. second argument irrespective of the fact that matching key record is available in first data table or not.</p>
<p>Example-1:</p>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="combining-tablestabular-data.html#cb953-1" tabindex="-1"></a><span class="fu">right_join</span>(band_members, band_instruments)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(name)`</code></pre>
<pre><code>## # A tibble: 3 × 3
##   name  band    plays 
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
## 1 John  Beatles guitar
## 2 Paul  Beatles bass  
## 3 Keith &lt;NA&gt;    guitar</code></pre>
</div>
<div id="full-joins" class="section level3" number="15.2.4">
<h3><span class="header-section-number">15.2.4</span> Full Joins</h3>
<p>Full join returns all the rows of both the data tables despite non-availability of matching key in either of the tables.</p>
<p>Example-1:</p>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="combining-tablestabular-data.html#cb956-1" tabindex="-1"></a><span class="fu">full_join</span>(band_members, band_instruments)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(name)`</code></pre>
<pre><code>## # A tibble: 4 × 3
##   name  band    plays 
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
## 1 Mick  Stones  &lt;NA&gt;  
## 2 John  Beatles guitar
## 3 Paul  Beatles bass  
## 4 Keith &lt;NA&gt;    guitar</code></pre>
<p>You must have noticed that each of the examples shown above has thrown a warning that join has been performed on variable <code>name</code>. We may override this warning by specifically providing the joining <em>key</em> column name(s) in <code>by</code> argument i.e. <code>by = "name"</code>.</p>
<p>There may be cases when the joining <em>key</em> column(s) in the two data frames are of different names. These cases can also be handled by using <code>by</code> argument.</p>
<p>Example-</p>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="combining-tablestabular-data.html#cb959-1" tabindex="-1"></a>band_instruments2</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   artist plays 
##   &lt;chr&gt;  &lt;chr&gt; 
## 1 John   guitar
## 2 Paul   bass  
## 3 Keith  guitar</code></pre>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb961-1"><a href="combining-tablestabular-data.html#cb961-1" tabindex="-1"></a><span class="fu">left_join</span>(band_members, band_instruments2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;name&#39;</span> <span class="ot">=</span> <span class="st">&#39;artist&#39;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   name  band    plays 
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
## 1 Mick  Stones  &lt;NA&gt;  
## 2 John  Beatles guitar
## 3 Paul  Beatles bass</code></pre>
<blockquote>
<p>Note: Each of the <code>*_join()</code> can be joined on multiple keys/columns (i.e. more than one) using <code>by</code> argument as explained above.</p>
</blockquote>
</div>
<div id="many-to-many-joins" class="section level3 unnumbered">
<h3>Many-to-many Joins</h3>
<p>Example of four of the above-mentioned joins are many to many joins and thus need to be used carefully. See the following example</p>
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb963-1"><a href="combining-tablestabular-data.html#cb963-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb963-2"><a href="combining-tablestabular-data.html#cb963-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>),</span>
<span id="cb963-3"><a href="combining-tablestabular-data.html#cb963-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">21</span>)</span>
<span id="cb963-4"><a href="combining-tablestabular-data.html#cb963-4" tabindex="-1"></a>)</span>
<span id="cb963-5"><a href="combining-tablestabular-data.html#cb963-5" tabindex="-1"></a>df1</span></code></pre></div>
<pre><code>##    x  y
## 1  1 11
## 2  1 12
## 3 NA 21</code></pre>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="combining-tablestabular-data.html#cb965-1" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb965-2"><a href="combining-tablestabular-data.html#cb965-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb965-3"><a href="combining-tablestabular-data.html#cb965-3" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">201</span>, <span class="dv">202</span>)</span>
<span id="cb965-4"><a href="combining-tablestabular-data.html#cb965-4" tabindex="-1"></a>)</span>
<span id="cb965-5"><a href="combining-tablestabular-data.html#cb965-5" tabindex="-1"></a>df2</span></code></pre></div>
<pre><code>##    x   z
## 1  1 101
## 2  1 102
## 3 NA 201
## 4 NA 202</code></pre>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb967-1"><a href="combining-tablestabular-data.html#cb967-1" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df2, <span class="at">by =</span> <span class="st">&#39;x&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in left_join(., df2, by = &quot;x&quot;): Detected an unexpected many-to-many relationship between `x` and `y`.
## ℹ Row 1 of `x` matches multiple rows in `y`.
## ℹ Row 1 of `y` matches multiple rows in `x`.
## ℹ If a many-to-many relationship is expected, set `relationship =
##   &quot;many-to-many&quot;` to silence this warning.</code></pre>
<pre><code>##    x  y   z
## 1  1 11 101
## 2  1 11 102
## 3  1 12 101
## 4  1 12 102
## 5 NA 21 201
## 6 NA 21 202</code></pre>
<p>In fact, we can use argument <code>relationship</code> explicitly to silence this warning and avoid errors. This argument can take one of these values</p>
<ul>
<li><code>NULL</code> (default)</li>
<li><code>"one-to-one"</code></li>
<li><code>"one-to-many"</code></li>
<li><code>"many-to-one"</code></li>
<li><code>"many-to-many"</code></li>
</ul>
<p>Example above re-coded</p>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb970-1"><a href="combining-tablestabular-data.html#cb970-1" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df2, <span class="at">by =</span> <span class="st">&#39;x&#39;</span>, <span class="at">relationship =</span> <span class="st">&quot;many-to-many&quot;</span>)</span></code></pre></div>
<pre><code>##    x  y   z
## 1  1 11 101
## 2  1 11 102
## 3  1 12 101
## 4  1 12 102
## 5 NA 21 201
## 6 NA 21 202</code></pre>
</div>
</div>
<div id="filtering-joins" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> Filtering Joins</h2>
<p>The other joins available in <code>dplyr</code> are basically filtering joins. These joins will not result in appending additional columns present in <code>right</code> data frame to <code>left</code> data frame. Only the common keys (columns) from right data frame will be used to filter left data frame.</p>
<div id="semi-joins" class="section level3" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Semi Joins</h3>
<p>First of these is <code>semi_join</code> which essentially filters those rows from a data frame, which are based on another data frame. See this example-</p>
<div class="sourceCode" id="cb972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb972-1"><a href="combining-tablestabular-data.html#cb972-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb972-2"><a href="combining-tablestabular-data.html#cb972-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>),</span>
<span id="cb972-3"><a href="combining-tablestabular-data.html#cb972-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">21</span>, <span class="dv">100</span>)</span>
<span id="cb972-4"><a href="combining-tablestabular-data.html#cb972-4" tabindex="-1"></a>)</span>
<span id="cb972-5"><a href="combining-tablestabular-data.html#cb972-5" tabindex="-1"></a>df1</span></code></pre></div>
<pre><code>##    x   y
## 1  1  11
## 2  2  21
## 3 NA 100</code></pre>
<div class="sourceCode" id="cb974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb974-1"><a href="combining-tablestabular-data.html#cb974-1" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb974-2"><a href="combining-tablestabular-data.html#cb974-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="cn">NA</span>),</span>
<span id="cb974-3"><a href="combining-tablestabular-data.html#cb974-3" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">301</span>, <span class="dv">401</span>, <span class="dv">501</span>)</span>
<span id="cb974-4"><a href="combining-tablestabular-data.html#cb974-4" tabindex="-1"></a>)</span>
<span id="cb974-5"><a href="combining-tablestabular-data.html#cb974-5" tabindex="-1"></a>df2</span></code></pre></div>
<pre><code>##    x   z
## 1  1 101
## 2  3 301
## 3  4 401
## 4 NA 501</code></pre>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="combining-tablestabular-data.html#cb976-1" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">semi_join</span>(df2, <span class="at">by =</span> <span class="st">&#39;x&#39;</span>)</span></code></pre></div>
<pre><code>##    x   y
## 1  1  11
## 2 NA 100</code></pre>
</div>
<div id="anti-joins" class="section level3" number="15.3.2">
<h3><span class="header-section-number">15.3.2</span> Anti Joins</h3>
<p>The <code>anti_join</code> is basically opposite to that of <code>semi_join</code>. It keeps only those records from left data-frame which are not available in right data-frame. Example</p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="combining-tablestabular-data.html#cb978-1" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">anti_join</span>(df2, <span class="at">by =</span> <span class="st">&#39;x&#39;</span>)</span></code></pre></div>
<pre><code>##   x  y
## 1 2 21</code></pre>
</div>
</div>
<div id="relational-but-non-equi-joins" class="section level2" number="15.4">
<h2><span class="header-section-number">15.4</span> Relational, but non-equi joins</h2>
<p>Till now, we have learnt joins that use syntax of dplyr version before 1.1.0. However, in dplyr newest version, 1.1.0, released in January 2023, a new helper function <code>join_by()</code> has been introduced. It actually, constructs a specification that describes how to join two tables using a small domain specific language. The result can be supplied as the by argument to any of the join functions that we have learnt above. For equal joins, we have learnt above, there are two slight but easier to implement changes if we use <code>join_by()</code> -</p>
<ul>
<li>we may pass variable names in by argument instead of using characters as described above.</li>
<li>instead of using <code>=</code> we have to use <code>==</code> which is actually the equality operator as opposed to assignment operator we were using earlier.</li>
</ul>
<p>So our syntax for <code>left_join</code> example is</p>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb980-1"><a href="combining-tablestabular-data.html#cb980-1" tabindex="-1"></a>band_instruments2</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   artist plays 
##   &lt;chr&gt;  &lt;chr&gt; 
## 1 John   guitar
## 2 Paul   bass  
## 3 Keith  guitar</code></pre>
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb982-1"><a href="combining-tablestabular-data.html#cb982-1" tabindex="-1"></a><span class="fu">left_join</span>(band_members, band_instruments2, <span class="at">by =</span> <span class="fu">join_by</span>(name <span class="sc">==</span> artist))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   name  band    plays 
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
## 1 Mick  Stones  &lt;NA&gt;  
## 2 John  Beatles guitar
## 3 Paul  Beatles bass</code></pre>
<p>Simple, isn’t it. But now using the potential of this new helper function, we can on the other hand join two (or more data frames) using inequality conditions.</p>
<div id="inequality-joins" class="section level3" number="15.4.1">
<h3><span class="header-section-number">15.4.1</span> Inequality Joins</h3>
<p>Inequality joins match on an inequality, such as <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, or <code>&lt;=</code>, and are common in time series analysis and genomics. To construct an inequality join using <code>join_by()</code>, we have to supply two column names separated by one of the above mentioned inequalities. See the following example for better understanding of inequality joins.</p>
<p>Example- Suppose we have two tables, one containing product-wise <code>sales</code> and another containing <code>rates</code> as and when these are revised. So, in order to have total sales amount, we can use inequality join.</p>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb984-1"><a href="combining-tablestabular-data.html#cb984-1" tabindex="-1"></a><span class="co"># sales</span></span>
<span id="cb984-2"><a href="combining-tablestabular-data.html#cb984-2" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb984-3"><a href="combining-tablestabular-data.html#cb984-3" tabindex="-1"></a>  <span class="at">product.id =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb984-4"><a href="combining-tablestabular-data.html#cb984-4" tabindex="-1"></a>  <span class="at">sales.date =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;01-01-2022&quot;</span>,</span>
<span id="cb984-5"><a href="combining-tablestabular-data.html#cb984-5" tabindex="-1"></a>                 <span class="st">&quot;02-02-2022&quot;</span>,<span class="st">&quot;05-11-2022&quot;</span>,<span class="st">&quot;05-04-2022&quot;</span>,</span>
<span id="cb984-6"><a href="combining-tablestabular-data.html#cb984-6" tabindex="-1"></a>                 <span class="st">&quot;05-10-2022&quot;</span>,<span class="st">&quot;01-02-2022&quot;</span>,<span class="st">&quot;01-01-2023&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m-%Y&quot;</span>),</span>
<span id="cb984-7"><a href="combining-tablestabular-data.html#cb984-7" tabindex="-1"></a>  <span class="at">quantity =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="dt">L</span>, <span class="dv">10</span><span class="dt">L</span>, <span class="dv">15</span><span class="dt">L</span>, <span class="dv">5</span><span class="dt">L</span>, <span class="dv">15</span><span class="dt">L</span>, <span class="dv">1</span><span class="dt">L</span>, <span class="dv">2</span><span class="dt">L</span>)</span>
<span id="cb984-8"><a href="combining-tablestabular-data.html#cb984-8" tabindex="-1"></a>)</span>
<span id="cb984-9"><a href="combining-tablestabular-data.html#cb984-9" tabindex="-1"></a><span class="co"># Print it</span></span>
<span id="cb984-10"><a href="combining-tablestabular-data.html#cb984-10" tabindex="-1"></a>sales</span></code></pre></div>
<pre><code>##   product.id sales.date quantity
## 1          A 2022-01-01        5
## 2          A 2022-02-02       10
## 3          A 2022-11-05       15
## 4          A 2022-04-05        5
## 5          A 2022-10-05       15
## 6          B 2022-02-01        1
## 7          B 2023-01-01        2</code></pre>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="combining-tablestabular-data.html#cb986-1" tabindex="-1"></a><span class="co"># rates</span></span>
<span id="cb986-2"><a href="combining-tablestabular-data.html#cb986-2" tabindex="-1"></a>rates <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb986-3"><a href="combining-tablestabular-data.html#cb986-3" tabindex="-1"></a>  <span class="at">product.id =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb986-4"><a href="combining-tablestabular-data.html#cb986-4" tabindex="-1"></a>  <span class="at">revision.date =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;01-02-2022&quot;</span>,</span>
<span id="cb986-5"><a href="combining-tablestabular-data.html#cb986-5" tabindex="-1"></a>                    <span class="st">&quot;03-04-2022&quot;</span>,<span class="st">&quot;05-10-2022&quot;</span>,<span class="st">&quot;01-01-2022&quot;</span>,</span>
<span id="cb986-6"><a href="combining-tablestabular-data.html#cb986-6" tabindex="-1"></a>                    <span class="st">&quot;05-10-2022&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m-%Y&quot;</span>),</span>
<span id="cb986-7"><a href="combining-tablestabular-data.html#cb986-7" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">c</span>(<span class="dv">50</span><span class="dt">L</span>, <span class="dv">60</span><span class="dt">L</span>, <span class="dv">70</span><span class="dt">L</span>, <span class="dv">500</span><span class="dt">L</span>, <span class="dv">1500</span><span class="dt">L</span>)</span>
<span id="cb986-8"><a href="combining-tablestabular-data.html#cb986-8" tabindex="-1"></a>)</span>
<span id="cb986-9"><a href="combining-tablestabular-data.html#cb986-9" tabindex="-1"></a><span class="co">#print it</span></span>
<span id="cb986-10"><a href="combining-tablestabular-data.html#cb986-10" tabindex="-1"></a>rates</span></code></pre></div>
<pre><code>##   product.id revision.date rate
## 1          A    2022-02-01   50
## 2          A    2022-04-03   60
## 3          A    2022-10-05   70
## 4          B    2022-01-01  500
## 5          B    2022-10-05 1500</code></pre>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb988-1"><a href="combining-tablestabular-data.html#cb988-1" tabindex="-1"></a><span class="co"># total sale(1st attempt)</span></span>
<span id="cb988-2"><a href="combining-tablestabular-data.html#cb988-2" tabindex="-1"></a>sales <span class="sc">%&gt;%</span> </span>
<span id="cb988-3"><a href="combining-tablestabular-data.html#cb988-3" tabindex="-1"></a>  <span class="fu">left_join</span>(rates,</span>
<span id="cb988-4"><a href="combining-tablestabular-data.html#cb988-4" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(product.id,</span>
<span id="cb988-5"><a href="combining-tablestabular-data.html#cb988-5" tabindex="-1"></a>                         sales.date <span class="sc">&gt;=</span> revision.date))</span></code></pre></div>
<pre><code>##    product.id sales.date quantity revision.date rate
## 1           A 2022-01-01        5          &lt;NA&gt;   NA
## 2           A 2022-02-02       10    2022-02-01   50
## 3           A 2022-11-05       15    2022-02-01   50
## 4           A 2022-11-05       15    2022-04-03   60
## 5           A 2022-11-05       15    2022-10-05   70
## 6           A 2022-04-05        5    2022-02-01   50
## 7           A 2022-04-05        5    2022-04-03   60
## 8           A 2022-10-05       15    2022-02-01   50
## 9           A 2022-10-05       15    2022-04-03   60
## 10          A 2022-10-05       15    2022-10-05   70
## 11          B 2022-02-01        1    2022-01-01  500
## 12          B 2023-01-01        2    2022-01-01  500
## 13          B 2023-01-01        2    2022-10-05 1500</code></pre>
<p>We got the results, but the results/rates are obtained fixed on all earlier dates. To solve this issue, we have <strong>rolling joins</strong>. See next section.</p>
</div>
<div id="rolling-joins" class="section level3" number="15.4.2">
<h3><span class="header-section-number">15.4.2</span> Rolling Joins</h3>
<p>Rolling joins are a variant of inequality joins that limit the results returned from an inequality join condition. They are useful for “rolling” the closest match forward/backwards when there isn’t an exact match. To construct a rolling join, we have to wrap inequality condition with <code>closest()</code>.</p>
<p>Above example solved by wrapping date condition in <code>closest()</code></p>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb990-1"><a href="combining-tablestabular-data.html#cb990-1" tabindex="-1"></a>sales <span class="sc">%&gt;%</span> </span>
<span id="cb990-2"><a href="combining-tablestabular-data.html#cb990-2" tabindex="-1"></a>  <span class="fu">left_join</span>(rates,</span>
<span id="cb990-3"><a href="combining-tablestabular-data.html#cb990-3" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(product.id,</span>
<span id="cb990-4"><a href="combining-tablestabular-data.html#cb990-4" tabindex="-1"></a>                         <span class="fu">closest</span>(sales.date <span class="sc">&gt;=</span> revision.date)))</span></code></pre></div>
<pre><code>##   product.id sales.date quantity revision.date rate
## 1          A 2022-01-01        5          &lt;NA&gt;   NA
## 2          A 2022-02-02       10    2022-02-01   50
## 3          A 2022-11-05       15    2022-10-05   70
## 4          A 2022-04-05        5    2022-04-03   60
## 5          A 2022-10-05       15    2022-10-05   70
## 6          B 2022-02-01        1    2022-01-01  500
## 7          B 2023-01-01        2    2022-10-05 1500</code></pre>
<p>We may see that we do not have rates for product <code>A</code> for sales made on <code>01-01-2022</code>.</p>
</div>
<div id="overlap-joins" class="section level3" number="15.4.3">
<h3><span class="header-section-number">15.4.3</span> Overlap Joins</h3>
<p>Overlap joins are a special case of inequality joins involving one or two columns from the left-hand table overlapping a range defined by two columns from the right-hand table. There are three helpers that <code>join_by()</code> recognizes to assist with constructing overlap joins, all of which can be constructed from simpler inequalities.</p>
<ul>
<li><p><code>between(x, y_lower, y_upper, ..., bounds = "[]")</code> which is just short for <code>x &gt;= y_lower, x &lt;= y_upper</code></p></li>
<li><p><code>within(x_lower, x_upper, y_lower, y_upper)</code> which is just short for <code>x_lower &gt;= y_lower, x_upper &lt;= y_upper</code></p></li>
<li><p><code>overlaps(x_lower, x_upper, y_lower, y_upper, ..., bounds = "[]")</code> which is short for <code>x_lower &lt;= y_upper, x_upper &gt;= y_lower</code></p></li>
</ul>
<p>We can make use of these functions as per our need.</p>
<p>Example-2: Suppose we have <code>orders</code> data where we have customer-wise orders, corresponsing order dates and ship dates. Let us suppose we want to know about customers who placed another order, without waiting for shipping of any of their previous/earlier order.</p>
<div class="sourceCode" id="cb992"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb992-1"><a href="combining-tablestabular-data.html#cb992-1" tabindex="-1"></a>orders <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">list</span>(<span class="at">customer_id =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, </span>
<span id="cb992-2"><a href="combining-tablestabular-data.html#cb992-2" tabindex="-1"></a><span class="st">&quot;C&quot;</span>), <span class="at">order_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">order_date =</span> <span class="fu">c</span>(<span class="st">&quot;2019-01-01&quot;</span>, <span class="st">&quot;2019-01-05&quot;</span>, </span>
<span id="cb992-3"><a href="combining-tablestabular-data.html#cb992-3" tabindex="-1"></a><span class="st">&quot;2019-01-16&quot;</span>, <span class="st">&quot;2019-01-05&quot;</span>, <span class="st">&quot;2019-01-06&quot;</span>, <span class="st">&quot;2019-01-07&quot;</span>, <span class="st">&quot;2019-01-09&quot;</span></span>
<span id="cb992-4"><a href="combining-tablestabular-data.html#cb992-4" tabindex="-1"></a>), <span class="at">ship_date =</span> <span class="fu">c</span>(<span class="st">&quot;2019-01-30&quot;</span>, <span class="st">&quot;2019-02-10&quot;</span>, <span class="st">&quot;2019-01-18&quot;</span>, <span class="st">&quot;2019-01-08&quot;</span>, </span>
<span id="cb992-5"><a href="combining-tablestabular-data.html#cb992-5" tabindex="-1"></a><span class="st">&quot;2019-01-08&quot;</span>, <span class="st">&quot;2019-01-08&quot;</span>, <span class="st">&quot;2019-01-10&quot;</span>)), <span class="at">row.names =</span> <span class="fu">c</span>(<span class="cn">NA</span>, </span>
<span id="cb992-6"><a href="combining-tablestabular-data.html#cb992-6" tabindex="-1"></a><span class="sc">-</span><span class="dv">7</span><span class="dt">L</span>), <span class="at">class =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb992-7"><a href="combining-tablestabular-data.html#cb992-7" tabindex="-1"></a></span>
<span id="cb992-8"><a href="combining-tablestabular-data.html#cb992-8" tabindex="-1"></a><span class="co"># print </span></span>
<span id="cb992-9"><a href="combining-tablestabular-data.html#cb992-9" tabindex="-1"></a>orders</span></code></pre></div>
<pre><code>##   customer_id order_id order_date  ship_date
## 1           A        1 2019-01-01 2019-01-30
## 2           A        2 2019-01-05 2019-02-10
## 3           A        3 2019-01-16 2019-01-18
## 4           B        4 2019-01-05 2019-01-08
## 5           B        5 2019-01-06 2019-01-08
## 6           C        6 2019-01-07 2019-01-08
## 7           C        7 2019-01-09 2019-01-10</code></pre>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb994-1"><a href="combining-tablestabular-data.html#cb994-1" tabindex="-1"></a><span class="co"># customers who placed the orders without</span></span>
<span id="cb994-2"><a href="combining-tablestabular-data.html#cb994-2" tabindex="-1"></a><span class="co"># waiting to ship their earlier order</span></span>
<span id="cb994-3"><a href="combining-tablestabular-data.html#cb994-3" tabindex="-1"></a>orders <span class="sc">%&gt;%</span> </span>
<span id="cb994-4"><a href="combining-tablestabular-data.html#cb994-4" tabindex="-1"></a>  <span class="fu">inner_join</span>(orders,</span>
<span id="cb994-5"><a href="combining-tablestabular-data.html#cb994-5" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">join_by</span>(customer_id,</span>
<span id="cb994-6"><a href="combining-tablestabular-data.html#cb994-6" tabindex="-1"></a>                          <span class="fu">overlaps</span>(order_date, ship_date, order_date, ship_date),</span>
<span id="cb994-7"><a href="combining-tablestabular-data.html#cb994-7" tabindex="-1"></a>                          order_id <span class="sc">&lt;</span> order_id)) </span></code></pre></div>
<pre><code>##   customer_id order_id.x order_date.x ship_date.x order_id.y order_date.y
## 1           A          1   2019-01-01  2019-01-30          2   2019-01-05
## 2           A          1   2019-01-01  2019-01-30          3   2019-01-16
## 3           A          2   2019-01-05  2019-02-10          3   2019-01-16
## 4           B          4   2019-01-05  2019-01-08          5   2019-01-06
##   ship_date.y
## 1  2019-02-10
## 2  2019-01-18
## 3  2019-01-18
## 4  2019-01-08</code></pre>
</div>
<div id="example-uses-of-rolling-joins." class="section level3" number="15.4.4">
<h3><span class="header-section-number">15.4.4</span> Example uses of rolling joins.</h3>
<p><strong>The content is under development.</strong></p>
</div>
<div id="cross-joins" class="section level3" number="15.4.5">
<h3><span class="header-section-number">15.4.5</span> Cross Joins</h3>
<p>This join matches everything with everything and therefore can be thought of as a cross product of two data frames. We can use <code>cross_join</code> for this special join. If we have <code>m</code> and <code>n</code> rows in two data frames, then as a result of cross join we will have <code>m*n</code> rows.</p>
<p>Example-</p>
<div class="sourceCode" id="cb996"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb996-1"><a href="combining-tablestabular-data.html#cb996-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">products =</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>))</span>
<span id="cb996-2"><a href="combining-tablestabular-data.html#cb996-2" tabindex="-1"></a></span>
<span id="cb996-3"><a href="combining-tablestabular-data.html#cb996-3" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb996-4"><a href="combining-tablestabular-data.html#cb996-4" tabindex="-1"></a>  <span class="fu">cross_join</span>(df)</span></code></pre></div>
<pre><code>##   products.x products.y
## 1          A          A
## 2          A          B
## 3          A          C
## 4          B          A
## 5          B          B
## 6          B          C
## 7          C          A
## 8          C          B
## 9          C          C</code></pre>

</div>
</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Audit Analytics</strong>" was written by Anil Goyal. It was last built on 2024-11-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
