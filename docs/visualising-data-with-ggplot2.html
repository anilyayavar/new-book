<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 13 Visualising data with ggplot2 | R for Audit Analytics</title>

    <meta name="author" content="Anil Goyal" />
  
   <meta name="description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 13 Visualising data with ggplot2 | R for Audit Analytics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://anilyayavar.github.io/new-book/" />
  <meta property="og:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <meta property="og:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Visualising data with ggplot2 | R for Audit Analytics" />
  
  <meta name="twitter:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
  <meta name="twitter:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.8.0/transition.js"></script>
    <script src="libs/bs3compat-0.8.0/tabs.js"></script>
    <script src="libs/bs3compat-0.8.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
    <style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Audit Analytics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="visualising-data-with-ggplot2" class="section level1" number="13">
<h1><span class="header-section-number">Chapter 13</span> Visualising data with <code>ggplot2</code></h1>
<div id="core-concepts-of-grammar-of-graphics" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Core concepts of <strong>grammar of graphics</strong></h2>
<p><strong>ggplot2</strong><a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a><span class="citation"><a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a></span> is the package developed by Hadley Wickham, which is based on concepts laid (2005) down by Leland Wilkinson in his <em>The Grammar of Graphics</em>.<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a> Basically, <strong>grammar of graphics</strong> is a framework which follows a layered approach to describe and construct visualizations or graphics in a structured manner. Even the letters <code>gg</code> in ggplot2 stand for <code>g</code>grammar of <code>g</code>raphics.</p>
<p>Hadley Wickham, in his paper titled <strong>A Layered Grammar of Graphics</strong><a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a>(2010)<span class="citation"><a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a></span> proposed his idea of layered grammar of graphics in detail and simultaneously put forward his idea of <em>ggplot2</em> as an open source implementation framework for building graphics. Readers/Users are advised to check the paper as it describes the concept of grammar of graphics in detail. By the end of the decade the package progressed<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a> to one of the most used and popular packages in R.</p>
<p>The relationship between the components explained in both the grammars can be illustrated with the image<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a> in Figure <a href="visualising-data-with-ggplot2.html#fig:rgg1">13.1</a>. The components on the left have been put forward by Wilkinson whereas those on right were proposed by Wickham. It may be seen that <code>TRANS</code> has no relation in <code>ggplot2</code> as its role is played by in-built features of R.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg1"></span>
<img src="images/layers_gg.png" alt="Layers in Grammar of Graphics mapped in GGPLOT2" width="50%" height="40%" />
<p class="caption">
Figure 13.1: Layers in Grammar of Graphics mapped in GGPLOT2
</p>
</div>
<p>Thus, to build a graphic having one or more dimensions, from a given data, we use <em>seven</em> major components -</p>
<ol style="list-style-type: decimal">
<li><strong>Data:</strong> Unarguably, a graphic/visualisation should start with a
data. It is also the first argument in most important function in
the package i.e. <code>ggplot(data =)</code>.</li>
<li><strong>Aesthetics:</strong> or <code>aes()</code> in short, provide a <strong>mapping</strong> of
various data dimensions to axes so as to provide positions to
various data points in the output plot/graphic.</li>
<li><strong>Geometries:</strong> or <code>geoms</code> for short, are used to provide the
<em>geometries</em> so that data points may take a concrete shape on the
visualisation. For e.g. the data points should be depicted as bars
or scatter points or else are decided by the provided <code>geoms.</code></li>
<li><strong>Statistics:</strong> or <code>stat</code> for short, provides the statistics to show
in the visualisation like measures of central tendency, etc.</li>
<li><strong>Scale:</strong> This component is used to decide whether any dimension
needs some scaling like logarithmic transformation, etc.</li>
<li><strong>Coordinate System:</strong> Though most of the time <em>Cartesian coordinate
system</em> is used, yet there are times when <em>polar coordinate system</em>
(e.g. pie chart) or <em>spherical coordinate system</em> (e.g. geographical
maps) are used.</li>
<li><strong>Facets:</strong> Used when based on certain dimension, the plot is
divided into further sub-plots.</li>
</ol>
<p>Out of the afore-mentioned components, first three (<code>data</code>, <code>aesthetics</code> and <code>geometries</code>) are to be explicitly provided and thus can be understood as mandatory components. Whilst these three components are mandatorily provided, it is not that others are not mandatory. It is just that other components have their defaults (e.g. default coordinate system is Cartesian coordinate system). Let us dive into these three essential components and build a plot using these.</p>
</div>
<div id="building-a-basic-plot-using-key-components" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Building a basic plot using key components</h2>
<p>We will use <code>mtcars</code> data-sets, which is a default dataset in the package, to learn the concepts. Let us see what happens when <code>data</code> is provided to <code>ggplot</code> function-</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="visualising-data-with-ggplot2.html#cb765-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb765-2"><a href="visualising-data-with-ggplot2.html#cb765-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figblank"></span>
<img src="DauR_files/figure-html/figblank-1.png" alt="Data provided to ggplot2" width="100%" />
<p class="caption">
Figure 13.2: Data provided to ggplot2
</p>
</div>
<p>In Figure <a href="visualising-data-with-ggplot2.html#fig:figblank">13.2</a> we can see that a blank chart/plot space has been created as our data <code>mtcars</code> has now mapped with ggplot2. Now, let us provide aesthetic mappings to this using function <code>aes()</code>, through the argument <code>mapping</code> in <code>ggplot2</code> function itself.</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="visualising-data-with-ggplot2.html#cb766-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>wt, <span class="at">y=</span>mpg))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg2"></span>
<img src="DauR_files/figure-html/rgg2-1.png" alt="Data and mapping provided to ggplot2" width="100%" />
<p class="caption">
Figure 13.3: Data and mapping provided to ggplot2
</p>
</div>
<p>In Figure <a href="visualising-data-with-ggplot2.html#fig:rgg2">13.3</a>, we may now notice that apart from creating a blank space for plot, the two dimensions provided, i.e. <code>wt</code> and <code>mpg</code> have been <em>mapped</em> with <code>x</code> and <code>y</code> axes respectively. Since no geometry has been provided, the plot area is still blank. Now we will provide geometry to our dimension say <em>point</em>. To do this we will use another family of functions i.e. <code>geom_*</code> (<code>geom_point()</code> in this case specifically).</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="visualising-data-with-ggplot2.html#cb767-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb767-2"><a href="visualising-data-with-ggplot2.html#cb767-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg3"></span>
<img src="DauR_files/figure-html/rgg3-1.png" alt="Data plotted as points in a scatterplot" width="100%" />
<p class="caption">
Figure 13.4: Data plotted as points in a scatterplot
</p>
</div>
<p>In Figure <a href="visualising-data-with-ggplot2.html#fig:rgg3">13.4</a> we may now notice that data has been plotted
as points (due to the geometry we used <code>geom_point</code>) as soon as we added
another layer of function <code>ggplot()</code> using a <code>+</code> sign in the earlier
code. <strong>Using the code above, we have actually plotted the relationship
between weight of the vehicle (<code>wt</code>) and mileage in miles per gallon
(<code>mpg</code>) of the vehicles available in <code>mpg</code> dataset.</strong></p>
<p>We could have plotted the data as box-plot if we had used another
geometry say <code>geom_boxplot</code> here. Refer Figure <a href="visualising-data-with-ggplot2.html#fig:rgg4">13.5</a>.</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="visualising-data-with-ggplot2.html#cb768-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> wt)) <span class="sc">+</span></span>
<span id="cb768-2"><a href="visualising-data-with-ggplot2.html#cb768-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg4"></span>
<img src="DauR_files/figure-html/rgg4-1.png" alt="Data plotted as boxplot" width="100%" />
<p class="caption">
Figure 13.5: Data plotted as boxplot
</p>
</div>
<p>That’s the basic architecture for construction of a plot in this
package. Up to this point it may be noted that we have provided <code>data</code>
and <code>aesthetics</code> as argument to function <code>ggplot</code> and for <code>geometry</code> we
have used another function <code>geom_*</code> and added it to above components
using a plus <code>+</code> sign. In the above code(s) it may also be noted that
<code>data</code> and <code>mapping</code> are the first two arguments of function <code>ggplot</code>;
<code>x</code> and <code>y</code> are the default first two arguments of function <code>aes</code> so we
may draw the same plot in Figure <a href="visualising-data-with-ggplot2.html#fig:rgg3">13.4</a> using the following
code wherein we haven’t used these as named arguments. We will follow
the same convention in subsequent sections.</p>
<pre><code>ggplot(mtcars, aes(wt, mpg)) +
  geom_point()</code></pre>
<p>Now lets discuss more on <code>aesthetics</code> and <code>geometries</code> and using these
to build the desired plots, before moving on to other components of plot
in the package.</p>
</div>
<div id="AESTH" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Other Aesthetic attributes (color, shape, size, etc.)</h2>
<p>In previous section of this chapter we mapped the attributes in data
using the <code>position</code> in coordinate system (<code>x</code> and/or <code>y</code> in Cartesian
coordinate system). We can, however, map other variables in the data to
the plot using aesthetic attributes like <code>shape</code>, <code>size</code>, <code>color</code>,
<code>alpha</code> (transparency), etc., as shown in the image in Figure
<a href="visualising-data-with-ggplot2.html#fig:rrgg5">13.6</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rrgg5"></span>
<img src="images/aes.png" alt="Some Common Aesthetic mappings.  Image Source: Claus Wilke's book on Fundamentals of Data Visualization" width="576" />
<p class="caption">
Figure 13.6: Some Common Aesthetic mappings. Image Source: Claus Wilke’s book on Fundamentals of Data Visualization
</p>
</div>
<p>These aesthetics may be divided broadly into two categories -</p>
<ul>
<li>aesthetics those can be mapped with <code>continuous</code> data variable(s);
and</li>
<li>aesthetics those can be mapped with <code>discrete</code> or categorical data
variables.</li>
</ul>
<p>For example, <code>position</code> (coordinates in a coordinate system), <code>size</code>,
<code>color</code>, <code>linewidth</code> can represent continuous data; but <code>shape</code>,
<code>linetype</code> etc. aesthetics can be mapped with discrete data. Numerical
data which can be used to represent both <code>continuous</code> and <code>discrete</code>
data (we will see example shortly) if mapped to an aesthetic will by
default represent continuous data and thus, need to be converted to a
discrete data type (factor, in most of the cases will suffice) before
mapping to an aesthetic representing discrete data.</p>
<p>Some commonly used aesthetics are -</p>
<ul>
<li><code>shape</code> = Display a point with <code>geom_point()</code> as a dot, star,
triangle, or square</li>
<li><code>fill</code> = The interior color (e.g. of a bar or box-plot)</li>
<li><code>color</code> = The exterior line of a <code>bar</code>, <code>boxplot</code>, etc., or the
point color if using <code>geom_point()</code></li>
<li><code>size</code> = Size (e.g. line thickness, point size)</li>
<li><code>alpha</code> = Transparency (<code>1 = opaque</code>, <code>0 = invisible</code>)</li>
<li><code>binwidth</code> = Width of histogram bins</li>
<li><code>width</code> = Width of “bar plot” columns</li>
<li><code>linetype</code> = Line type (e.g. solid, dashed, dotted)</li>
</ul>
<div id="color-the-most-important-aesthetic" class="section level3" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Color, the most important aesthetic</h3>
<p>Data elements can be colored in a data visualisation using aesthetic
named <code>color</code> (Alternative British spelling <code>colour</code> will also work in
exactly same way). We can use color in a plot/visualisation primarily
for three purposes-</p>
<ul>
<li>highlight specific or all values.</li>
<li>grouping the data points i.e. using color to distinguish data
elements from each other.</li>
<li>mapping a variable, i.e. using color to represent different data
elements.</li>
</ul>
<p>To understand the use cases, let us fill the color of all points in
Figure @(fig:rgg3) with say, <code>"red"</code> color. To do this, we can provide
the value of <code>color</code> aesthetic directly inside the <code>geom_*</code> function
(Figure <a href="visualising-data-with-ggplot2.html#fig:rgg5">13.7</a>).</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="visualising-data-with-ggplot2.html#cb770-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb770-2"><a href="visualising-data-with-ggplot2.html#cb770-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg5"></span>
<img src="DauR_files/figure-html/rgg5-1.png" alt="Highlighting all data points with a static color" width="672" />
<p class="caption">
Figure 13.7: Highlighting all data points with a static color
</p>
</div>
<p>As the argument <code>color='red'</code> was mentioned inside the <code>geom_point()</code>
function, it turned every point to red (i.e. with a static color) in
Figure <a href="visualising-data-with-ggplot2.html#fig:rgg5">13.7</a>. But if the requirement was to highlight specific
points in the plot, we have to use the <code>color</code> inside <code>aes</code> function. Or
in other words, we have to use color <code>aesthetics</code> to visualise the data.</p>
<p>So let us color the data points in Figure <a href="visualising-data-with-ggplot2.html#fig:rgg5">13.7</a> using the
variable <code>cyl</code> (number of cylinders in the vehicle), so that the
scatter-points are colored on the basis of number of cylinders instead.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="visualising-data-with-ggplot2.html#cb771-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb771-2"><a href="visualising-data-with-ggplot2.html#cb771-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>cyl))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg6"></span>
<img src="DauR_files/figure-html/rgg6-1.png" alt="Mapping a numeric variable with color aesthetic" width="672" />
<p class="caption">
Figure 13.8: Mapping a numeric variable with color aesthetic
</p>
</div>
<p>We may notice in Figure <a href="visualising-data-with-ggplot2.html#fig:rgg6">13.8</a> that scatter-points are now
colored on the basis of number of cylinders in the cars. Simultaneously,
a color scale has been produced as a legend. Since the <code>cyl</code> column was
a numeric column, and we mapped that with a <code>continuous</code> type aesthetic
color, it mapped the continuous variable with the aesthetic by default.
Now in this case, though the <code>cyl</code> is having numerical values, the plot
will be more meaningful if the corresponding <code>discrete</code> variable is
mapped with color aesthetic. So we can convert it into a factor type
variable, on the fly.</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="visualising-data-with-ggplot2.html#cb772-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb772-2"><a href="visualising-data-with-ggplot2.html#cb772-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">as.factor</span>(cyl)))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg7"></span>
<img src="DauR_files/figure-html/rgg7-1.png" alt="Mapping a discrete variable with color aesthetic" width="672" />
<p class="caption">
Figure 13.9: Mapping a discrete variable with color aesthetic
</p>
</div>
<p>In Figure <a href="visualising-data-with-ggplot2.html#fig:rgg7">13.9</a> we may see that the points have been grouped
using different color of each of the group. Readers may also that the
<code>color</code> aesthetic was provided through <code>aes()</code> function in the second
layer which was wrapped in <code>geom_point()</code> function. The aesthetic could
have been wrapped in <code>ggplot()</code> layer also. So basically the following
code will also produce exactly the same chart-</p>
<pre><code>ggplot(mtcars, aes(wt, mpg, color = as.factor(cyl))) +
  geom_point()</code></pre>
<p>So is there any difference between the two? Yes, basically aesthetics if
provided under the <code>geoms</code>, will override those aesthetics which are
already provided under <code>ggplot</code> function. To understand the difference,
see the result of following code in Figure <a href="visualising-data-with-ggplot2.html#fig:rgg8">13.10</a>.</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="visualising-data-with-ggplot2.html#cb774-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg, <span class="at">color =</span> <span class="fu">as.factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb774-2"><a href="visualising-data-with-ggplot2.html#cb774-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg8"></span>
<img src="DauR_files/figure-html/rgg8-1.png" alt="Over-riding aesthetics" width="672" />
<p class="caption">
Figure 13.10: Over-riding aesthetics
</p>
</div>
<p>As the third use-case, i.e. using color to describe the variable, let us
analyse the mean mileage of cars for each group of cars for (i) number
of cylinders <code>cyl</code> and (ii) number of carburetors <code>carb</code>. A good
visualisation to plot the values will be <em>heat-map</em> (sometimes also
called as <em>highlight table</em>). We will generate a grouped summary before
proceeding, which can be understood using the concepts explained in
chapter related to data manipulation in dplyr i.e. Chapter
<a href="DPLYRR.html#DPLYRR">14</a>.</p>
<p>To draw the rectangular boxes in heat-map we will use another geometry
namely <code>geom_tile()</code> and map two categorical variables with <code>x</code> and <code>y</code>
coordinates in the Cartesian system. To fill the color values on the
basis of variable <code>mpg</code> we will use <code>fill</code> aesthetic instead of <code>color</code>
(we will understand the difference between <code>fill</code> and <code>color</code> aesthetics
shortly).</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="visualising-data-with-ggplot2.html#cb775-1" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> </span>
<span id="cb775-2"><a href="visualising-data-with-ggplot2.html#cb775-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mpg =</span> <span class="fu">mean</span>(mpg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb775-3"><a href="visualising-data-with-ggplot2.html#cb775-3" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(cyl, carb)) <span class="sc">|&gt;</span> </span>
<span id="cb775-4"><a href="visualising-data-with-ggplot2.html#cb775-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb775-5"><a href="visualising-data-with-ggplot2.html#cb775-5" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x =</span> cyl, <span class="at">y =</span> carb, <span class="at">fill =</span> mpg))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg9"></span>
<img src="DauR_files/figure-html/rgg9-1.png" alt="using color to plot variable directly" width="672" />
<p class="caption">
Figure 13.11: using color to plot variable directly
</p>
</div>
<p>Referring plot in Figure <a href="visualising-data-with-ggplot2.html#fig:rgg9">13.11</a> we may see that cars with 4
cylinders and 1 carburetor have highest mileage.</p>
<p>So up to now, we have seen that to map color dynamically with a
variable, we have pass this aesthetic inside <code>aes</code> function; and
otherwise if we intend to use color only as a static value, we may pass
it outside the <code>aes</code> i.e. directly in the corresponding <code>geom</code> function.
Package ggplot2 recognises most of the color names and we have discussed
more about colors in Appendix <a href="COLORR.html#COLORR">A</a>. But what if we pass a
static color value to <code>color</code> aesthetic inside the <code>aes</code> function? Let
us check ourselves.</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="visualising-data-with-ggplot2.html#cb776-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb776-2"><a href="visualising-data-with-ggplot2.html#cb776-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg10"></span>
<img src="DauR_files/figure-html/rgg10-1.png" alt="Mapping Static color inside aes" width="672" />
<p class="caption">
Figure 13.12: Mapping Static color inside aes
</p>
</div>
<p>Interesting! GGPLOT2 has not only mapped a dummy variable called
<code>'blue'</code> with color of points, but also created a legend. More
interestingly the color is not what we wanted. Actually, what happened
was, that when we mapped color aesthetic inside <code>aes()</code>, ggplot2 created
a new variable on the fly, and then mapped it with the aesthetic and
thus producing a legend for the newly created variable.</p>
</div>
<div id="color-vs.-fill" class="section level3" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> Color Vs. Fill</h3>
<p>Till now we use used <code>color</code> aesthetic with the <code>point</code> geom (Figure
<a href="visualising-data-with-ggplot2.html#fig:rgg7">13.9</a>) and <code>fill</code> aesthetic in <code>tile</code> geom (Figure
<a href="visualising-data-with-ggplot2.html#fig:rgg9">13.11</a>) to map colors to the variables. Why did we use
different aesthetics? Typically, the <code>color</code> aesthetic changes the
outline of a geom and the <code>fill</code> aesthetic changes the inside.
<code>geom_point()</code> was an exception, we used <code>color</code> (not <code>fill</code>) for the
point color. Actually, it was not an exception too. The reason was that
the default point shape used by <code>geom_point()</code> was <code>shape = 19</code>: a solid
circle.</p>
<p>We can see the subtle difference if we override the default shape in
figure <a href="visualising-data-with-ggplot2.html#fig:rgg7">13.9</a> with <code>shape = 21</code>: a circle that allows us to use
both <code>fill</code> for the inside and <code>color</code> for the outline. (Figures
<a href="visualising-data-with-ggplot2.html#fig:rgg11">13.13</a>.)</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="visualising-data-with-ggplot2.html#cb777-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb777-2"><a href="visualising-data-with-ggplot2.html#cb777-2" tabindex="-1"></a></span>
<span id="cb777-3"><a href="visualising-data-with-ggplot2.html#cb777-3" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb777-4"><a href="visualising-data-with-ggplot2.html#cb777-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">as.factor</span>(cyl)), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb777-5"><a href="visualising-data-with-ggplot2.html#cb777-5" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Using color aesthetic&quot;</span>)</span>
<span id="cb777-6"><a href="visualising-data-with-ggplot2.html#cb777-6" tabindex="-1"></a></span>
<span id="cb777-7"><a href="visualising-data-with-ggplot2.html#cb777-7" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb777-8"><a href="visualising-data-with-ggplot2.html#cb777-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">as.factor</span>(cyl)), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb777-9"><a href="visualising-data-with-ggplot2.html#cb777-9" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Using fill aesthetic&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg11"></span>
<img src="DauR_files/figure-html/rgg11-1.png" alt="Color Vs. Fill aesthetics" width="672" /><img src="DauR_files/figure-html/rgg11-2.png" alt="Color Vs. Fill aesthetics" width="672" />
<p class="caption">
Figure 13.13: Color Vs. Fill aesthetics
</p>
</div>
</div>
<div id="transparency-through-alpha" class="section level3" number="13.3.3">
<h3><span class="header-section-number">13.3.3</span> Transparency through <code>alpha</code></h3>
<p>In <code>ggplot2</code>, there is one more aesthetic which is used to change color
of the geometries, <code>alpha</code> which is used to control the transparency of
the elements in a plot. By adjusting the <code>alpha</code> value, which ranges
from 0 (completely transparent) to 1 (fully opaque), we can manage the
visibility and layering of overlapping elements. This is particularly
useful when dealing with dense data, as it helps to reduce over-plotting
and allows for better visualization of distributions and relationships.
Usually, it is used to map a continuous variable with it. Example-</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="visualising-data-with-ggplot2.html#cb778-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb778-2"><a href="visualising-data-with-ggplot2.html#cb778-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> cyl), <span class="at">size =</span> <span class="dv">4</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg12"></span>
<img src="DauR_files/figure-html/rgg12-1.png" alt="Setting transparency with the number of cylinders" width="672" />
<p class="caption">
Figure 13.14: Setting transparency with the number of cylinders
</p>
</div>
<p>We may see in figure <a href="visualising-data-with-ggplot2.html#fig:rgg12">13.14</a> that points transparency nor
varies according to the number of cylinders i.e. <code>cyl</code> variable in the
data. Similar to other aesthetics we may pass static value between 0 to
1 to <code>alpha</code> for setting the transparency of geometries as desired.</p>
</div>
<div id="shape-aesthetic" class="section level3" number="13.3.4">
<h3><span class="header-section-number">13.3.4</span> Shape Aesthetic</h3>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg11">13.13</a>, we already saw the shape aesthetic to change
the shape of points from solid color to hollow color. Actually, in
<code>ggplot2</code>, the <code>shape</code> aesthetic is used to differentiate points in a
plot by assigning different symbols to them. Moreover, as we have
already discussed, this aesthetic should either be mapped with a
discrete variable; or if using shape from pre-existing shapes in the
package (see <code>?points</code>). <code>ggplot2</code> supports a variety of shapes, such as
circles, triangles, squares, and more, each represented by a unique
integer or character.</p>
<p>For instance, when plotting data with a categorical variable, we can map
this variable to the <code>shape</code> aesthetic to visually separate the groups.
However, it’s important to note that shapes can be less effective for
groups with many categories, as the distinctiveness of each shape may
diminish.</p>
<p>So in the above plots, we may map <code>cyl</code> variable to shape instead, by
converting it into factor variable.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="visualising-data-with-ggplot2.html#cb779-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb779-2"><a href="visualising-data-with-ggplot2.html#cb779-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span><span class="fu">as.factor</span>(cyl)), <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg13"></span>
<img src="DauR_files/figure-html/rgg13-1.png" alt="Mapping shape aesthetic" width="672" />
<p class="caption">
Figure 13.15: Mapping shape aesthetic
</p>
</div>
<p>In above we may notice that different shapes have been used for 4, 6 and
8 cylinder vehicles.</p>
<p><strong>A few shapes available in <code>shape</code> aesthetics, with <code>fill</code> aesthetic
shown in <code>orange' and</code>color` aesthetic shown in ‘blue’ color in
figure</strong> <a href="visualising-data-with-ggplot2.html#fig:shapes">13.16</a><strong>.</strong></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:shapes"></span>
<img src="shapes.png" alt="Some Shapes available in GGplot" width="99%" />
<p class="caption">
Figure 13.16: Some Shapes available in GGplot
</p>
</div>
</div>
<div id="size-aesthetic" class="section level3" number="13.3.5">
<h3><span class="header-section-number">13.3.5</span> Size Aesthetic</h3>
<p>As we have already seen that the <code>size</code> aesthetic controls the size of
plot elements or geometries, such as points in a scatter plot. By
mapping a continuous or discrete variable to <code>size</code>, we can represent
additional dimensions of our data, making the plot more informative.</p>
<p>For example, in a scatter plot of car weight versus fuel efficiency, we
might use the <code>size</code> aesthetic to represent the horsepower of each car,
where larger points indicate more powerful cars.</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="visualising-data-with-ggplot2.html#cb780-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb780-2"><a href="visualising-data-with-ggplot2.html#cb780-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>hp))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg14"></span>
<img src="DauR_files/figure-html/rgg14-1.png" alt="Mapping size aesthetic" width="672" />
<p class="caption">
Figure 13.17: Mapping size aesthetic
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg14">13.17</a> we may see that a visual layer has been added
that helps to identify relationships and patterns across multiple
variables simultaneously. However, it’s essential to use the <code>size</code>
aesthetic judiciously, as overly large or small elements can distort the
readability of the plot.</p>
</div>
<div id="using-multiple-aesthetics-simultaneously" class="section level3" number="13.3.6">
<h3><span class="header-section-number">13.3.6</span> Using multiple aesthetics simultaneously</h3>
<p>Multiple aesthetics can also be mapped simultaneously, as per
requirement. See this example-</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="visualising-data-with-ggplot2.html#cb781-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars,</span>
<span id="cb781-2"><a href="visualising-data-with-ggplot2.html#cb781-2" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb781-3"><a href="visualising-data-with-ggplot2.html#cb781-3" tabindex="-1"></a>         <span class="at">x =</span> wt,</span>
<span id="cb781-4"><a href="visualising-data-with-ggplot2.html#cb781-4" tabindex="-1"></a>         <span class="at">y =</span> mpg,</span>
<span id="cb781-5"><a href="visualising-data-with-ggplot2.html#cb781-5" tabindex="-1"></a>         <span class="at">shape =</span> <span class="fu">as.factor</span>(cyl),</span>
<span id="cb781-6"><a href="visualising-data-with-ggplot2.html#cb781-6" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">as.factor</span>(gear),</span>
<span id="cb781-7"><a href="visualising-data-with-ggplot2.html#cb781-7" tabindex="-1"></a>         <span class="at">alpha =</span> wt,</span>
<span id="cb781-8"><a href="visualising-data-with-ggplot2.html#cb781-8" tabindex="-1"></a>         <span class="at">size =</span> hp</span>
<span id="cb781-9"><a href="visualising-data-with-ggplot2.html#cb781-9" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb781-10"><a href="visualising-data-with-ggplot2.html#cb781-10" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg15"></span>
<img src="DauR_files/figure-html/rgg15-1.png" alt="Using multiple aesthetics" width="672" />
<p class="caption">
Figure 13.18: Using multiple aesthetics
</p>
</div>
<p>We will learn about some other aesthetics like <code>binwidth</code>, <code>linetype</code>,
<code>width</code>, etc., in the next section <a href="visualising-data-with-ggplot2.html#geoms">13.4</a> when we will learn about
the use of other geometries.</p>
</div>
</div>
<div id="geoms" class="section level2" number="13.4">
<h2><span class="header-section-number">13.4</span> More on Geoms</h2>
<p>In previous section we have seen that as soon as we passed a <code>geom_*</code>
function/layer to <code>data</code> &amp; <code>aesthetics</code> layers, the chart/graph was
constructed. Actually, <code>geom_point()</code> function, in the background added
three more layers i.e. <code>stat</code>, <code>geom</code> and <code>position</code>, because <code>geom_*</code>
are actually shortcuts, which add these three layers. So in our example,
<code>ggplot(mtcars, aes(wt, mpg)) + geom_point()</code> is actually equivalent to
-</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="visualising-data-with-ggplot2.html#cb782-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb782-2"><a href="visualising-data-with-ggplot2.html#cb782-2" tabindex="-1"></a>  <span class="fu">layer</span>(</span>
<span id="cb782-3"><a href="visualising-data-with-ggplot2.html#cb782-3" tabindex="-1"></a>    <span class="at">data =</span> mtcars,</span>
<span id="cb782-4"><a href="visualising-data-with-ggplot2.html#cb782-4" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(wt, mpg),</span>
<span id="cb782-5"><a href="visualising-data-with-ggplot2.html#cb782-5" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb782-6"><a href="visualising-data-with-ggplot2.html#cb782-6" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb782-7"><a href="visualising-data-with-ggplot2.html#cb782-7" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">&quot;identity&quot;</span></span>
<span id="cb782-8"><a href="visualising-data-with-ggplot2.html#cb782-8" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg16"></span>
<img src="DauR_files/figure-html/rgg16-1.png" alt="Components of GGPLOT2" width="672" />
<p class="caption">
Figure 13.19: Components of GGPLOT2
</p>
</div>
<p>Some common <code>geoms</code> are listed below:</p>
<ul>
<li>Histograms - <code>geom_histogram()</code></li>
<li>Bar charts - <code>geom_bar()</code> or <code>geom_col()</code></li>
<li>Box plots - <code>geom_boxplot()</code></li>
<li>Points (e.g. scatter plots) - <code>geom_point()</code></li>
<li>Line graphs - <code>geom_line()</code> or <code>geom_path()</code></li>
<li>Trend lines - <code>geom_smooth()</code></li>
<li>Heat-map - <code>geom_tile()</code></li>
<li>Label charts using <code>geom_text()</code> and/or <code>geom_label()</code></li>
</ul>
<p>Of these, we have already seen examples of <code>geom_point</code>, <code>geom_boxplot</code>
and <code>geom_tile</code>. Let us discuss some other geoms in a bit detail.</p>
<div id="univariate-bar-charts-through-geom_bar" class="section level3" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Univariate Bar Charts through <code>geom_bar()</code></h3>
<p>Bar charts though form simplest of the visualisations but can be
deceptive if we try to build these without understanding the mechanics
behind the bars, literally :). Bar charts can both be univariate and
bivariate. Even multivariate data can be visualised through bar charts.</p>
<p>Simplest of bar charts can be a plot showing distribution of a
categorical variable in the data. In other words, the number of data
points available per category of the variable. Example - How many cars
with different cylinder count are available in the data.</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="visualising-data-with-ggplot2.html#cb783-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(cyl)) <span class="sc">+</span></span>
<span id="cb783-2"><a href="visualising-data-with-ggplot2.html#cb783-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg17"></span>
<img src="DauR_files/figure-html/rgg17-1.png" alt="Univariate Bar Chart" width="672" />
<p class="caption">
Figure 13.20: Univariate Bar Chart
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg17">13.20</a> we may see the numbers of cars available per
category (of cylinders therein). As we have used numerical variable on
the x-axis, a numerical scale has been shown. Also notice that our data
was not summarised and ggplot2 itself aggregated it on the basis of
variable passed in aesthetics (position) by applying <code>count</code> summary
function. This can be confirmed from the label on <code>y</code> axis.</p>
<p>Readers are advised to note the change in x-axis as soon as the variable
is converted to a categorical variable, by executing the code-</p>
<pre><code>ggplot(mtcars, aes(as.factor(cyl))) +
  geom_bar()</code></pre>
<p>That was about aggregating data by itself in bar-plot using <code>count</code>
function. But sometimes, other aggregation methods may be required. That
can be done if we understand the mechanics behind the code. Actually
<code>aes(cyl)</code> was a shortcut to <code>aes(x = cyl, y = after_stat(count))</code> where
<code>count</code> is a special variable representing the counts in each of the
category present in the variable.</p>
<p>So now, let us calculate proportions instead of count (frequency) of the
categories available in the variable. For a change, now let us use
another dataset <code>mpg</code> which comes by default with <code>ggplot2</code> package. We
will analyse proportion of vehicles under each <code>class</code> (which is a
categorical variable).</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="visualising-data-with-ggplot2.html#cb785-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, <span class="at">y =</span> <span class="fu">after_stat</span>(count<span class="sc">/</span><span class="fu">sum</span>(count)))) <span class="sc">+</span></span>
<span id="cb785-2"><a href="visualising-data-with-ggplot2.html#cb785-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg18"></span>
<img src="DauR_files/figure-html/rgg18-1.png" alt="Univariate Bar Chart representing proportions" width="672" />
<p class="caption">
Figure 13.21: Univariate Bar Chart representing proportions
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg18">13.21</a> we may see that now the proportions have been
plotted (notice y axis).</p>
</div>
<div id="bivariate-bar-charts-through-geom_bar" class="section level3" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Bivariate Bar Charts through <code>geom_bar()</code></h3>
<p>We have learn how the <code>geom_bar()</code> carries out a summarisation on
un-aggregated or granular data and draws plots for us. To tweak the
summary function, as per our requirement, we used <code>y</code> position
aesthetic. But in same granular data, we may sometimes require to
perform an aggregation on another variable.</p>
<p>As an example let us see the mean city mileage <code>cty</code> for every <code>class</code>
of car in <code>mpg</code> data-set. To achieve this, we will another aesthetics
<code>stat</code> with special value <code>"summary_bin"</code>. Moreover, the <code>stat</code>
aesthetics also requires a <code>fun</code> statistic which is <code>mean</code> in our case.</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="visualising-data-with-ggplot2.html#cb786-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> cty)) <span class="sc">+</span> </span>
<span id="cb786-2"><a href="visualising-data-with-ggplot2.html#cb786-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary_bin&quot;</span>, <span class="at">fun =</span> mean)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg19"></span>
<img src="DauR_files/figure-html/rgg19-1.png" alt="Bivariate Bar Chart representing mean milaege per class of car" width="672" />
<p class="caption">
Figure 13.22: Bivariate Bar Chart representing mean milaege per class of car
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg19">13.22</a> we can see that <code>subcompact</code> class of cars
has highest mean mileage in city.</p>
<p>In these two sections, we have learnt to draw plots using un-aggregated
data. However, we can also plot pre-aggregated data to bar-plots using
<code>geom_bar</code>. So let us draw the same plot as in figure <a href="visualising-data-with-ggplot2.html#fig:rgg19">13.22</a>,
but this time aggregating data by ourselves, beforehand. The trick is to
use <code>stat = "identity"</code> aesthetics in a <code>geom_bar()</code> layer. We will see
what this aesthetic is doing actually in a short-while. For a change,
this time let’s draw the plot with x and y axes flipped.</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="visualising-data-with-ggplot2.html#cb787-1" tabindex="-1"></a>aggregated_mpg <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span> </span>
<span id="cb787-2"><a href="visualising-data-with-ggplot2.html#cb787-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_cty =</span> <span class="fu">mean</span>(cty),</span>
<span id="cb787-3"><a href="visualising-data-with-ggplot2.html#cb787-3" tabindex="-1"></a>            <span class="at">.by =</span> class) </span>
<span id="cb787-4"><a href="visualising-data-with-ggplot2.html#cb787-4" tabindex="-1"></a></span>
<span id="cb787-5"><a href="visualising-data-with-ggplot2.html#cb787-5" tabindex="-1"></a><span class="fu">ggplot</span>(aggregated_mpg, <span class="fu">aes</span>(<span class="at">x =</span> mean_cty, <span class="at">y =</span> class)) <span class="sc">+</span></span>
<span id="cb787-6"><a href="visualising-data-with-ggplot2.html#cb787-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg20"></span>
<img src="DauR_files/figure-html/rgg20-1.png" alt="Bivariate Bar Chart representing mean milaege per class of car" width="672" />
<p class="caption">
Figure 13.23: Bivariate Bar Chart representing mean milaege per class of car
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg20">13.23</a> we can see the desired have been generated.
Readers may try the above-mentioned code by removing <code>stat - "identity"</code>
from the <code>geom_bar()</code>.</p>
<p>Now, as promised we will discuss what <code>stat</code> aesthetic does. While
generating summary in a bivariate chart we used <code>stat = "summary_bin"</code>
which created summary using <code>fun</code> of un-aggregated data. Whereas
<code>stat = "identity"</code> tells ggplot2 that data is either already aggregated
or there is only value of <code>y</code> per category of <code>x</code> variable. So are there
other <code>stat</code> aesthetics available for us? The answer is yes. However,
readers are advised to plot bar charts on aggregated data using
<code>geom_col</code> which has been discussed in subsequent sections, instead of
trying the complex aggregations within ggplot2 as it gets trickier from
here.</p>
</div>
<div id="stacked-bar-charts-through-geom_bar" class="section level3" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> Stacked bar charts through <code>geom_bar</code></h3>
<p>In section <a href="visualising-data-with-ggplot2.html#AESTH">13.3</a>, we learnt that we can plot other variables in
the two-dimensional plots using aesthetic attributes like color, size,
etc. As size of the bar, in a bar chart is already mapped to a variable,
most suitable aesthetic to be mapped to another variable is <code>fill</code> or
<code>color</code>.</p>
<p>Let us aggregate the cars (count) on the basis of <code>class</code> again. But
let’s map <code>fill</code> to fuel type <code>fl</code> variable.</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="visualising-data-with-ggplot2.html#cb788-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb788-2"><a href="visualising-data-with-ggplot2.html#cb788-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg24"></span>
<img src="DauR_files/figure-html/rgg24-1.png" alt="Color Stacked bar chart" width="672" />
<p class="caption">
Figure 13.24: Color Stacked bar chart
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg24">13.24</a> we achieved our desired results simply by
mapping <code>fill</code> to our additional variable. Actually, this was possible
due to default value of <code>position</code> aesthetic in <code>geom_bar()</code> layer
<code>"stack"</code> matches our requirement. By default, multiple bars occupying
the same x position will be stacked atop one another by
<code>position_stack()</code>.</p>
<p>A useful argument <code>reverse</code> in this <code>position_stack()</code> is also helpful
in reversing the order of <code>fill</code> values. E.g. if the above plot is drawn
at y-axis instead.</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="visualising-data-with-ggplot2.html#cb789-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">y =</span> class, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb789-2"><a href="visualising-data-with-ggplot2.html#cb789-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb789-3"><a href="visualising-data-with-ggplot2.html#cb789-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg25"></span>
<img src="DauR_files/figure-html/rgg25-1.png" alt="Color Stacked bar chart on Y axis" width="672" />
<p class="caption">
Figure 13.25: Color Stacked bar chart on Y axis
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg25">13.25</a> we can see that legend values now align with
the values represented in bar chart.</p>
<p>To use the bars, side by side, in a plot we can use another position
stat function <code>position_dodge()</code>. Redrawing the same plot above with
bars side by side-</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="visualising-data-with-ggplot2.html#cb790-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb790-2"><a href="visualising-data-with-ggplot2.html#cb790-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb790-3"><a href="visualising-data-with-ggplot2.html#cb790-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg26"></span>
<img src="DauR_files/figure-html/rgg26-1.png" alt="Dodged Bar Chart" width="672" />
<p class="caption">
Figure 13.26: Dodged Bar Chart
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg26">13.26</a> we may see that separate bar for each fill
axis have now been drawn. The bars’ widths have been preserved as the
default parameter for <code>preserve</code> inside <code>position_dodge()</code> is <code>total</code>.
We may have to change it to <code>"single"</code> if we want bars of equal width
irrespective of the fact that whether each fill category is available
for each of the <code>x</code> value. Refer figure <a href="visualising-data-with-ggplot2.html#fig:rgg27">13.27</a> wherein bars’
widths are equal.</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="visualising-data-with-ggplot2.html#cb791-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb791-2"><a href="visualising-data-with-ggplot2.html#cb791-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">preserve =</span> <span class="st">&quot;single&quot;</span>)) <span class="sc">+</span></span>
<span id="cb791-3"><a href="visualising-data-with-ggplot2.html#cb791-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg27"></span>
<img src="DauR_files/figure-html/rgg27-1.png" alt="Dodged Bar Chart with equal bar widths" width="672" />
<p class="caption">
Figure 13.27: Dodged Bar Chart with equal bar widths
</p>
</div>
<p>Similar to <code>position_dodge</code> there is another <code>position_dodge2()</code>
function which works better for bar charts. We may tweak the padding
between bars (Refer figure <a href="visualising-data-with-ggplot2.html#fig:rgg28">13.28</a>).</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="visualising-data-with-ggplot2.html#cb792-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb792-2"><a href="visualising-data-with-ggplot2.html#cb792-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge2</span>(<span class="at">preserve =</span> <span class="st">&quot;single&quot;</span>, <span class="at">padding =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb792-3"><a href="visualising-data-with-ggplot2.html#cb792-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg28"></span>
<img src="DauR_files/figure-html/rgg28-1.png" alt="Dodged Bar Chart with padding between bars" width="672" />
<p class="caption">
Figure 13.28: Dodged Bar Chart with padding between bars
</p>
</div>
<p>Finally, there is one more position namely <code>position_fill()</code> which
stacks bars and standardises each stack to have constant height. Refer
figure <a href="visualising-data-with-ggplot2.html#fig:rgg29">13.29</a>.</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="visualising-data-with-ggplot2.html#cb793-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb793-2"><a href="visualising-data-with-ggplot2.html#cb793-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_fill</span>()) <span class="sc">+</span></span>
<span id="cb793-3"><a href="visualising-data-with-ggplot2.html#cb793-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg29"></span>
<img src="DauR_files/figure-html/rgg29-1.png" alt="100% stacked bar chart" width="672" />
<p class="caption">
Figure 13.29: 100% stacked bar chart
</p>
</div>
</div>
<div id="bar-charts-through-geom_col" class="section level3" number="13.4.4">
<h3><span class="header-section-number">13.4.4</span> Bar Charts through <code>geom_col()</code></h3>
<p>As stated earlier, plotting bar charts on tedious aggregations through
ggplot2 gets trickier, it is always advisable to plot bar charts through
<code>geom_col()</code> in such cases after aggregating thee data ourselves. Since
the difference between <code>geom_bar</code> and <code>geom_col</code> is that former uses by
default: it counts the number of cases at each x position. On the other
hand, latter uses <code>stat = “identity”</code> by default. So to draw the plot as
in figure <a href="visualising-data-with-ggplot2.html#fig:rgg20">13.23</a> through <code>geom_col()</code> we may not have to use
<code>stat</code> explicitly. (Refer figure <a href="visualising-data-with-ggplot2.html#fig:rgg30">13.30</a>.)</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="visualising-data-with-ggplot2.html#cb794-1" tabindex="-1"></a>aggregated_mpg <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span> </span>
<span id="cb794-2"><a href="visualising-data-with-ggplot2.html#cb794-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_cty =</span> <span class="fu">mean</span>(cty),</span>
<span id="cb794-3"><a href="visualising-data-with-ggplot2.html#cb794-3" tabindex="-1"></a>            <span class="at">.by =</span> class) </span>
<span id="cb794-4"><a href="visualising-data-with-ggplot2.html#cb794-4" tabindex="-1"></a></span>
<span id="cb794-5"><a href="visualising-data-with-ggplot2.html#cb794-5" tabindex="-1"></a><span class="fu">ggplot</span>(aggregated_mpg, <span class="fu">aes</span>(<span class="at">x =</span> mean_cty, <span class="at">y =</span> class)) <span class="sc">+</span></span>
<span id="cb794-6"><a href="visualising-data-with-ggplot2.html#cb794-6" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg30"></span>
<img src="DauR_files/figure-html/rgg30-1.png" alt="Plotting through geom col" width="672" />
<p class="caption">
Figure 13.30: Plotting through geom col
</p>
</div>
<p>Once the readers have understood the functioning of <code>position</code> and
<code>stat</code> arguments in <code>geom_bar</code> it is now pretty easy to draw stacked bar
charts, dodged bar charts and 100 percent stacked bar charts through
geom_col in a much easier way. Readers may try themselves drawing these
charts using pre-aggregated data keeping in mind that <code>geom_col</code> is
using <code>stat = “identity”</code> by default and is thus not performing any
aggregation.</p>
</div>
<div id="adding-labels-to-charts-using-geom_text-or-geom_label" class="section level3" number="13.4.5">
<h3><span class="header-section-number">13.4.5</span> Adding labels to charts using <code>geom_text</code> or <code>geom_label</code></h3>
<p>Before laerning how to draw other plots using <code>geom_*</code> family of
functions, it is the right time to learn labelling the geometries in the
plots.</p>
<p>To label data points in ggplot2, we can use either of the functions (i)
<code>geom_text()</code>; (ii)<code>geom_label()</code>. <code>geom_text()</code> adds only text to the
plot; whereas <code>geom_label()</code> draws a rectangle behind the text, making
it easier to read.</p>
<p>These functions adds text provided through <code>label</code> aesthetics, to the
plot at the specified <code>x</code> and <code>y</code> coordinates. Moreover, we can
customize the appearance of the labels by adding additional arguments to
<code>geom_text()</code> -</p>
<ul>
<li><code>size</code> to set font size</li>
<li><code>color</code> to color the fonts</li>
<li><code>hjust</code> or <code>vjust</code> to adjust the labels vertically or horizontally,
respectively. We can modify text alignment with these aesthetics.
These can either be a number between <code>0</code> (right/bottom) and <code>1</code>
(top/left) or a character (<code>"left"</code>, <code>"middle"</code>, <code>"right"</code>,
<code>"bottom"</code>, <code>"center"</code>, <code>"top"</code>). There are two special alignments:
<code>"inward"</code> and <code>"outward"</code>. Inward always aligns text towards the
center, and outward aligns it away from the center.</li>
<li><code>family</code> for font family [the options are <code>“sans”</code> (the default),
<code>“serif”</code>, or <code>“mono”</code>]</li>
<li><code>fontface</code> for face of the font [options: <code>“plain”</code> (the default),
<code>“bold”</code>, <code>"italic"</code> or <code>“bold.italic”</code>]</li>
</ul>
<p>Example-</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="visualising-data-with-ggplot2.html#cb795-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb795-2"><a href="visualising-data-with-ggplot2.html#cb795-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb795-3"><a href="visualising-data-with-ggplot2.html#cb795-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(mtcars)),</span>
<span id="cb795-4"><a href="visualising-data-with-ggplot2.html#cb795-4" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb795-5"><a href="visualising-data-with-ggplot2.html#cb795-5" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb795-6"><a href="visualising-data-with-ggplot2.html#cb795-6" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="co"># -1 pushes he value further upwards (vjust)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg31"></span>
<img src="DauR_files/figure-html/rgg31-1.png" alt="Adding labels to geoms" width="672" />
<p class="caption">
Figure 13.31: Adding labels to geoms
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg31">13.31</a> we can see the geometries (i.e points) have
been labelled slighly above the points (due to <code>vjust = -1</code>). We may
observe that some labels are overlapped. There is a fantastic package
<code>ggrepel</code> which works for <code>ggplot2</code> plots and places the overlapped
labels in a nicer way. See figure <a href="visualising-data-with-ggplot2.html#fig:rgg32">13.32</a>.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="visualising-data-with-ggplot2.html#cb796-1" tabindex="-1"></a><span class="co"># Load package</span></span>
<span id="cb796-2"><a href="visualising-data-with-ggplot2.html#cb796-2" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb796-3"><a href="visualising-data-with-ggplot2.html#cb796-3" tabindex="-1"></a><span class="co"># Set global options for max overlaps</span></span>
<span id="cb796-4"><a href="visualising-data-with-ggplot2.html#cb796-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggrepel.max.overlaps =</span> <span class="cn">Inf</span>)</span>
<span id="cb796-5"><a href="visualising-data-with-ggplot2.html#cb796-5" tabindex="-1"></a></span>
<span id="cb796-6"><a href="visualising-data-with-ggplot2.html#cb796-6" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb796-7"><a href="visualising-data-with-ggplot2.html#cb796-7" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb796-8"><a href="visualising-data-with-ggplot2.html#cb796-8" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(mtcars)),</span>
<span id="cb796-9"><a href="visualising-data-with-ggplot2.html#cb796-9" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb796-10"><a href="visualising-data-with-ggplot2.html#cb796-10" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;seagreen&quot;</span>,</span>
<span id="cb796-11"><a href="visualising-data-with-ggplot2.html#cb796-11" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb796-12"><a href="visualising-data-with-ggplot2.html#cb796-12" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">&quot;bold.italic&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg32"></span>
<img src="DauR_files/figure-html/rgg32-1.png" alt="Adding labels to geoms through external ggrepel package" width="672" />
<p class="caption">
Figure 13.32: Adding labels to geoms through external ggrepel package
</p>
</div>
<p>labelling bar charts generated through granular data using <code>geom_bar()</code>
may be sometimes tricky as we have to use <code>stat</code> functions used to
generate summary/aggregation. See Example in figure <a href="visualising-data-with-ggplot2.html#fig:rgg35">13.33</a></p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="visualising-data-with-ggplot2.html#cb797-1" tabindex="-1"></a><span class="co"># Labelling a bar plot</span></span>
<span id="cb797-2"><a href="visualising-data-with-ggplot2.html#cb797-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class)) <span class="sc">+</span></span>
<span id="cb797-3"><a href="visualising-data-with-ggplot2.html#cb797-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb797-4"><a href="visualising-data-with-ggplot2.html#cb797-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb797-5"><a href="visualising-data-with-ggplot2.html#cb797-5" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb797-6"><a href="visualising-data-with-ggplot2.html#cb797-6" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">+</span> <span class="dv">2</span>), <span class="co"># shift the label slightly</span></span>
<span id="cb797-7"><a href="visualising-data-with-ggplot2.html#cb797-7" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">after_stat</span>(count)</span>
<span id="cb797-8"><a href="visualising-data-with-ggplot2.html#cb797-8" tabindex="-1"></a>    ),</span>
<span id="cb797-9"><a href="visualising-data-with-ggplot2.html#cb797-9" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;count&quot;</span></span>
<span id="cb797-10"><a href="visualising-data-with-ggplot2.html#cb797-10" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg35"></span>
<img src="DauR_files/figure-html/rgg35-1.png" alt="Labelled bar chart" width="672" />
<p class="caption">
Figure 13.33: Labelled bar chart
</p>
</div>
<p>If we want to label chart in <a href="visualising-data-with-ggplot2.html#fig:rgg19">13.22</a>, we have to provide some
special values aesthetics to <code>geom_text</code> (or <code>geom_label</code>). See figure
<a href="visualising-data-with-ggplot2.html#fig:rgg33">13.34</a>.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="visualising-data-with-ggplot2.html#cb798-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, cty)) <span class="sc">+</span></span>
<span id="cb798-2"><a href="visualising-data-with-ggplot2.html#cb798-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary_bin&quot;</span>, <span class="at">fun =</span> mean) <span class="sc">+</span></span>
<span id="cb798-3"><a href="visualising-data-with-ggplot2.html#cb798-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb798-4"><a href="visualising-data-with-ggplot2.html#cb798-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(<span class="fu">round</span>(y, <span class="dv">2</span>))),</span>
<span id="cb798-5"><a href="visualising-data-with-ggplot2.html#cb798-5" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;summary_bin&quot;</span>,</span>
<span id="cb798-6"><a href="visualising-data-with-ggplot2.html#cb798-6" tabindex="-1"></a>    <span class="at">fun =</span> mean,</span>
<span id="cb798-7"><a href="visualising-data-with-ggplot2.html#cb798-7" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb798-8"><a href="visualising-data-with-ggplot2.html#cb798-8" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg33"></span>
<img src="DauR_files/figure-html/rgg33-1.png" alt="Bivariate bar chart labelled" width="672" />
<p class="caption">
Figure 13.34: Bivariate bar chart labelled
</p>
</div>
<p>One more example of labelling boxplots with maximum value for each
category may be -</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="visualising-data-with-ggplot2.html#cb799-1" tabindex="-1"></a><span class="co"># Labelling the upper hinge of a boxplot,</span></span>
<span id="cb799-2"><a href="visualising-data-with-ggplot2.html#cb799-2" tabindex="-1"></a><span class="co"># inspired by June Choe</span></span>
<span id="cb799-3"><a href="visualising-data-with-ggplot2.html#cb799-3" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, class)) <span class="sc">+</span></span>
<span id="cb799-4"><a href="visualising-data-with-ggplot2.html#cb799-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb799-5"><a href="visualising-data-with-ggplot2.html#cb799-5" tabindex="-1"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb799-6"><a href="visualising-data-with-ggplot2.html#cb799-6" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb799-7"><a href="visualising-data-with-ggplot2.html#cb799-7" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">after_stat</span>(xmax),</span>
<span id="cb799-8"><a href="visualising-data-with-ggplot2.html#cb799-8" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">stage</span>(displ, <span class="at">after_stat =</span> xmax)</span>
<span id="cb799-9"><a href="visualising-data-with-ggplot2.html#cb799-9" tabindex="-1"></a>    ),</span>
<span id="cb799-10"><a href="visualising-data-with-ggplot2.html#cb799-10" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;boxplot&quot;</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb799-11"><a href="visualising-data-with-ggplot2.html#cb799-11" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg34"></span>
<img src="DauR_files/figure-html/rgg34-1.png" alt="Upper Hinge labelled in Boxplot" width="672" />
<p class="caption">
Figure 13.35: Upper Hinge labelled in Boxplot
</p>
</div>
<p>Labeling color stacked bar charts can also get trickier, as we have to
provide appropriate position argument to <code>geom_text</code> layer also. See
example in figure <a href="visualising-data-with-ggplot2.html#fig:rgg36">13.36</a>.</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="visualising-data-with-ggplot2.html#cb800-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb800-2"><a href="visualising-data-with-ggplot2.html#cb800-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb800-3"><a href="visualising-data-with-ggplot2.html#cb800-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb800-4"><a href="visualising-data-with-ggplot2.html#cb800-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(count)),</span>
<span id="cb800-5"><a href="visualising-data-with-ggplot2.html#cb800-5" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb800-6"><a href="visualising-data-with-ggplot2.html#cb800-6" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb800-7"><a href="visualising-data-with-ggplot2.html#cb800-7" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg36"></span>
<img src="DauR_files/figure-html/rgg36-1.png" alt="Colored bar chart labelled" width="672" />
<p class="caption">
Figure 13.36: Colored bar chart labelled
</p>
</div>
<p>As we have discussed the difference between <code>geom_bar</code> and <code>geom_col</code> in
details, readers may find it pretty easier to draw the above chart
(Figure <a href="visualising-data-with-ggplot2.html#fig:rgg36">13.36</a>) using <code>geom_col</code> on pre-aggregated data. Refer
figure <a href="visualising-data-with-ggplot2.html#fig:rgg37">13.37</a> wherein we have to only handle the placements of
labels through <code>position_stack</code> argument.</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="visualising-data-with-ggplot2.html#cb801-1" tabindex="-1"></a>mpg_agg <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span> </span>
<span id="cb801-2"><a href="visualising-data-with-ggplot2.html#cb801-2" tabindex="-1"></a>  <span class="fu">count</span>(class, fl)</span>
<span id="cb801-3"><a href="visualising-data-with-ggplot2.html#cb801-3" tabindex="-1"></a></span>
<span id="cb801-4"><a href="visualising-data-with-ggplot2.html#cb801-4" tabindex="-1"></a><span class="fu">ggplot</span>(mpg_agg, <span class="fu">aes</span>(</span>
<span id="cb801-5"><a href="visualising-data-with-ggplot2.html#cb801-5" tabindex="-1"></a>  <span class="at">x =</span> class,</span>
<span id="cb801-6"><a href="visualising-data-with-ggplot2.html#cb801-6" tabindex="-1"></a>  <span class="at">y =</span> n,</span>
<span id="cb801-7"><a href="visualising-data-with-ggplot2.html#cb801-7" tabindex="-1"></a>  <span class="at">fill =</span> fl,</span>
<span id="cb801-8"><a href="visualising-data-with-ggplot2.html#cb801-8" tabindex="-1"></a>  <span class="at">label =</span> n <span class="co"># provided globally</span></span>
<span id="cb801-9"><a href="visualising-data-with-ggplot2.html#cb801-9" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb801-10"><a href="visualising-data-with-ggplot2.html#cb801-10" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb801-11"><a href="visualising-data-with-ggplot2.html#cb801-11" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb801-12"><a href="visualising-data-with-ggplot2.html#cb801-12" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>) <span class="co">#labels centered vertically</span></span>
<span id="cb801-13"><a href="visualising-data-with-ggplot2.html#cb801-13" tabindex="-1"></a>    )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg37"></span>
<img src="DauR_files/figure-html/rgg37-1.png" alt="Colored bar chart labelled" width="672" />
<p class="caption">
Figure 13.37: Colored bar chart labelled
</p>
</div>
</div>
<div id="histograms-and-related-plots" class="section level3" number="13.4.6">
<h3><span class="header-section-number">13.4.6</span> Histograms and related plots</h3>
<p>Readers by now, mayhave understood why ggplot2 is such a vast topic that
often it requires separate book. Full coverage in a single chapter is
nearly impossible. However, there are several other geoms which are not
as trickier as <code>geom_bar</code> and simultaneously useful while analysing the
data. One of those is <code>geom_histogram</code> which plots histogram for a
univariate numerical (continuous variable) data.</p>
<p>Like <code>geom_bar</code> it also aggregates the data itself using default
statistic <code>stat = "bin"</code>. For a change let us now use <code>diamonds</code>
data-set, which is also loaded by default with ggplot2 package. It
contains over 50,000 observations for round-cut diamonds. As an example
let us visualise the distribution of <code>carat</code> variable.</p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="visualising-data-with-ggplot2.html#cb802-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat)) <span class="sc">+</span></span>
<span id="cb802-2"><a href="visualising-data-with-ggplot2.html#cb802-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg38"></span>
<img src="DauR_files/figure-html/rgg38-1.png" alt="A simple histogram" width="672" />
<p class="caption">
Figure 13.38: A simple histogram
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg38">13.38</a> a histogram has been generated with a warning
to pick better value for bin-width. So let us modify the bin-width to
say, 0.025.</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="visualising-data-with-ggplot2.html#cb804-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat)) <span class="sc">+</span></span>
<span id="cb804-2"><a href="visualising-data-with-ggplot2.html#cb804-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.025</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg21"></span>
<img src="DauR_files/figure-html/rgg21-1.png" alt="Histogram with custom binwidth" width="672" />
<p class="caption">
Figure 13.39: Histogram with custom binwidth
</p>
</div>
<p>We may use <code>bins</code> aesthetic to choose the number of bins in histogram.
Other aestheics like <code>fill</code> or <code>color</code> may also be used.</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="visualising-data-with-ggplot2.html#cb805-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(price, <span class="at">fill =</span> cut)) <span class="sc">+</span></span>
<span id="cb805-2"><a href="visualising-data-with-ggplot2.html#cb805-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">500</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg39"></span>
<img src="DauR_files/figure-html/rgg39-1.png" alt="Filled Histogram" width="672" />
<p class="caption">
Figure 13.40: Filled Histogram
</p>
</div>
<p>Related geom is <code>geom_freqpoly</code> (short for frequency polygon) which
display the counts with lines. So histogram in figure <a href="visualising-data-with-ggplot2.html#fig:rgg39">13.40</a>
may be drawn as frequency polygon usingthis geom layer. Refer figure
<a href="visualising-data-with-ggplot2.html#fig:rgg40">13.41</a>.</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="visualising-data-with-ggplot2.html#cb806-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(price, <span class="at">color =</span> cut)) <span class="sc">+</span></span>
<span id="cb806-2"><a href="visualising-data-with-ggplot2.html#cb806-2" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">500</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg40"></span>
<img src="DauR_files/figure-html/rgg40-1.png" alt="Filled frequency polygon" width="672" />
<p class="caption">
Figure 13.41: Filled frequency polygon
</p>
</div>
<p>To make it easier to compare distributions with very different counts,
we may put <code>density</code> on the <code>y</code> axis instead of the default count. Refer
figure <a href="visualising-data-with-ggplot2.html#fig:rgg41">13.42</a>.</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="visualising-data-with-ggplot2.html#cb807-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(price, <span class="fu">after_stat</span>(density), <span class="at">colour =</span> cut)) <span class="sc">+</span></span>
<span id="cb807-2"><a href="visualising-data-with-ggplot2.html#cb807-2" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">500</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg41"></span>
<img src="DauR_files/figure-html/rgg41-1.png" alt="Filled frequency polygon with density" width="672" />
<p class="caption">
Figure 13.42: Filled frequency polygon with density
</p>
</div>
</div>
<div id="line-charts" class="section level3" number="13.4.7">
<h3><span class="header-section-number">13.4.7</span> Line Charts</h3>
<p>Since almost all geoms in ggplot2 have been named intuitively, we can
have a correct guess that line charts canbe drawn using <code>geom_line()</code>.
However, unlike geoms we have seen till now, <code>geom_line()</code> is a special
geom and works correctly in groups. It is thus sometimes referred to as
grouped or collective geom.</p>
<p>To understand the concept of group, let us construct a simple data,
having an index variable (for x axis), another numerical variable
<code>values</code> and also having a categorical variable say <code>gr</code>. Let us plot
<code>values</code> vs. <code>index</code> on a line plot.</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="visualising-data-with-ggplot2.html#cb808-1" tabindex="-1"></a><span class="co"># Constructing example data</span></span>
<span id="cb808-2"><a href="visualising-data-with-ggplot2.html#cb808-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb808-3"><a href="visualising-data-with-ggplot2.html#cb808-3" tabindex="-1"></a>exdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb808-4"><a href="visualising-data-with-ggplot2.html#cb808-4" tabindex="-1"></a>  <span class="at">gr =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;G1&quot;</span>, <span class="st">&quot;G2&quot;</span>), <span class="dv">5</span>),</span>
<span id="cb808-5"><a href="visualising-data-with-ggplot2.html#cb808-5" tabindex="-1"></a>  <span class="at">index =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb808-6"><a href="visualising-data-with-ggplot2.html#cb808-6" tabindex="-1"></a>  <span class="at">values =</span> <span class="fu">sample</span>(<span class="dv">100</span><span class="sc">:</span><span class="dv">200</span>, <span class="dv">10</span>)</span>
<span id="cb808-7"><a href="visualising-data-with-ggplot2.html#cb808-7" tabindex="-1"></a>)</span>
<span id="cb808-8"><a href="visualising-data-with-ggplot2.html#cb808-8" tabindex="-1"></a><span class="co"># print the data</span></span>
<span id="cb808-9"><a href="visualising-data-with-ggplot2.html#cb808-9" tabindex="-1"></a>exdata</span></code></pre></div>
<pre><code>##    gr index values
## 1  G1     1    108
## 2  G2     1    173
## 3  G1     2    175
## 4  G2     2    154
## 5  G1     3    171
## 6  G2     3    153
## 7  G1     4    138
## 8  G2     4    182
## 9  G1     5    187
## 10 G2     5    114</code></pre>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="visualising-data-with-ggplot2.html#cb810-1" tabindex="-1"></a><span class="co"># Line chart</span></span>
<span id="cb810-2"><a href="visualising-data-with-ggplot2.html#cb810-2" tabindex="-1"></a><span class="fu">ggplot</span>(exdata, <span class="fu">aes</span>(index, values)) <span class="sc">+</span></span>
<span id="cb810-3"><a href="visualising-data-with-ggplot2.html#cb810-3" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg42"></span>
<img src="DauR_files/figure-html/rgg42-1.png" alt="A simple line chart" width="672" />
<p class="caption">
Figure 13.43: A simple line chart
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg42">13.43</a>, we can see that values have been plotted but
for each index these have been joined first then moving onto another
index. This inadvertant thing can be fixed by use of aesthetic <code>group</code>.
The group aesthetic determines which observations are connected. See
figure <a href="visualising-data-with-ggplot2.html#fig:rgg43">13.44</a>.</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="visualising-data-with-ggplot2.html#cb811-1" tabindex="-1"></a><span class="fu">ggplot</span>(exdata, <span class="fu">aes</span>(index, values, <span class="at">group =</span> gr)) <span class="sc">+</span></span>
<span id="cb811-2"><a href="visualising-data-with-ggplot2.html#cb811-2" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg43"></span>
<img src="DauR_files/figure-html/rgg43-1.png" alt="A line chart without legend" width="672" />
<p class="caption">
Figure 13.44: A line chart without legend
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg43">13.44</a>, we got two different lines for each as
intended, but corresponding legend to identify the group is not there.
So, if we map <code>color</code> aesthetic with our group variable we can get the
legend. Moreover, mapping this aesthetic may have over-riding effect (in
this case) on <code>group</code> aesthetic, so this aesthetic will be kind of
redundant. Refer plot in figure <a href="visualising-data-with-ggplot2.html#fig:rgg44">13.45</a>.</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="visualising-data-with-ggplot2.html#cb812-1" tabindex="-1"></a><span class="fu">ggplot</span>(exdata, <span class="fu">aes</span>(index, values, <span class="at">color =</span> gr)) <span class="sc">+</span></span>
<span id="cb812-2"><a href="visualising-data-with-ggplot2.html#cb812-2" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg44"></span>
<img src="DauR_files/figure-html/rgg44-1.png" alt="A line chart with legend" width="672" />
<p class="caption">
Figure 13.45: A line chart with legend
</p>
</div>
<p>If a group isn’t defined by a single variable, but instead by a
combination of multiple variables, we may use <code>interaction()</code> to combine
them.</p>
<p>Now we will use two data-sets (i) <code>economics</code> and <code>economics_long</code>; both
of which are part of <code>tidyr</code> package. Readers using <code>ggplot2</code> library
only are thus, advised to load the package <code>tidyr</code> (or alternatively
<code>tidyverse</code> which contains both of these packages). These data-sets
contains some economic parameters, on a monthly basis from US.</p>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg46">13.47</a>, separate lines for each variable and for
each of the months across the years have been plotted.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="visualising-data-with-ggplot2.html#cb813-1" tabindex="-1"></a>economics_long <span class="sc">|&gt;</span> </span>
<span id="cb813-2"><a href="visualising-data-with-ggplot2.html#cb813-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb813-3"><a href="visualising-data-with-ggplot2.html#cb813-3" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb813-4"><a href="visualising-data-with-ggplot2.html#cb813-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, value01, <span class="at">group =</span> <span class="fu">interaction</span>(month, variable))) <span class="sc">+</span></span>
<span id="cb813-5"><a href="visualising-data-with-ggplot2.html#cb813-5" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg45"></span>
<img src="DauR_files/figure-html/rgg45-1.png" alt="Groups in multiple variables" width="672" />
<p class="caption">
Figure 13.46: Groups in multiple variables
</p>
</div>
<p>There is another related geom i.e. <code>geom_path()</code> which also draws a line
chart. While <code>geom_line()</code> connects points from left to right;
<code>geom_path()</code> connects points in the order they appear in the data. In
figure <a href="visualising-data-with-ggplot2.html#fig:rgg46">13.47</a> the <code>exdata</code> we created earlier has been
re-arranged to show the difference. Both <code>geom_line()</code> and <code>geom_path()</code>
also understand the aesthetic <code>linetype</code>, which maps a categorical
variable to <code>'solid'</code> (default), <code>'dotted'</code> , <code>'dashed'</code> and <code>'dotdash'</code>
lines.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="visualising-data-with-ggplot2.html#cb814-1" tabindex="-1"></a>exdata <span class="sc">|&gt;</span></span>
<span id="cb814-2"><a href="visualising-data-with-ggplot2.html#cb814-2" tabindex="-1"></a>  <span class="co"># Rearranging the data points</span></span>
<span id="cb814-3"><a href="visualising-data-with-ggplot2.html#cb814-3" tabindex="-1"></a>  <span class="fu">arrange</span>(values) <span class="sc">|&gt;</span></span>
<span id="cb814-4"><a href="visualising-data-with-ggplot2.html#cb814-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(index, values)) <span class="sc">+</span></span>
<span id="cb814-5"><a href="visualising-data-with-ggplot2.html#cb814-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dotdash&quot;</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb814-6"><a href="visualising-data-with-ggplot2.html#cb814-6" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Using line geom&quot;</span>)</span>
<span id="cb814-7"><a href="visualising-data-with-ggplot2.html#cb814-7" tabindex="-1"></a></span>
<span id="cb814-8"><a href="visualising-data-with-ggplot2.html#cb814-8" tabindex="-1"></a>exdata <span class="sc">|&gt;</span></span>
<span id="cb814-9"><a href="visualising-data-with-ggplot2.html#cb814-9" tabindex="-1"></a>  <span class="co"># Rearranging the data points</span></span>
<span id="cb814-10"><a href="visualising-data-with-ggplot2.html#cb814-10" tabindex="-1"></a>  <span class="fu">arrange</span>(values) <span class="sc">|&gt;</span></span>
<span id="cb814-11"><a href="visualising-data-with-ggplot2.html#cb814-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(index, values)) <span class="sc">+</span></span>
<span id="cb814-12"><a href="visualising-data-with-ggplot2.html#cb814-12" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb814-13"><a href="visualising-data-with-ggplot2.html#cb814-13" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Using path geom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg46"></span>
<img src="DauR_files/figure-html/rgg46-1.png" alt="Path vs Line geoms" width="49%" /><img src="DauR_files/figure-html/rgg46-2.png" alt="Path vs Line geoms" width="49%" />
<p class="caption">
Figure 13.47: Path vs Line geoms
</p>
</div>
</div>
<div id="smoothing-through-geom_smooth" class="section level3" number="13.4.8">
<h3><span class="header-section-number">13.4.8</span> Smoothing through <code>geom_smooth</code></h3>
<p>Essentially, <code>geom_smooth()</code> adds a trend line over an existing plot, be
it a scatter plot or line plot. For e.g. if we draw the trend of
unemployment in US, we can use <code>geom_smooth</code> to see smoothed trend over
the period. Refer plot in figure <a href="visualising-data-with-ggplot2.html#fig:rgg48">13.48</a>.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="visualising-data-with-ggplot2.html#cb815-1" tabindex="-1"></a><span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date, unemploy)) <span class="sc">+</span></span>
<span id="cb815-2"><a href="visualising-data-with-ggplot2.html#cb815-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;indianred4&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb815-3"><a href="visualising-data-with-ggplot2.html#cb815-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg48"></span>
<img src="DauR_files/figure-html/rgg48-1.png" alt="Line Chart with smoothed trend" width="672" />
<p class="caption">
Figure 13.48: Line Chart with smoothed trend
</p>
</div>
<p>A warning shows that <code>method</code> argument used to smooth the curve is
<code>loess</code>. The other methods available are <code>lm</code>, <code>glm</code> , <code>gam</code> etc. These
require <code>formula</code> to be provided. We may also smooth a scatter plot
using this function, to see a regression (linear) line. Refer plot in
figure <a href="visualising-data-with-ggplot2.html#fig:rgg49">13.49</a>.</p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="visualising-data-with-ggplot2.html#cb817-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span></span>
<span id="cb817-2"><a href="visualising-data-with-ggplot2.html#cb817-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb817-3"><a href="visualising-data-with-ggplot2.html#cb817-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg49"></span>
<img src="DauR_files/figure-html/rgg49-1.png" alt="Scatter plot with regression line" width="672" />
<p class="caption">
Figure 13.49: Scatter plot with regression line
</p>
</div>
<p>Readers may note, in figure <a href="visualising-data-with-ggplot2.html#fig:rgg49">13.49</a> that there much lesser
points seen in this plot than actually available due to overlapping of
points. This overlapping issue can either be solved using <code>alpha</code>
aesthetic or by using <code>jitter</code> method in scatter plots. <code>geom_jitter</code>
adds a random noise to the data, so that the overlapping points are seen
clearly. Jittered scatterplot may be seen in <a href="visualising-data-with-ggplot2.html#fig:rgg47">13.50</a>.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="visualising-data-with-ggplot2.html#cb818-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span></span>
<span id="cb818-2"><a href="visualising-data-with-ggplot2.html#cb818-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb818-3"><a href="visualising-data-with-ggplot2.html#cb818-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg47"></span>
<img src="DauR_files/figure-html/rgg47-1.png" alt="Scatter plot with regression line" width="672" />
<p class="caption">
Figure 13.50: Scatter plot with regression line
</p>
</div>
</div>
<div id="combining-multiple-geoms" class="section level3" number="13.4.9">
<h3><span class="header-section-number">13.4.9</span> Combining multiple geoms</h3>
<p>We have already used multiple geoms in the same plot while labeling them
as well as while smoothing the trend. Multiple geoms can be used in same
plot, which will add further layers over the existing layers produced by
earlier geoms. As an example let us add data points in figure
<a href="visualising-data-with-ggplot2.html#fig:rgg42">13.43</a>.</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="visualising-data-with-ggplot2.html#cb819-1" tabindex="-1"></a><span class="fu">ggplot</span>(exdata, <span class="fu">aes</span>(index, values)) <span class="sc">+</span></span>
<span id="cb819-2"><a href="visualising-data-with-ggplot2.html#cb819-2" tabindex="-1"></a>  <span class="co"># layer with line</span></span>
<span id="cb819-3"><a href="visualising-data-with-ggplot2.html#cb819-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;dodgerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb819-4"><a href="visualising-data-with-ggplot2.html#cb819-4" tabindex="-1"></a>  <span class="co"># layer with points</span></span>
<span id="cb819-5"><a href="visualising-data-with-ggplot2.html#cb819-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">fill =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">stroke =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg50"></span>
<img src="DauR_files/figure-html/rgg50-1.png" alt="Combining Geoms" width="672" />
<p class="caption">
Figure 13.51: Combining Geoms
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:rgg50">13.51</a> we can see that points have been added over
the line. If we reverse the order, we can see in figure #ref(fig:rgg51)
that line (latter layer) is drawn over points (former layer).</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="visualising-data-with-ggplot2.html#cb820-1" tabindex="-1"></a><span class="fu">ggplot</span>(exdata, <span class="fu">aes</span>(index, values))  <span class="sc">+</span></span>
<span id="cb820-2"><a href="visualising-data-with-ggplot2.html#cb820-2" tabindex="-1"></a>  <span class="co"># layer with points</span></span>
<span id="cb820-3"><a href="visualising-data-with-ggplot2.html#cb820-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">fill =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb820-4"><a href="visualising-data-with-ggplot2.html#cb820-4" tabindex="-1"></a>  <span class="co"># layer with line</span></span>
<span id="cb820-5"><a href="visualising-data-with-ggplot2.html#cb820-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;dodgerblue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg51"></span>
<img src="DauR_files/figure-html/rgg51-1.png" alt="Understanding overlapping in geoms" width="672" />
<p class="caption">
Figure 13.52: Understanding overlapping in geoms
</p>
</div>
</div>
<div id="other-geoms" class="section level3" number="13.4.10">
<h3><span class="header-section-number">13.4.10</span> Other geoms</h3>
<p>Several other geoms which are useful to depict meaningful information in
afore-mentioned charts are-</p>
<ul>
<li><code>geom_vline()</code>, <code>geom_hline</code> or <code>geom_abline()</code> to add vertical,
horizontal or other reference lines in the plot.</li>
<li><code>geom_rect()</code> to draw a constant/reference rectangle in the data
using four corners of the rectangle, <code>xmin</code>, <code>ymin</code>, <code>xmax</code> and
<code>ymax</code>.</li>
<li><code>geom_area()</code> which draws an area plot, which is a line plot filled
to the y-axis (filled lines). Multiple groups will be stacked on top
of each other.</li>
</ul>
<p>Example</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="visualising-data-with-ggplot2.html#cb821-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb821-2"><a href="visualising-data-with-ggplot2.html#cb821-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb821-3"><a href="visualising-data-with-ggplot2.html#cb821-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">37</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;dodgerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb821-4"><a href="visualising-data-with-ggplot2.html#cb821-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">3.5</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg52"></span>
<img src="DauR_files/figure-html/rgg52-1.png" alt="Adding reference lines" width="672" />
<p class="caption">
Figure 13.53: Adding reference lines
</p>
</div>
</div>
<div id="list-of-geoms-available-in-ggplot2" class="section level3" number="13.4.11">
<h3><span class="header-section-number">13.4.11</span> List of geoms available in <code>ggplot2</code></h3>
<p>Apart from the geoms discussed, there are many more geoms available in
ggplot2. Some of those have been discussed in subsequent
chapters/sections, as per the use case. However, readers may explore
themselves those geoms if they want to explore un<em>chart</em>ered
territories.</p>
<p>For reference, the geoms available in the ggplot2 version used to
compile the book, are listed in table <a href="visualising-data-with-ggplot2.html#tab:geoms">13.1</a> for reference.</p>
<table>
<caption><span id="tab:geoms">Table 13.1: </span>List of Geoms available in ggplot2</caption>
<colgroup>
<col width="26%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Entry</th>
<th align="left">Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">geom_abline</td>
<td align="left">Reference lines: horizontal, vertical, and diagonal</td>
</tr>
<tr class="even">
<td align="left">geom_hline</td>
<td align="left">Reference lines: horizontal, vertical, and diagonal</td>
</tr>
<tr class="odd">
<td align="left">geom_vline</td>
<td align="left">Reference lines: horizontal, vertical, and diagonal</td>
</tr>
<tr class="even">
<td align="left">geom_bar</td>
<td align="left">Bar charts</td>
</tr>
<tr class="odd">
<td align="left">geom_col</td>
<td align="left">Bar charts</td>
</tr>
<tr class="even">
<td align="left">geom_bin_2d</td>
<td align="left">Heatmap of 2d bin counts</td>
</tr>
<tr class="odd">
<td align="left">geom_bin2d</td>
<td align="left">Heatmap of 2d bin counts</td>
</tr>
<tr class="even">
<td align="left">geom_blank</td>
<td align="left">Draw nothing</td>
</tr>
<tr class="odd">
<td align="left">geom_boxplot</td>
<td align="left">A box and whiskers plot (in the style of Tukey)</td>
</tr>
<tr class="even">
<td align="left">geom_contour</td>
<td align="left">2D contours of a 3D surface</td>
</tr>
<tr class="odd">
<td align="left">geom_contour_filled</td>
<td align="left">2D contours of a 3D surface</td>
</tr>
<tr class="even">
<td align="left">geom_count</td>
<td align="left">Count overlapping points</td>
</tr>
<tr class="odd">
<td align="left">geom_density</td>
<td align="left">Smoothed density estimates</td>
</tr>
<tr class="even">
<td align="left">geom_density_2d</td>
<td align="left">Contours of a 2D density estimate</td>
</tr>
<tr class="odd">
<td align="left">geom_density2d</td>
<td align="left">Contours of a 2D density estimate</td>
</tr>
<tr class="even">
<td align="left">geom_density_2d_filled</td>
<td align="left">Contours of a 2D density estimate</td>
</tr>
<tr class="odd">
<td align="left">geom_density2d_filled</td>
<td align="left">Contours of a 2D density estimate</td>
</tr>
<tr class="even">
<td align="left">geom_dotplot</td>
<td align="left">Dot plot</td>
</tr>
<tr class="odd">
<td align="left">geom_errorbarh</td>
<td align="left">Horizontal error bars</td>
</tr>
<tr class="even">
<td align="left">geom_function</td>
<td align="left">Draw a function as a continuous curve</td>
</tr>
<tr class="odd">
<td align="left">geom_hex</td>
<td align="left">Hexagonal heatmap of 2d bin counts</td>
</tr>
<tr class="even">
<td align="left">geom_freqpoly</td>
<td align="left">Histograms and frequency polygons</td>
</tr>
<tr class="odd">
<td align="left">geom_histogram</td>
<td align="left">Histograms and frequency polygons</td>
</tr>
<tr class="even">
<td align="left">geom_jitter</td>
<td align="left">Jittered points</td>
</tr>
<tr class="odd">
<td align="left">geom_crossbar</td>
<td align="left">Vertical intervals: lines, crossbars &amp; errorbars</td>
</tr>
<tr class="even">
<td align="left">geom_errorbar</td>
<td align="left">Vertical intervals: lines, crossbars &amp; errorbars</td>
</tr>
<tr class="odd">
<td align="left">geom_linerange</td>
<td align="left">Vertical intervals: lines, crossbars &amp; errorbars</td>
</tr>
<tr class="even">
<td align="left">geom_pointrange</td>
<td align="left">Vertical intervals: lines, crossbars &amp; errorbars</td>
</tr>
<tr class="odd">
<td align="left">geom_map</td>
<td align="left">Polygons from a reference map</td>
</tr>
<tr class="even">
<td align="left">geom_path</td>
<td align="left">Connect observations</td>
</tr>
<tr class="odd">
<td align="left">geom_line</td>
<td align="left">Connect observations</td>
</tr>
<tr class="even">
<td align="left">geom_step</td>
<td align="left">Connect observations</td>
</tr>
<tr class="odd">
<td align="left">geom_point</td>
<td align="left">Points</td>
</tr>
<tr class="even">
<td align="left">geom_polygon</td>
<td align="left">Polygons</td>
</tr>
<tr class="odd">
<td align="left">geom_qq_line</td>
<td align="left">A quantile-quantile plot</td>
</tr>
<tr class="even">
<td align="left">geom_qq</td>
<td align="left">A quantile-quantile plot</td>
</tr>
<tr class="odd">
<td align="left">geom_quantile</td>
<td align="left">Quantile regression</td>
</tr>
<tr class="even">
<td align="left">geom_ribbon</td>
<td align="left">Ribbons and area plots</td>
</tr>
<tr class="odd">
<td align="left">geom_area</td>
<td align="left">Ribbons and area plots</td>
</tr>
<tr class="even">
<td align="left">geom_rug</td>
<td align="left">Rug plots in the margins</td>
</tr>
<tr class="odd">
<td align="left">geom_segment</td>
<td align="left">Line segments and curves</td>
</tr>
<tr class="even">
<td align="left">geom_curve</td>
<td align="left">Line segments and curves</td>
</tr>
<tr class="odd">
<td align="left">geom_smooth</td>
<td align="left">Smoothed conditional means</td>
</tr>
<tr class="even">
<td align="left">geom_spoke</td>
<td align="left">Line segments parameterised by location, direction and distance</td>
</tr>
<tr class="odd">
<td align="left">geom_label</td>
<td align="left">Text</td>
</tr>
<tr class="even">
<td align="left">geom_text</td>
<td align="left">Text</td>
</tr>
<tr class="odd">
<td align="left">geom_raster</td>
<td align="left">Rectangles</td>
</tr>
<tr class="even">
<td align="left">geom_rect</td>
<td align="left">Rectangles</td>
</tr>
<tr class="odd">
<td align="left">geom_tile</td>
<td align="left">Rectangles</td>
</tr>
<tr class="even">
<td align="left">geom_violin</td>
<td align="left">Violin plot</td>
</tr>
<tr class="odd">
<td align="left">geom_sf</td>
<td align="left">Visualise sf objects</td>
</tr>
<tr class="even">
<td align="left">geom_sf_label</td>
<td align="left">Visualise sf objects</td>
</tr>
<tr class="odd">
<td align="left">geom_sf_text</td>
<td align="left">Visualise sf objects</td>
</tr>
<tr class="even">
<td align="left">update_geom_defaults</td>
<td align="left">Modify geom/stat aesthetic defaults for future plots</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="modifying-scales" class="section level2" number="13.5">
<h2><span class="header-section-number">13.5</span> Modifying scales</h2>
<p>Scales in ggplot2 control the mapping from data to aesthetics so that
the data can be seen. In other words, these provide us a way to
customise aesthetics such as size, color, position, shape, etc.</p>
<p>In the charts we have generated so far, the aesthetic mappings with data
were default and we haven’t customised those default scales. We may
divide our customisation requirements of these scales into three broad
categories, which we will learn in this section.</p>
<ul>
<li>Modifying scales related to position aesthetics,</li>
<li>Modifying scale related to color (or fill) aesthetics,</li>
<li>Scales mapped to other aesthetics.</li>
</ul>
<div id="modifying-scales-mapped-to-position-aesthetics-i.e.-transforming-axes" class="section level3" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> Modifying scales mapped to position aesthetics i.e. transforming axes</h3>
<p>We have seen that default coordinate system used by ggplot2 is Cartesian
and to plot the data two position aesthetics <code>x</code> and <code>y</code> are required.
While drawing figure <a href="visualising-data-with-ggplot2.html#fig:rgg2">13.3</a> we provided these aesthetics
explicitly, whereas at the time of drawing bar chart in <a href="visualising-data-with-ggplot2.html#fig:rgg17">13.20</a>
we provided one <code>x</code> aesthetic and ggplot2 generated <code>y</code> aesthetic by
itself (remember <code>after_stat(count)</code>).</p>
<p>To customise position scales we have <code>scale_*_#()</code> group of functions,
where <code>*</code> represent position aesthetic usually <code>x</code> or <code>y</code>; and <code>#</code>
represents variable type. For example we have these two functions for
continuous axis/variables.</p>
<pre><code>scale_x_continuous(name, breaks, labels, limits, trans)
scale_y_continuous(name, breaks, labels, limits, trans)</code></pre>
<p>In arguments to above functions, we can see that axis title (name), axis
breaks, axis labels, axis limits, and transformations can be dealt with.
See the following examples wherein we have changed the limits of axes,
renamed them using <code>scale</code> functions (Refer <a href="visualising-data-with-ggplot2.html#fig:scale1">13.54</a>).</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="visualising-data-with-ggplot2.html#cb823-1" tabindex="-1"></a><span class="co"># Basic Scatter Plot</span></span>
<span id="cb823-2"><a href="visualising-data-with-ggplot2.html#cb823-2" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x =</span> speed, <span class="at">y =</span> dist)) <span class="sc">+</span> </span>
<span id="cb823-3"><a href="visualising-data-with-ggplot2.html#cb823-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb823-4"><a href="visualising-data-with-ggplot2.html#cb823-4" tabindex="-1"></a><span class="co"># Modifying scales both axis title and axis limits</span></span>
<span id="cb823-5"><a href="visualising-data-with-ggplot2.html#cb823-5" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x =</span> speed, <span class="at">y =</span> dist)) <span class="sc">+</span> </span>
<span id="cb823-6"><a href="visualising-data-with-ggplot2.html#cb823-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb823-7"><a href="visualising-data-with-ggplot2.html#cb823-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;Speed of cars&quot;</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb823-8"><a href="visualising-data-with-ggplot2.html#cb823-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;Stopping distance&quot;</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scale1"></span>
<img src="DauR_files/figure-html/scale1-1.png" alt="Modifying Scales in GGplot2" width="49%" /><img src="DauR_files/figure-html/scale1-2.png" alt="Modifying Scales in GGplot2" width="49%" />
<p class="caption">
Figure 13.54: Modifying Scales in GGplot2
</p>
</div>
<p>We can also applying transformation on axes using <code>trans</code> argument
(refer figure <a href="visualising-data-with-ggplot2.html#fig:scale2">13.55</a>).</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="visualising-data-with-ggplot2.html#cb824-1" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x =</span> speed, <span class="at">y =</span> dist)) <span class="sc">+</span> </span>
<span id="cb824-2"><a href="visualising-data-with-ggplot2.html#cb824-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb824-3"><a href="visualising-data-with-ggplot2.html#cb824-3" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb824-4"><a href="visualising-data-with-ggplot2.html#cb824-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scale2"></span>
<img src="DauR_files/figure-html/scale2-1.png" alt="Transforming Axes in GGplot2" width="672" />
<p class="caption">
Figure 13.55: Transforming Axes in GGplot2
</p>
</div>
<p>The transformation is actually carried out by a <code>"transformer"</code>, which describes the transformation, its inverse, and how to draw the labels. A Few of these transformations are listed in table <a href="visualising-data-with-ggplot2.html#tab:modscales">13.2</a> following.</p>
<table>
<caption><span id="tab:modscales">Table 13.2: </span> Some transformations</caption>
<thead>
<tr class="header">
<th>Name</th>
<th>Equivalent function <span class="math inline">\(f(x)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>"asn"</code></td>
<td><span class="math inline">\(\tanh^{-1}(x)\)</span></td>
</tr>
<tr class="even">
<td><code>"exp"</code></td>
<td><span class="math inline">\(e ^ x\)</span></td>
</tr>
<tr class="odd">
<td><code>"identity"</code></td>
<td><span class="math inline">\(x\)</span></td>
</tr>
<tr class="even">
<td><code>"log"</code></td>
<td><span class="math inline">\(\log(x)\)</span></td>
</tr>
<tr class="odd">
<td><code>"log10"</code></td>
<td><span class="math inline">\(\log_{10}(x)\)</span></td>
</tr>
<tr class="even">
<td><code>"log2"</code></td>
<td><span class="math inline">\(\log_2(x)\)</span></td>
</tr>
<tr class="odd">
<td><code>"logit"</code></td>
<td><span class="math inline">\(\log(\frac{x}{1 - x})\)</span></td>
</tr>
<tr class="even">
<td><code>"probit"</code></td>
<td><span class="math inline">\(\Phi(x)\)</span></td>
</tr>
<tr class="odd">
<td><code>"reciprocal"</code></td>
<td><span class="math inline">\(x^{-1}\)</span></td>
</tr>
<tr class="even">
<td><code>"reverse"</code></td>
<td><span class="math inline">\(-x\)</span></td>
</tr>
<tr class="odd">
<td><code>"sqrt"</code></td>
<td><span class="math inline">\(x^{1/2}\)</span></td>
</tr>
</tbody>
</table>
<p>However, there are certain scale functions dedicated to transform axes in ggplot2. Some of these are listed below. Obviously all these functions have corresponding <code>y</code> variants available.</p>
<ul>
<li><code>scale_x_log10()</code></li>
<li><code>scale_x_reverse()</code></li>
<li><code>scale_x_sqrt()</code></li>
</ul>
<p>Of these, <code>scale_x_reverse</code> or its <code>y</code> variant are sometimes really useful.</p>
<p>In the above examples, though we have seen scale functions dealing with <code>numerical</code> data, we have plenty of other functions to deal with other data. Such as,</p>
<ul>
<li><code>scale_x_date</code></li>
<li><code>scale_x_datetime()</code></li>
<li><code>scale_x_discrete()</code></li>
<li><code>scale_x_binned()</code></li>
</ul>
<p>One example of using date scale can be of economics data. (refer figure <a href="visualising-data-with-ggplot2.html#fig:scale4">13.56</a>).</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="visualising-data-with-ggplot2.html#cb825-1" tabindex="-1"></a><span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date, psavert)) <span class="sc">+</span></span>
<span id="cb825-2"><a href="visualising-data-with-ggplot2.html#cb825-2" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb825-3"><a href="visualising-data-with-ggplot2.html#cb825-3" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">name =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb825-4"><a href="visualising-data-with-ggplot2.html#cb825-4" tabindex="-1"></a>               <span class="at">date_breaks =</span> <span class="st">&quot;2 years&quot;</span>,</span>
<span id="cb825-5"><a href="visualising-data-with-ggplot2.html#cb825-5" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">&quot;%y&quot;</span>,</span>
<span id="cb825-6"><a href="visualising-data-with-ggplot2.html#cb825-6" tabindex="-1"></a>               <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">&quot;19800101&quot;</span>), <span class="fu">ymd</span>(<span class="st">&quot;19991231&quot;</span>))) <span class="sc">+</span></span>
<span id="cb825-7"><a href="visualising-data-with-ggplot2.html#cb825-7" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Personal Savings Rate&quot;</span>,</span>
<span id="cb825-8"><a href="visualising-data-with-ggplot2.html#cb825-8" tabindex="-1"></a>                     <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scale4"></span>
<img src="DauR_files/figure-html/scale4-1.png" alt="Transforming Axes in GGplot2" width="672" />
<p class="caption">
Figure 13.56: Transforming Axes in GGplot2
</p>
</div>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:scale4">13.56</a>, we have modified (i) name of <code>x</code> axis, (ii) breaks, which places the label, (iii) label for 2 digits of year, (iv) limited the data to be plotted using <code>limits</code>, (v) name of <code>y</code> axis and (vi) modified the bales of <code>y</code> axis as percentages; all using scale functions.</p>
<p>Readers may have noticed that we have modified the axes lables in plot in figure <a href="visualising-data-with-ggplot2.html#fig:scale4">13.56</a> using <code>scales</code> package. Using <code>scales</code> library we may modify format of labels (refer plot in figure <a href="visualising-data-with-ggplot2.html#fig:scale3">13.57</a>).</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="visualising-data-with-ggplot2.html#cb826-1" tabindex="-1"></a>state.x77 <span class="sc">%&gt;%</span> </span>
<span id="cb826-2"><a href="visualising-data-with-ggplot2.html#cb826-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb826-3"><a href="visualising-data-with-ggplot2.html#cb826-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Area, Illiteracy<span class="sc">/</span><span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb826-4"><a href="visualising-data-with-ggplot2.html#cb826-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;dodgerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb826-5"><a href="visualising-data-with-ggplot2.html#cb826-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Area in Square Miles&quot;</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb826-6"><a href="visualising-data-with-ggplot2.html#cb826-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Illiteracy as % of Population&quot;</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scale3"></span>
<img src="DauR_files/figure-html/scale3-1.png" alt="Transforming Axes in GGplot2" width="672" />
<p class="caption">
Figure 13.57: Transforming Axes in GGplot2
</p>
</div>
<p>Some other functions in <code>scales</code> library useful for displaying numerical data on axes are -</p>
<ul>
<li><code>scales::label_bytes()</code> formats numbers as kilobytes, megabytes etc.</li>
<li><code>scales::label_dollar()</code> formats numbers as currency.</li>
<li><code>scales::label_ordinal()</code> formats numbers in rank order: 1st, 2nd, 3rd etc.</li>
<li><code>scales::label_pvalue()</code> formats numbers as p-values: &lt;.05, &lt;.01,
.34, etc.</li>
<li><code>scales::label_date()</code></li>
<li><code>scales::label_date_short()</code> formats dates</li>
<li><code>scale::label_wrap()</code> useful to wrap long strings across multiple
lines.</li>
</ul>
<p>In figure <a href="visualising-data-with-ggplot2.html#fig:scale4">13.56</a>, though we have limited the scale for a fixed duration, readers may notice that there is still an empty space on both sides of the scale. In figure <a href="visualising-data-with-ggplot2.html#fig:rgg20">13.23</a> the space between <code>y</code> axis labels and bars may be annoying to some. To modify this empty space on scales (usually position scales) we can use <code>expand</code> argument of <code>scale_*_*</code> function through another function <code>expansion</code>. This function <code>expansion</code> has two arguments namely <code>mult</code> and <code>add</code>.</p>
<ul>
<li><code>mult</code> argument takes a vector with two numeric elements which indicate range expansion factors.</li>
<li><code>add</code> argument also takes a vector with two numeric elements but these indicate additive range expansion constants.</li>
</ul>
<p>To understand this let’s again consider the example in figure <a href="visualising-data-with-ggplot2.html#fig:rgg20">13.23</a>. Providing <code>mult = c(0, 0.2)</code> in <code>expansion</code> multiplies <code>x</code> axis (continuous in this case) with <code>0</code> times on left side, and <code>0.2</code> times of <code>limit</code> on right side. See output in figure <a href="visualising-data-with-ggplot2.html#fig:scale5">13.58</a>.</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="visualising-data-with-ggplot2.html#cb827-1" tabindex="-1"></a>aggregated_mpg <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span> </span>
<span id="cb827-2"><a href="visualising-data-with-ggplot2.html#cb827-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_cty =</span> <span class="fu">mean</span>(cty),</span>
<span id="cb827-3"><a href="visualising-data-with-ggplot2.html#cb827-3" tabindex="-1"></a>            <span class="at">.by =</span> class) </span>
<span id="cb827-4"><a href="visualising-data-with-ggplot2.html#cb827-4" tabindex="-1"></a></span>
<span id="cb827-5"><a href="visualising-data-with-ggplot2.html#cb827-5" tabindex="-1"></a><span class="fu">ggplot</span>(aggregated_mpg, <span class="fu">aes</span>(<span class="at">x =</span> mean_cty, <span class="at">y =</span> class)) <span class="sc">+</span></span>
<span id="cb827-6"><a href="visualising-data-with-ggplot2.html#cb827-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb827-7"><a href="visualising-data-with-ggplot2.html#cb827-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scale5"></span>
<img src="DauR_files/figure-html/scale5-1.png" alt="Modifying scale limits though expansion" width="672" />
<p class="caption">
Figure 13.58: Modifying scale limits though expansion
</p>
</div>
</div>
<div id="adding-secondary-position-axis" class="section level3" number="13.5.2">
<h3><span class="header-section-number">13.5.2</span> Adding secondary position axis</h3>
<p>Most of the times two different position aesthetics are shown in same plot having different scales altogether. In such cases secondary axes can be useful for comparing datasets with different magnitudes or units, allowing for a clearer representation of diverse data sets within a single chart. However, caution is needed as secondary axes can sometimes lead to misleading interpretations. If not used carefully, they might obscure important trends or create confusion, especially if the scale differences are not immediately obvious to the viewer.</p>
<p>Secondary axes can be added in ggplot2, using <code>sec_axis</code> function as an argument to <code>sec.axis</code> inside <code>scale</code>s. As an example, we can see the two <code>y</code> axis representing same data both in degree Fahrenheit and degree Celsius in figure <a href="visualising-data-with-ggplot2.html#fig:scale6">13.59</a>. First argument of <code>sec_axis</code> takes a transformation function using tidyverse style syntax. Another useful argument is <code>name</code> apart from other usual functions like <code>labels</code>, etc.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="visualising-data-with-ggplot2.html#cb828-1" tabindex="-1"></a>airquality <span class="sc">|&gt;</span></span>
<span id="cb828-2"><a href="visualising-data-with-ggplot2.html#cb828-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">factor</span>(month.abb[Month], <span class="at">ordered =</span> <span class="cn">TRUE</span>, <span class="at">levels =</span> month.abb)) <span class="sc">|&gt;</span></span>
<span id="cb828-3"><a href="visualising-data-with-ggplot2.html#cb828-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_rev</span>(Month), Temp)) <span class="sc">+</span></span>
<span id="cb828-4"><a href="visualising-data-with-ggplot2.html#cb828-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(</span>
<span id="cb828-5"><a href="visualising-data-with-ggplot2.html#cb828-5" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>,</span>
<span id="cb828-6"><a href="visualising-data-with-ggplot2.html#cb828-6" tabindex="-1"></a>    <span class="at">fun =</span> mean</span>
<span id="cb828-7"><a href="visualising-data-with-ggplot2.html#cb828-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb828-8"><a href="visualising-data-with-ggplot2.html#cb828-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Average Temp (\u00B0F)&quot;</span>,</span>
<span id="cb828-9"><a href="visualising-data-with-ggplot2.html#cb828-9" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)),</span>
<span id="cb828-10"><a href="visualising-data-with-ggplot2.html#cb828-10" tabindex="-1"></a>                     <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> (. <span class="sc">-</span> <span class="dv">32</span>) <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">9</span>,</span>
<span id="cb828-11"><a href="visualising-data-with-ggplot2.html#cb828-11" tabindex="-1"></a>                                         <span class="at">name =</span> <span class="st">&quot; Average Temp (\u00B0C)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb828-12"><a href="visualising-data-with-ggplot2.html#cb828-12" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Month&quot;</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scale6"></span>
<img src="DauR_files/figure-html/scale6-1.png" alt="Adding Secondary Axis" width="672" />
<p class="caption">
Figure 13.59: Adding Secondary Axis
</p>
</div>
</div>
<div id="customising-color-or-fill-mappings" class="section level3" number="13.5.3">
<h3><span class="header-section-number">13.5.3</span> Customising color (or fill) mappings</h3>
<p><em>Readers are advised to read appendix</em> <a href="COLORR.html#COLORR">A</a> <em>wherein we have
discussed color aesthetic in pretty details.</em> By far we know that
continuous data if mapped to a color aesthetic gives us a gradient color
scale and discrete data on the other hand, provides us discrete color
values.</p>
<p>For continuous variables we thus have <code>scale_fill_continuous()</code> function
in turn defaulting to <code>scale_fill_gradient()</code>. In other words, the
default colors are picked by <code>scale_fill_gradient</code> function, which uses
following mentioned colors. Readers may also note that all <code>fill</code> scale
functions have a corresponding <code>color</code> scale function to be used with
<code>color</code> aesthetic.</p>
<pre><code>scale_colour_gradient(
  name = waiver(),
  ...,
  low = &quot;#132B43&quot;,
  high = &quot;#56B1F7&quot;,
  space = &quot;Lab&quot;,
  na.value = &quot;grey50&quot;,
  guide = &quot;colourbar&quot;,
  aesthetics = &quot;colour&quot;
)</code></pre>
<p>So we may change the desired colors in the color gradient. There are two
more related scales.</p>
<ul>
<li><code>scale_fill_gradient2()</code> which produces a three-colour gradient with
specified midpoint</li>
<li><code>scale_fill_gradientn()</code> which produces an n-colour gradient.</li>
</ul>
<p>The usage may be clear with the following examples.</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="visualising-data-with-ggplot2.html#cb830-1" tabindex="-1"></a>economics <span class="sc">|&gt;</span> </span>
<span id="cb830-2"><a href="visualising-data-with-ggplot2.html#cb830-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">TRUE</span>),</span>
<span id="cb830-3"><a href="visualising-data-with-ggplot2.html#cb830-3" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">year</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb830-4"><a href="visualising-data-with-ggplot2.html#cb830-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, month)) <span class="sc">+</span></span>
<span id="cb830-5"><a href="visualising-data-with-ggplot2.html#cb830-5" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> psavert)) <span class="sc">+</span></span>
<span id="cb830-6"><a href="visualising-data-with-ggplot2.html#cb830-6" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb830-7"><a href="visualising-data-with-ggplot2.html#cb830-7" tabindex="-1"></a>                       <span class="at">high =</span> <span class="st">&quot;seagreen&quot;</span>,</span>
<span id="cb830-8"><a href="visualising-data-with-ggplot2.html#cb830-8" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fu">mean</span>(economics<span class="sc">$</span>psavert))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg53"></span>
<img src="DauR_files/figure-html/rgg53-1.png" alt="Customising Fill scale" width="672" />
<p class="caption">
Figure 13.60: Customising Fill scale
</p>
</div>
<p>If however, the variable mapped with <code>fill</code> or <code>color</code> scale is
discrete, the default scale picked up by ggplot2 is
<code>scale_fill_discrete</code> which picks its values from corresponding
<code>scale_fill_hue()</code> by default.</p>
<p>However, for discrete color/fill scales it is advised to use <code>brewer</code>
palettes as described in Appendix <a href="COLORR.html#COLORR">A</a>, due to slight
complexity involved in <code>hue</code> scales. Moreover, if we want to pick our
colors manually, we may use <code>scale_fill_manual()</code> which takes color
values from a named vector where names are the categories available in
the variable. See the following example in figure <a href="visualising-data-with-ggplot2.html#fig:rgg54">13.61</a>.</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="visualising-data-with-ggplot2.html#cb831-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(fl, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb831-2"><a href="visualising-data-with-ggplot2.html#cb831-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb831-3"><a href="visualising-data-with-ggplot2.html#cb831-3" tabindex="-1"></a></span>
<span id="cb831-4"><a href="visualising-data-with-ggplot2.html#cb831-4" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(fl, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb831-5"><a href="visualising-data-with-ggplot2.html#cb831-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb831-6"><a href="visualising-data-with-ggplot2.html#cb831-6" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">c =</span> <span class="st">&quot;seagreen&quot;</span>, <span class="at">d =</span> <span class="st">&quot;tomato4&quot;</span>,</span>
<span id="cb831-7"><a href="visualising-data-with-ggplot2.html#cb831-7" tabindex="-1"></a>                               <span class="at">e =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">p =</span> <span class="st">&quot;cadetblue3&quot;</span>,</span>
<span id="cb831-8"><a href="visualising-data-with-ggplot2.html#cb831-8" tabindex="-1"></a>                               <span class="at">r =</span> <span class="st">&quot;indianred&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg54"></span>
<img src="DauR_files/figure-html/rgg54-1.png" alt="Customising Fill scale manually" width="49%" /><img src="DauR_files/figure-html/rgg54-2.png" alt="Customising Fill scale manually" width="49%" />
<p class="caption">
Figure 13.61: Customising Fill scale manually
</p>
</div>
<p>Another set of scales in ggplot2, sometimes useful are
<code>scale_color_identity()</code> which are useful when the data has already been
scaled, i.e. it already represents aesthetic values that ggplot2 can
handle directly. See the following example in figure <a href="visualising-data-with-ggplot2.html#fig:rgg55">13.62</a>.</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="visualising-data-with-ggplot2.html#cb832-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb832-2"><a href="visualising-data-with-ggplot2.html#cb832-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb832-3"><a href="visualising-data-with-ggplot2.html#cb832-3" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb832-4"><a href="visualising-data-with-ggplot2.html#cb832-4" tabindex="-1"></a>  <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb832-5"><a href="visualising-data-with-ggplot2.html#cb832-5" tabindex="-1"></a>)</span>
<span id="cb832-6"><a href="visualising-data-with-ggplot2.html#cb832-6" tabindex="-1"></a></span>
<span id="cb832-7"><a href="visualising-data-with-ggplot2.html#cb832-7" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb832-8"><a href="visualising-data-with-ggplot2.html#cb832-8" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> colour))</span>
<span id="cb832-9"><a href="visualising-data-with-ggplot2.html#cb832-9" tabindex="-1"></a></span>
<span id="cb832-10"><a href="visualising-data-with-ggplot2.html#cb832-10" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb832-11"><a href="visualising-data-with-ggplot2.html#cb832-11" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> colour)) <span class="sc">+</span></span>
<span id="cb832-12"><a href="visualising-data-with-ggplot2.html#cb832-12" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg55"></span>
<img src="DauR_files/figure-html/rgg55-1.png" alt="Identity Color Scale" width="49%" /><img src="DauR_files/figure-html/rgg55-2.png" alt="Identity Color Scale" width="49%" />
<p class="caption">
Figure 13.62: Identity Color Scale
</p>
</div>
</div>
<div id="other-scale-aesthetics" class="section level3" number="13.5.4">
<h3><span class="header-section-number">13.5.4</span> Other scale aesthetics</h3>
<p>Similar to position and color/fill scales there are scale functions for
other aesthetics which are appropriately named and can be used to modify
mappings as per our requirement. For e.g. to change shape aesthetic with
that of values available in data, we have <code>scale_shape_identity()</code> or to
change shapes manually we have <code>scale_shape_manual</code> which takes a named
vector. Readers are advised to go through these functions through their
help pages and use-cases by themselves.</p>
</div>
</div>
<div id="coordinate-systems" class="section level2" number="13.6">
<h2><span class="header-section-number">13.6</span> Coordinate systems</h2>
<p>So far, we know that default coordinate system adopted by ggplot2 is
Cartesian, which requires <code>x</code> and <code>y</code> position aesthetics to map data in
two-dimensional plots. It uses <code>coord_cartesian()</code> function along with
its default values. Other linear coordinate systems are <code>coord_flip()</code>,
which flips x and y axes; and <code>coord_fixed()</code> which preserves the fixed
aspect ratio.</p>
<p><code>coord_cartesian()</code> has arguments <code>xlim</code> and <code>ylim</code> which can be used to
set limits of <code>x</code> and <code>y</code> axes respectively, but unlike <code>limits</code>
argument of <code>scale_*_*</code> function does not discard the data, which is out
of the limits. As an example, refer three plots in Figure
<a href="visualising-data-with-ggplot2.html#fig:rgg56">13.63</a>, wherein <code>scale_x_continuous</code> has changed the shape of
smoothed curve as the data out of the plot has been discarded.</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="visualising-data-with-ggplot2.html#cb833-1" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span> </span>
<span id="cb833-2"><a href="visualising-data-with-ggplot2.html#cb833-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb833-3"><a href="visualising-data-with-ggplot2.html#cb833-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb833-4"><a href="visualising-data-with-ggplot2.html#cb833-4" tabindex="-1"></a></span>
<span id="cb833-5"><a href="visualising-data-with-ggplot2.html#cb833-5" tabindex="-1"></a><span class="co"># Full dataset</span></span>
<span id="cb833-6"><a href="visualising-data-with-ggplot2.html#cb833-6" tabindex="-1"></a>base</span>
<span id="cb833-7"><a href="visualising-data-with-ggplot2.html#cb833-7" tabindex="-1"></a></span>
<span id="cb833-8"><a href="visualising-data-with-ggplot2.html#cb833-8" tabindex="-1"></a><span class="co"># Scaling to 4--6 throws away data outside that range</span></span>
<span id="cb833-9"><a href="visualising-data-with-ggplot2.html#cb833-9" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>))</span>
<span id="cb833-10"><a href="visualising-data-with-ggplot2.html#cb833-10" tabindex="-1"></a></span>
<span id="cb833-11"><a href="visualising-data-with-ggplot2.html#cb833-11" tabindex="-1"></a><span class="co"># Zooming to 4--6 keeps all the data but only shows some of it</span></span>
<span id="cb833-12"><a href="visualising-data-with-ggplot2.html#cb833-12" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg56"></span>
<img src="DauR_files/figure-html/rgg56-1.png" alt="Setting limits" width="33%" /><img src="DauR_files/figure-html/rgg56-2.png" alt="Setting limits" width="33%" /><img src="DauR_files/figure-html/rgg56-3.png" alt="Setting limits" width="33%" />
<p class="caption">
Figure 13.63: Setting limits
</p>
</div>
<p>Another coordinate system <code>coord_flip</code>, flips the axes and is useful to
flip the axes. One thing to note that here <code>x</code> axis is drawn vertically
and thus, if any <code>geom</code> is drawn which takes <code>x</code> value will take the
values from vertical axis and not from horizontal axis.</p>
<p>However there are other coordinate systems available in ggplot2, which
have been listed in table <a href="visualising-data-with-ggplot2.html#tab:coords">13.3</a> for ready reference.</p>
<table>
<caption><span id="tab:coords">Table 13.3: </span>List of Coordinate Systems available in ggplot2</caption>
<thead>
<tr class="header">
<th align="left">Entry</th>
<th align="left">Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">coord_cartesian</td>
<td align="left">Cartesian coordinates</td>
</tr>
<tr class="even">
<td align="left">coord_fixed</td>
<td align="left">Cartesian coordinates with fixed “aspect ratio”</td>
</tr>
<tr class="odd">
<td align="left">coord_equal</td>
<td align="left">Cartesian coordinates with fixed “aspect ratio”</td>
</tr>
<tr class="even">
<td align="left">coord_flip</td>
<td align="left">Cartesian coordinates with x and y flipped</td>
</tr>
<tr class="odd">
<td align="left">coord_map</td>
<td align="left">Map projections</td>
</tr>
<tr class="even">
<td align="left">coord_quickmap</td>
<td align="left">Map projections</td>
</tr>
<tr class="odd">
<td align="left">coord_munch</td>
<td align="left">Munch coordinates data</td>
</tr>
<tr class="even">
<td align="left">coord_polar</td>
<td align="left">Polar coordinates</td>
</tr>
<tr class="odd">
<td align="left">coord_radial</td>
<td align="left">Polar coordinates</td>
</tr>
<tr class="even">
<td align="left">coord_trans</td>
<td align="left">Transformed Cartesian coordinate system</td>
</tr>
<tr class="odd">
<td align="left">coord_sf</td>
<td align="left">Visualise sf objects</td>
</tr>
</tbody>
</table>
<p>Out of the listed coordinate systems, some are really important and
cannot be skipped for gaining the basic architecture of ggplot2. Do you
know that a pie chart is basically a bar chart drawn in polar coordinate
system? The answer is yes. So let’s understand polar coordinate system
and recently introduced radial coordinate system which help us to draw a
pie chart.</p>
<p>In the following code, a 100% stacked bar chart (flipped on y axis) is
converted to a pie chart by adopting <code>coord_polar()</code> and to a bulls-eye
chart by setting <code>theta</code> position aesthetic to <code>"y"</code> position. Refer
three plots in figure <a href="visualising-data-with-ggplot2.html#fig:rgg57">13.64</a>.</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="visualising-data-with-ggplot2.html#cb834-1" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">factor</span>(<span class="dv">1</span>), <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb834-2"><a href="visualising-data-with-ggplot2.html#cb834-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb834-3"><a href="visualising-data-with-ggplot2.html#cb834-3" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb834-4"><a href="visualising-data-with-ggplot2.html#cb834-4" tabindex="-1"></a>                   <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb834-5"><a href="visualising-data-with-ggplot2.html#cb834-5" tabindex="-1"></a>                   <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb834-6"><a href="visualising-data-with-ggplot2.html#cb834-6" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb834-7"><a href="visualising-data-with-ggplot2.html#cb834-7" tabindex="-1"></a></span>
<span id="cb834-8"><a href="visualising-data-with-ggplot2.html#cb834-8" tabindex="-1"></a><span class="co"># Stacked barchart</span></span>
<span id="cb834-9"><a href="visualising-data-with-ggplot2.html#cb834-9" tabindex="-1"></a>base</span>
<span id="cb834-10"><a href="visualising-data-with-ggplot2.html#cb834-10" tabindex="-1"></a></span>
<span id="cb834-11"><a href="visualising-data-with-ggplot2.html#cb834-11" tabindex="-1"></a><span class="co"># Pie chart</span></span>
<span id="cb834-12"><a href="visualising-data-with-ggplot2.html#cb834-12" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">coord_polar</span>()</span>
<span id="cb834-13"><a href="visualising-data-with-ggplot2.html#cb834-13" tabindex="-1"></a></span>
<span id="cb834-14"><a href="visualising-data-with-ggplot2.html#cb834-14" tabindex="-1"></a><span class="co"># The bullseye chart</span></span>
<span id="cb834-15"><a href="visualising-data-with-ggplot2.html#cb834-15" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg57"></span>
<img src="DauR_files/figure-html/rgg57-1.png" alt="Polar Coordinates" width="33%" /><img src="DauR_files/figure-html/rgg57-2.png" alt="Polar Coordinates" width="33%" /><img src="DauR_files/figure-html/rgg57-3.png" alt="Polar Coordinates" width="33%" />
<p class="caption">
Figure 13.64: Polar Coordinates
</p>
</div>
<p>By recently introduced <code>coord_radial</code> which is specifically designed for
pie charts, the base layer (i.e. 100% stacked bar chart) can be
converted to a pie chart. (Refer plots in figure <a href="visualising-data-with-ggplot2.html#fig:rgg58">13.65</a>.)</p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="visualising-data-with-ggplot2.html#cb835-1" tabindex="-1"></a><span class="co"># With default value</span></span>
<span id="cb835-2"><a href="visualising-data-with-ggplot2.html#cb835-2" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">coord_radial</span>()</span>
<span id="cb835-3"><a href="visualising-data-with-ggplot2.html#cb835-3" tabindex="-1"></a></span>
<span id="cb835-4"><a href="visualising-data-with-ggplot2.html#cb835-4" tabindex="-1"></a><span class="co"># Without expansion</span></span>
<span id="cb835-5"><a href="visualising-data-with-ggplot2.html#cb835-5" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">coord_radial</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg58"></span>
<img src="DauR_files/figure-html/rgg58-1.png" alt="Using Radial Coordinates" width="49%" /><img src="DauR_files/figure-html/rgg58-2.png" alt="Using Radial Coordinates" width="49%" />
<p class="caption">
Figure 13.65: Using Radial Coordinates
</p>
</div>
<p>The <code>coord_radial</code> can also be used to create donut charts easily by
setting parameter <code>inner.radius</code> as can be seen in Figure
<a href="visualising-data-with-ggplot2.html#fig:rgg59">13.66</a>.</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="visualising-data-with-ggplot2.html#cb836-1" tabindex="-1"></a><span class="co"># Donut Chart</span></span>
<span id="cb836-2"><a href="visualising-data-with-ggplot2.html#cb836-2" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">coord_radial</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>,</span>
<span id="cb836-3"><a href="visualising-data-with-ggplot2.html#cb836-3" tabindex="-1"></a>                    <span class="at">inner.radius =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg59"></span>
<img src="DauR_files/figure-html/rgg59-1.png" alt="Donut Charts with Radial Coordinates" width="672" />
<p class="caption">
Figure 13.66: Donut Charts with Radial Coordinates
</p>
</div>
<p><code>coord_radial</code> also places the labels automatically, while adjusting
<code>inner.radius</code>. Refer plots in <a href="visualising-data-with-ggplot2.html#fig:rgg60">13.67</a>.</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="visualising-data-with-ggplot2.html#cb837-1" tabindex="-1"></a>base2 <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span> </span>
<span id="cb837-2"><a href="visualising-data-with-ggplot2.html#cb837-2" tabindex="-1"></a>    <span class="fu">count</span>(class) <span class="sc">|&gt;</span> </span>
<span id="cb837-3"><a href="visualising-data-with-ggplot2.html#cb837-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> n, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb837-4"><a href="visualising-data-with-ggplot2.html#cb837-4" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb837-5"><a href="visualising-data-with-ggplot2.html#cb837-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), </span>
<span id="cb837-6"><a href="visualising-data-with-ggplot2.html#cb837-6" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb837-7"><a href="visualising-data-with-ggplot2.html#cb837-7" tabindex="-1"></a></span>
<span id="cb837-8"><a href="visualising-data-with-ggplot2.html#cb837-8" tabindex="-1"></a>base2 <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb837-9"><a href="visualising-data-with-ggplot2.html#cb837-9" tabindex="-1"></a></span>
<span id="cb837-10"><a href="visualising-data-with-ggplot2.html#cb837-10" tabindex="-1"></a>base2 <span class="sc">+</span></span>
<span id="cb837-11"><a href="visualising-data-with-ggplot2.html#cb837-11" tabindex="-1"></a>  <span class="fu">coord_radial</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>, </span>
<span id="cb837-12"><a href="visualising-data-with-ggplot2.html#cb837-12" tabindex="-1"></a>               <span class="at">theta =</span> <span class="st">&quot;y&quot;</span>, </span>
<span id="cb837-13"><a href="visualising-data-with-ggplot2.html#cb837-13" tabindex="-1"></a>               <span class="at">inner.radius =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg60"></span>
<img src="DauR_files/figure-html/rgg60-1.png" alt="Labels adjustments in Donut Charts with Radial Coordinates" width="49%" /><img src="DauR_files/figure-html/rgg60-2.png" alt="Labels adjustments in Donut Charts with Radial Coordinates" width="49%" />
<p class="caption">
Figure 13.67: Labels adjustments in Donut Charts with Radial Coordinates
</p>
</div>
<p>Though there is a lot more that can be done in <code>coord_radial</code> , one
final example of using <code>coord_radial</code> can be drawing bar plots in
circle, as shown in figure <a href="visualising-data-with-ggplot2.html#fig:rgg61">13.68</a>.</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="visualising-data-with-ggplot2.html#cb838-1" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span></span>
<span id="cb838-2"><a href="visualising-data-with-ggplot2.html#cb838-2" tabindex="-1"></a>  <span class="co">#arrange(-mpg) |&gt;</span></span>
<span id="cb838-3"><a href="visualising-data-with-ggplot2.html#cb838-3" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&#39;Car&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb838-4"><a href="visualising-data-with-ggplot2.html#cb838-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">seq_along</span>(mpg), mpg, <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb838-5"><a href="visualising-data-with-ggplot2.html#cb838-5" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="dv">1</span>,</span>
<span id="cb838-6"><a href="visualising-data-with-ggplot2.html#cb838-6" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb838-7"><a href="visualising-data-with-ggplot2.html#cb838-7" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">32</span>, <span class="at">label =</span> Car),</span>
<span id="cb838-8"><a href="visualising-data-with-ggplot2.html#cb838-8" tabindex="-1"></a>            <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb838-9"><a href="visualising-data-with-ggplot2.html#cb838-9" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb838-10"><a href="visualising-data-with-ggplot2.html#cb838-10" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb838-11"><a href="visualising-data-with-ggplot2.html#cb838-11" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">32</span>, <span class="at">label =</span> mpg),</span>
<span id="cb838-12"><a href="visualising-data-with-ggplot2.html#cb838-12" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb838-13"><a href="visualising-data-with-ggplot2.html#cb838-13" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb838-14"><a href="visualising-data-with-ggplot2.html#cb838-14" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb838-15"><a href="visualising-data-with-ggplot2.html#cb838-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb838-16"><a href="visualising-data-with-ggplot2.html#cb838-16" tabindex="-1"></a>  <span class="fu">coord_radial</span>(<span class="at">rotate.angle =</span> <span class="cn">TRUE</span>, <span class="at">expand =</span> <span class="cn">FALSE</span>)  <span class="sc">+</span></span>
<span id="cb838-17"><a href="visualising-data-with-ggplot2.html#cb838-17" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;seagreen&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb838-18"><a href="visualising-data-with-ggplot2.html#cb838-18" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb838-19"><a href="visualising-data-with-ggplot2.html#cb838-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;aliceblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb838-20"><a href="visualising-data-with-ggplot2.html#cb838-20" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Miles per gallon for different cars&quot;</span>) <span class="sc">+</span></span>
<span id="cb838-21"><a href="visualising-data-with-ggplot2.html#cb838-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb838-22"><a href="visualising-data-with-ggplot2.html#cb838-22" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg61"></span>
<img src="DauR_files/figure-html/rgg61-1.png" alt="Bar plot in circle" width="672" />
<p class="caption">
Figure 13.68: Bar plot in circle
</p>
</div>
</div>
<div id="faceting" class="section level2" number="13.7">
<h2><span class="header-section-number">13.7</span> Faceting</h2>
<p>The amount of data also makes a difference: if there is a lot of data it
can be hard to distinguish different groups. An alternative solution is
to use faceting, as described next. Facets, or “small-multiples”, are
used to split one plot into a multi-panel figure, with one panel
(“facet”) per group of data. The same type of plot is created multiple
times, each one using a sub-group of the same dataset.</p>
<p>In <code>ggplot2</code> faceting can be achieved using either of the functions -</p>
<ul>
<li><code>facet_grid()</code> creates a grid of plots, with each plot showing a
subset of the data. We may also specify the number of columns to use
in the grid using the <code>ncol</code> argument.</li>
<li><code>facet_wrap()</code> creates a grid of plots with different variables on
each axis. We may also specify the scales to use for each axis using
the <code>scales</code> argument.</li>
</ul>
<p>Let us understand this, with the following examples. In figure
<a href="visualising-data-with-ggplot2.html#fig:rgg62">13.69</a> <code>facet_grid()</code> has been used. Notice that
<code>facet_grid()</code> arranges the plots in a grid with different variables on
each axis. We specify the variables to use for faceting using the <code>~</code>
operator. For example, <code>facet_grid(variable1 ~ variable2)</code> will create a
grid of plots with <code>variable1</code> on the y-axis and <code>variable2</code> on the
x-axis. This is useful when we want to compare the relationship between
two variables across different levels of a third variable.</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="visualising-data-with-ggplot2.html#cb839-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb839-2"><a href="visualising-data-with-ggplot2.html#cb839-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb839-3"><a href="visualising-data-with-ggplot2.html#cb839-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> class, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg62"></span>
<img src="DauR_files/figure-html/rgg62-1.png" alt="Wrapping sub plots in facets" width="672" />
<p class="caption">
Figure 13.69: Wrapping sub plots in facets
</p>
</div>
<p>On the other hand, <code>facet_wrap()</code> creates a grid of plots, each showing
a subset of your data based on a single variable. We specify the
variable to use for faceting using the same <code>~</code> operator here too. For
example, <code>facet_wrap(~ variable)</code> will create a grid of plots, each
showing a different level of the variable. This is useful when you have
a single categorical variable that you want to use for faceting. See
example in figure <a href="visualising-data-with-ggplot2.html#fig:rgg63">13.70</a>.</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="visualising-data-with-ggplot2.html#cb840-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb840-2"><a href="visualising-data-with-ggplot2.html#cb840-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb840-3"><a href="visualising-data-with-ggplot2.html#cb840-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year <span class="sc">~</span> class)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg63"></span>
<img src="DauR_files/figure-html/rgg63-1.png" alt="Grid alignment of sub plots in facets" width="672" />
<p class="caption">
Figure 13.70: Grid alignment of sub plots in facets
</p>
</div>
</div>
<div id="labeling-and-annotating-charts" class="section level2" number="13.8">
<h2><span class="header-section-number">13.8</span> Labeling and Annotating Charts</h2>
<p>Labeling is an essential aspect of data visualization because it provides context and information about the data being presented. Labels can include titles, axis labels, legends, and annotations that describe the data and provide important information that helps the viewer understand what they are looking at. Proper labeling can help to make the data more understandable, clear, and accessible, which enhances its overall value and impact.</p>
<div id="annotations" class="section level3" number="13.8.1">
<h3><span class="header-section-number">13.8.1</span> Annotations</h3>
<p>We have already covered use of <code>geoms</code> like <code>geom_text</code>, <code>geom_label</code>, <code>geom_vline</code>, <code>geom_abline</code>, etc., used to label or annotate geometries in a plot. There are several other geoms used to annotate charts in ggplot2. Let us discuss a few of these.</p>
<ul>
<li><code>geom_rect()</code> is used to draw a rectangle in plot area using aesthetics <code>xmin</code>, <code>xmax</code>, <code>ymin</code> and <code>ymax</code></li>
<li><code>geom_segment()</code> can create a line segment.</li>
</ul>
<p>Moreover, there is a helper function <code>annotate</code> which also adds geoms to a plot, but unlike a typical geom function, the properties of the geoms are not mapped from variables of a data frame, but are instead passed in as vectors. This is useful for adding small annotations (such as text labels) or if we have your data in vectors, and for some reason don’t want to put them in a data frame. See an example in plot in Figure <a href="visualising-data-with-ggplot2.html#fig:rrgg63">13.71</a> wherein we have added five annotation elements (i) a rectangle, (ii) two text labels and (iii) two arrows.</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="visualising-data-with-ggplot2.html#cb841-1" tabindex="-1"></a><span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date, unemploy)) <span class="sc">+</span></span>
<span id="cb841-2"><a href="visualising-data-with-ggplot2.html#cb841-2" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb841-3"><a href="visualising-data-with-ggplot2.html#cb841-3" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;rect&quot;</span>,</span>
<span id="cb841-4"><a href="visualising-data-with-ggplot2.html#cb841-4" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">ymd</span>(<span class="st">&quot;20071201&quot;</span>),</span>
<span id="cb841-5"><a href="visualising-data-with-ggplot2.html#cb841-5" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">ymd</span>(<span class="st">&quot;20091231&quot;</span>),</span>
<span id="cb841-6"><a href="visualising-data-with-ggplot2.html#cb841-6" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb841-7"><a href="visualising-data-with-ggplot2.html#cb841-7" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb841-8"><a href="visualising-data-with-ggplot2.html#cb841-8" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb841-9"><a href="visualising-data-with-ggplot2.html#cb841-9" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb841-10"><a href="visualising-data-with-ggplot2.html#cb841-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb841-11"><a href="visualising-data-with-ggplot2.html#cb841-11" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb841-12"><a href="visualising-data-with-ggplot2.html#cb841-12" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;label&quot;</span>,</span>
<span id="cb841-13"><a href="visualising-data-with-ggplot2.html#cb841-13" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">ymd</span>(<span class="st">&quot;20070801&quot;</span>),</span>
<span id="cb841-14"><a href="visualising-data-with-ggplot2.html#cb841-14" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">2500</span>,</span>
<span id="cb841-15"><a href="visualising-data-with-ggplot2.html#cb841-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;Global Financial Crisis&quot;</span>,</span>
<span id="cb841-16"><a href="visualising-data-with-ggplot2.html#cb841-16" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span></span>
<span id="cb841-17"><a href="visualising-data-with-ggplot2.html#cb841-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb841-18"><a href="visualising-data-with-ggplot2.html#cb841-18" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb841-19"><a href="visualising-data-with-ggplot2.html#cb841-19" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;curve&quot;</span>,</span>
<span id="cb841-20"><a href="visualising-data-with-ggplot2.html#cb841-20" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fu">ymd</span>(<span class="st">&quot;20080101&quot;</span>),</span>
<span id="cb841-21"><a href="visualising-data-with-ggplot2.html#cb841-21" tabindex="-1"></a>    <span class="at">yend =</span> <span class="dv">4000</span>,</span>
<span id="cb841-22"><a href="visualising-data-with-ggplot2.html#cb841-22" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">ymd</span>(<span class="st">&quot;20000101&quot;</span>),</span>
<span id="cb841-23"><a href="visualising-data-with-ggplot2.html#cb841-23" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">3000</span>,</span>
<span id="cb841-24"><a href="visualising-data-with-ggplot2.html#cb841-24" tabindex="-1"></a>    <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb841-25"><a href="visualising-data-with-ggplot2.html#cb841-25" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&#39;cm&#39;</span>))</span>
<span id="cb841-26"><a href="visualising-data-with-ggplot2.html#cb841-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb841-27"><a href="visualising-data-with-ggplot2.html#cb841-27" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb841-28"><a href="visualising-data-with-ggplot2.html#cb841-28" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb841-29"><a href="visualising-data-with-ggplot2.html#cb841-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">ymd</span>(<span class="st">&quot;20070801&quot;</span>),</span>
<span id="cb841-30"><a href="visualising-data-with-ggplot2.html#cb841-30" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">14000</span>,</span>
<span id="cb841-31"><a href="visualising-data-with-ggplot2.html#cb841-31" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;Sharp rise in unemployment&quot;</span>,</span>
<span id="cb841-32"><a href="visualising-data-with-ggplot2.html#cb841-32" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb841-33"><a href="visualising-data-with-ggplot2.html#cb841-33" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">&quot;bold.italic&quot;</span></span>
<span id="cb841-34"><a href="visualising-data-with-ggplot2.html#cb841-34" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb841-35"><a href="visualising-data-with-ggplot2.html#cb841-35" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb841-36"><a href="visualising-data-with-ggplot2.html#cb841-36" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;curve&quot;</span>,</span>
<span id="cb841-37"><a href="visualising-data-with-ggplot2.html#cb841-37" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fu">ymd</span>(<span class="st">&quot;20080701&quot;</span>),</span>
<span id="cb841-38"><a href="visualising-data-with-ggplot2.html#cb841-38" tabindex="-1"></a>    <span class="at">yend =</span> <span class="dv">12000</span>,</span>
<span id="cb841-39"><a href="visualising-data-with-ggplot2.html#cb841-39" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">ymd</span>(<span class="st">&quot;20000101&quot;</span>),</span>
<span id="cb841-40"><a href="visualising-data-with-ggplot2.html#cb841-40" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">13500</span>,</span>
<span id="cb841-41"><a href="visualising-data-with-ggplot2.html#cb841-41" tabindex="-1"></a>    <span class="at">curvature =</span> <span class="fl">0.5</span>,</span>
<span id="cb841-42"><a href="visualising-data-with-ggplot2.html#cb841-42" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&#39;cm&#39;</span>))</span>
<span id="cb841-43"><a href="visualising-data-with-ggplot2.html#cb841-43" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb841-44"><a href="visualising-data-with-ggplot2.html#cb841-44" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;indianred4&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rrgg63"></span>
<img src="DauR_files/figure-html/rrgg63-1.png" alt="Annotating charts" width="672" />
<p class="caption">
Figure 13.71: Annotating charts
</p>
</div>
</div>
<div id="labels" class="section level3" number="13.8.2">
<h3><span class="header-section-number">13.8.2</span> Labels</h3>
<p>Effective labeling is crucial for ensuring that plots are accessible and comprehensible to a wider audience. To achieve this, it’s important to use full variable names for axis and legend labels, as this enhances clarity. The plot’s <code>title</code> and <code>subtitle</code> should be employed to communicate the primary insights and key takeaways, making the information more digestible at a glance. The <code>caption</code> serves as a valuable space to include details about the data source, providing context and credibility. Furthermore, the <code>tag</code> feature can be utilized to add identification markers, which is particularly helpful when comparing or displaying multiple plots within a project.</p>
<p>There are several ways to add labels to ggplot2 charts, but we will focus on using the <code>labs()</code> function, which allows us to add <code>titles</code>, <code>subtitles</code>, <code>axis labels</code>, and other annotations like <code>caption</code>, etc., to the plot. Example -</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="visualising-data-with-ggplot2.html#cb842-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg, <span class="at">color =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb842-2"><a href="visualising-data-with-ggplot2.html#cb842-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb842-3"><a href="visualising-data-with-ggplot2.html#cb842-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Scatter plot of mpg vs. hp&quot;</span>,</span>
<span id="cb842-4"><a href="visualising-data-with-ggplot2.html#cb842-4" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Data from mtcars dataset&quot;</span>,</span>
<span id="cb842-5"><a href="visualising-data-with-ggplot2.html#cb842-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Horsepower&quot;</span>,</span>
<span id="cb842-6"><a href="visualising-data-with-ggplot2.html#cb842-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Miles per gallon&quot;</span>,</span>
<span id="cb842-7"><a href="visualising-data-with-ggplot2.html#cb842-7" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Cylinders&quot;</span>,</span>
<span id="cb842-8"><a href="visualising-data-with-ggplot2.html#cb842-8" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Source: R datasets&quot;</span>, </span>
<span id="cb842-9"><a href="visualising-data-with-ggplot2.html#cb842-9" tabindex="-1"></a>       <span class="at">tag =</span> <span class="st">&quot;Chart-1&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg64"></span>
<img src="DauR_files/figure-html/rgg64-1.png" alt="A properly labelled chart" width="672" />
<p class="caption">
Figure 13.72: A properly labelled chart
</p>
</div>
</div>
</div>
<div id="themes" class="section level2" number="13.9">
<h2><span class="header-section-number">13.9</span> Themes</h2>
<p>Till now (except in a few cases) we have used the default themes of plots generated in ggplot2. Themes can be however be used to customise the appearance, visual aesthetics by exercising fine control over the non-data elements in the plot. We can customize the appearance of plots, such as the axis labels, titles, background colors, and font sizes, styles, etc. by applying themes to the plot.</p>
<p>There are certain complete themes available in <code>ggplot2</code> which set all of the theme elements to values designed to work harmoniously. Defualt theme applied to a plot in ggplot2 is <code>theme_gray()</code>. A complete list of themes available in ggplot2 is given in the table <a href="visualising-data-with-ggplot2.html#tab:themesp">13.4</a> below:</p>
<table>
<caption><span id="tab:themesp">Table 13.4: </span> Themes in ggplot2</caption>
<colgroup>
<col width="27%" />
<col width="72%" />
</colgroup>
<thead>
<tr class="header">
<th>Theme name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>theme_gray()</code></td>
<td>The signature ggplot2 theme with a grey background and white gridlines, designed to put the data forward yet make comparisons easy.</td>
</tr>
<tr class="even">
<td><code>theme_bw()</code></td>
<td>The classic dark-on-light ggplot2 theme. May work better for presentations displayed with a projector.</td>
</tr>
<tr class="odd">
<td><code>theme_linedraw()</code></td>
<td>A theme with only black lines of various widths on white backgrounds, reminiscent of a line drawing. Serves a purpose similar to <code>theme_bw()</code>. Note that this theme has some very thin <code>lines (\&lt;\&lt; 1 pt)</code> which some journals may refuse.</td>
</tr>
<tr class="even">
<td><code>theme_light()</code></td>
<td>A theme similar to <code>theme_linedraw()</code> but with light grey lines and axes, to direct more attention towards the data.</td>
</tr>
<tr class="odd">
<td><code>theme_dark()</code></td>
<td>The dark cousin of <code>theme_light()</code>, with similar line sizes but a dark background. Useful to make thin coloured lines pop out.</td>
</tr>
<tr class="even">
<td><code>theme_minimal()</code></td>
<td>A minimalistic theme with no background annotations.</td>
</tr>
<tr class="odd">
<td><code>theme_classic()</code></td>
<td>A classic-looking theme, with x and y axis lines and no gridlines.</td>
</tr>
<tr class="even">
<td><code>theme_void()</code></td>
<td>A completely empty theme.</td>
</tr>
<tr class="odd">
<td><code>theme_test()</code></td>
<td>A theme for visual unit tests. It should ideally never change except for new features.</td>
</tr>
</tbody>
</table>
<p>Example plots having four of such themes can be seen in figure <a href="visualising-data-with-ggplot2.html#fig:theme1">13.73</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:theme1"></span>
<img src="DauR_files/figure-html/theme1-1.png" alt="Some complete themes available in ggplot2" width="672" />
<p class="caption">
Figure 13.73: Some complete themes available in ggplot2
</p>
</div>
<p>Individual elements can also, however, be modified through function <code>theme</code> available in ggplot2. This <code>theme</code> function should consist of <code>element</code> name which is to be modified, as an argument to the function. That element can then be modified through providing values to that argument, which most of the times is provided through <code>element function</code> like <code>element_text</code>, etc. Some of the elements commonly requiring a customisation through theme function is explained in figure <a href="visualising-data-with-ggplot2.html#fig:rgg65">13.74</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rgg65"></span>
<img src="images/elements.png" alt="Some theme elements" width="95%" height="40%" />
<p class="caption">
Figure 13.74: Some theme elements
</p>
</div>
<p>As an example refer plot in figure <a href="visualising-data-with-ggplot2.html#fig:theme2">13.75</a> wherein certain plot elements have been modified using <code>theme</code> function.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="visualising-data-with-ggplot2.html#cb843-1" tabindex="-1"></a>myplot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb843-2"><a href="visualising-data-with-ggplot2.html#cb843-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">seed =</span> <span class="dv">42</span>), <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(class))) <span class="sc">+</span></span>
<span id="cb843-3"><a href="visualising-data-with-ggplot2.html#cb843-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">21</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">seed =</span> <span class="dv">42</span>), <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(class))) <span class="sc">+</span></span>
<span id="cb843-4"><a href="visualising-data-with-ggplot2.html#cb843-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb843-5"><a href="visualising-data-with-ggplot2.html#cb843-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;City Vs. Highway Mileages&quot;</span>,</span>
<span id="cb843-6"><a href="visualising-data-with-ggplot2.html#cb843-6" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data Source: MPG Dataset&quot;</span>,</span>
<span id="cb843-7"><a href="visualising-data-with-ggplot2.html#cb843-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Mileage in City (Miles per Gallon)&quot;</span>,</span>
<span id="cb843-8"><a href="visualising-data-with-ggplot2.html#cb843-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Milaege in Highway (Miles per Gallon)&quot;</span>,</span>
<span id="cb843-9"><a href="visualising-data-with-ggplot2.html#cb843-9" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Class&quot;</span>) <span class="sc">+</span></span>
<span id="cb843-10"><a href="visualising-data-with-ggplot2.html#cb843-10" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb843-11"><a href="visualising-data-with-ggplot2.html#cb843-11" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb843-12"><a href="visualising-data-with-ggplot2.html#cb843-12" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;seagreen4&quot;</span>,</span>
<span id="cb843-13"><a href="visualising-data-with-ggplot2.html#cb843-13" tabindex="-1"></a>                             <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>),</span>
<span id="cb843-14"><a href="visualising-data-with-ggplot2.html#cb843-14" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;darkorchid4&quot;</span>),</span>
<span id="cb843-15"><a href="visualising-data-with-ggplot2.html#cb843-15" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb843-16"><a href="visualising-data-with-ggplot2.html#cb843-16" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb843-17"><a href="visualising-data-with-ggplot2.html#cb843-17" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb843-18"><a href="visualising-data-with-ggplot2.html#cb843-18" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb843-19"><a href="visualising-data-with-ggplot2.html#cb843-19" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb843-20"><a href="visualising-data-with-ggplot2.html#cb843-20" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold.italic&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb843-21"><a href="visualising-data-with-ggplot2.html#cb843-21" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb843-22"><a href="visualising-data-with-ggplot2.html#cb843-22" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb843-23"><a href="visualising-data-with-ggplot2.html#cb843-23" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb843-24"><a href="visualising-data-with-ggplot2.html#cb843-24" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb843-25"><a href="visualising-data-with-ggplot2.html#cb843-25" tabindex="-1"></a>  )</span>
<span id="cb843-26"><a href="visualising-data-with-ggplot2.html#cb843-26" tabindex="-1"></a></span>
<span id="cb843-27"><a href="visualising-data-with-ggplot2.html#cb843-27" tabindex="-1"></a>myplot</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:theme2"></span>
<img src="DauR_files/figure-html/theme2-1.png" alt="Customising Themes in GGplot2" width="672" />
<p class="caption">
Figure 13.75: Customising Themes in GGplot2
</p>
</div>
<p>We can combine multiple customization options together to create a customized theme that fits our specific needs using <code>theme_set()</code>. The possibilities for customization are endless, so feel free to experiment and create your own unique theme!</p>
</div>
<div id="savingexporting-plots" class="section level2" number="13.10">
<h2><span class="header-section-number">13.10</span> Saving/exporting plots</h2>
<p>Of course, after creating charts/plots we would like to save them for further usage in our reports/documents, etc. Though there may be many options to save a plot to disk, we will be focusing on three different methods.</p>
<div id="saving-through-rstudio-menu" class="section level3 unnumbered">
<h3>Saving through Rstudio menu</h3>
<p>To save a graph using the RStudio menus, go to the Plots tab and choose <code>Export</code>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:export1"></span>
<img src="images/export.png" alt="Exporting Charts" width="95%" />
<p class="caption">
Figure 13.76: Exporting Charts
</p>
</div>
<p>Three options are available here.</p>
<ul>
<li>Save as Image</li>
<li>Save as PDF</li>
<li>Copy to clipboard.</li>
</ul>
<p>We can use the options as per requirement.</p>
</div>
<div id="saving-through-code" class="section level3 unnumbered">
<h3>Saving through code</h3>
<p>We may also save our plots using function <code>ggsave()</code> here. Its syntax is simple</p>
<pre><code>ggsave(
  filename,
  plot = last_plot(),
  device = NULL,
  path = NULL,
  scale = 1,
  width = NA,
  height = NA,
  units = c(&quot;in&quot;, &quot;cm&quot;, &quot;mm&quot;, &quot;px&quot;),
  dpi = 300,
  limitsize = TRUE,
  bg = NULL,
  ...
)</code></pre>
<p>All arguments are simple to understand. Thus for example if we need to save the plot we generated in figure <a href="visualising-data-with-ggplot2.html#fig:theme2">13.75</a>, we can use <code>ggsave</code>.</p>
<pre><code>ggsave(&#39;Mileages.png&#39;, myplot, height = 10, width = 8)</code></pre>
</div>
<div id="graphics-devices-base-r-plots" class="section level3 unnumbered">
<h3>Graphics Devices (Base R Plots)</h3>
<p>If we have created plots outside of ggplot (with <code>plot()</code>, <code>hist()</code>,
<code>boxplot()</code>, etc.), we cannot use <code>ggsave()</code> to save our plots since it
only supports plots made with ggplot.</p>
<p>Base R provides a way to save these plots with its graphic device
functions. There are three steps involved in this process-</p>
<ul>
<li>Specify the file extension and properties (size, resolution, etc.)
along with units</li>
<li>create the plot, in base R or/and ggplot2</li>
<li>Signal that the plot is finished and save it by running <code>dev.off()</code>.
Thus, using this way we can insert as many charts in a single pdf
without turning off the device till our pdf is ready.</li>
</ul>
<p>Example-</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="visualising-data-with-ggplot2.html#cb846-1" tabindex="-1"></a><span class="co"># Creates a png file</span></span>
<span id="cb846-2"><a href="visualising-data-with-ggplot2.html#cb846-2" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb846-3"><a href="visualising-data-with-ggplot2.html#cb846-3" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;scatter.png&quot;</span>,</span>
<span id="cb846-4"><a href="visualising-data-with-ggplot2.html#cb846-4" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">5</span>,</span>
<span id="cb846-5"><a href="visualising-data-with-ggplot2.html#cb846-5" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">3</span>,</span>
<span id="cb846-6"><a href="visualising-data-with-ggplot2.html#cb846-6" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">&quot;in&quot;</span>,</span>
<span id="cb846-7"><a href="visualising-data-with-ggplot2.html#cb846-7" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb846-8"><a href="visualising-data-with-ggplot2.html#cb846-8" tabindex="-1"></a>)</span>
<span id="cb846-9"><a href="visualising-data-with-ggplot2.html#cb846-9" tabindex="-1"></a><span class="co"># Prints a ggplot2 in it</span></span>
<span id="cb846-10"><a href="visualising-data-with-ggplot2.html#cb846-10" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb846-11"><a href="visualising-data-with-ggplot2.html#cb846-11" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb846-12"><a href="visualising-data-with-ggplot2.html#cb846-12" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">5</span>,</span>
<span id="cb846-13"><a href="visualising-data-with-ggplot2.html#cb846-13" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">3</span>,</span>
<span id="cb846-14"><a href="visualising-data-with-ggplot2.html#cb846-14" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;seagreen&quot;</span>)</span>
<span id="cb846-15"><a href="visualising-data-with-ggplot2.html#cb846-15" tabindex="-1"></a><span class="co"># Device is off</span></span>
<span id="cb846-16"><a href="visualising-data-with-ggplot2.html#cb846-16" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="visualising-data-with-ggplot2.html#cb848-1" tabindex="-1"></a><span class="co"># Creates a new PDF file</span></span>
<span id="cb848-2"><a href="visualising-data-with-ggplot2.html#cb848-2" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;two_page.pdf&quot;</span>,</span>
<span id="cb848-3"><a href="visualising-data-with-ggplot2.html#cb848-3" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">6</span>,</span>
<span id="cb848-4"><a href="visualising-data-with-ggplot2.html#cb848-4" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb848-5"><a href="visualising-data-with-ggplot2.html#cb848-5" tabindex="-1"></a><span class="co">#first plot</span></span>
<span id="cb848-6"><a href="visualising-data-with-ggplot2.html#cb848-6" tabindex="-1"></a><span class="fu">plot</span>(mtcars<span class="sc">$</span>wt, mtcars<span class="sc">$</span>mpg)</span>
<span id="cb848-7"><a href="visualising-data-with-ggplot2.html#cb848-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">5</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb848-8"><a href="visualising-data-with-ggplot2.html#cb848-8" tabindex="-1"></a><span class="co"># Second Plot</span></span>
<span id="cb848-9"><a href="visualising-data-with-ggplot2.html#cb848-9" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb848-10"><a href="visualising-data-with-ggplot2.html#cb848-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb848-11"><a href="visualising-data-with-ggplot2.html#cb848-11" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">5</span>,</span>
<span id="cb848-12"><a href="visualising-data-with-ggplot2.html#cb848-12" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">3</span>,</span>
<span id="cb848-13"><a href="visualising-data-with-ggplot2.html#cb848-13" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;seagreen&quot;</span>)</span>
<span id="cb848-14"><a href="visualising-data-with-ggplot2.html#cb848-14" tabindex="-1"></a><span class="co"># Device Off</span></span>
<span id="cb848-15"><a href="visualising-data-with-ggplot2.html#cb848-15" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
<hr />

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="15">
<li id="fn15"><p><a href="https://ggplot2.tidyverse.org/" class="uri">https://ggplot2.tidyverse.org/</a><a href="visualising-data-with-ggplot2.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>Hadley Wickham et al., <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>, 2024, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.<a href="visualising-data-with-ggplot2.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p><a href="https://link.springer.com/book/10.1007/0-387-28695-0" class="uri">https://link.springer.com/book/10.1007/0-387-28695-0</a><a href="visualising-data-with-ggplot2.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p><a href="http://vita.had.co.nz/papers/layered-grammar.pdf" class="uri">http://vita.had.co.nz/papers/layered-grammar.pdf</a><a href="visualising-data-with-ggplot2.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Hadley Wickham, <span>“A Layered Grammar of Graphics,”</span> <em>Journal of Computational and Graphical Statistics</em> 19, no. 1 (2010): 3–28, <a href="https://doi.org/10.1198/jcgs.2009.07098">https://doi.org/10.1198/jcgs.2009.07098</a>.<a href="visualising-data-with-ggplot2.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>Version 3.3.0 was released in March 2020<a href="visualising-data-with-ggplot2.html#fnref20" class="footnote-back">↩︎</a></p></li>
<li id="fn21"><p>Source: Hadley Wickham’s paper on <em>the layered grammar of graphics</em><a href="visualising-data-with-ggplot2.html#fnref21" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Audit Analytics</strong>" was written by Anil Goyal. It was last built on 2024-11-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
