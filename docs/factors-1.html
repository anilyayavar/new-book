<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 31 Factors | R for Audit Analytics</title>
<meta name="author" content="Anil Goyal">
<meta name="description" content="We often have a requirement, where we need to have our character variable representing categorical data that should take values from a fixed and known set of finite values (or categories)....">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="Chapter 31 Factors | R for Audit Analytics">
<meta property="og:type" content="book">
<meta property="og:url" content="https://anilyayavar.github.io/new-book/factors-1.html">
<meta property="og:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg">
<meta property="og:description" content="We often have a requirement, where we need to have our character variable representing categorical data that should take values from a fixed and known set of finite values (or categories)....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 31 Factors | R for Audit Analytics">
<meta name="twitter:description" content="We often have a requirement, where we need to have our character variable representing categorical data that should take values from a fixed and known set of finite values (or categories)....">
<meta name="twitter:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Audit Analytics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to R for Audit Analytics</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="about-author.html">About author</a></li>
<li><a class="" href="gearing-up.html">Gearing up</a></li>
<li><a class="" href="part-i-basic-r-programming-concepts.html">Part-I: Basic R Programming Concepts</a></li>
<li><a class="" href="r-programming-language.html"><span class="header-section-number">1</span> R Programming Language</a></li>
<li><a class="" href="subset.html"><span class="header-section-number">2</span> Subsetting R objects or accesing specific elements</a></li>
<li><a class="" href="func.html"><span class="header-section-number">3</span> Functions and operations in R</a></li>
<li><a class="" href="existing-and-useful-functions-in-base-r.html"><span class="header-section-number">4</span> Existing and useful functions in base R</a></li>
<li><a class="" href="pipes-in-r.html"><span class="header-section-number">5</span> Pipes in R</a></li>
<li><a class="" href="control-statements.html"><span class="header-section-number">6</span> Control statements</a></li>
<li><a class="" href="functional-programming.html"><span class="header-section-number">7</span> Functional Programming</a></li>
<li><a class="" href="file.html"><span class="header-section-number">8</span> File handling operations in R</a></li>
<li><a class="" href="read.html"><span class="header-section-number">9</span> Getting data in and out of R</a></li>
<li><a class="" href="data-cleaning-in-r.html"><span class="header-section-number">10</span> Data Cleaning in R</a></li>
<li><a class="" href="merging-large-number-of-similar-datasets-into-one.html"><span class="header-section-number">11</span> Merging large number of similar datasets into one</a></li>
<li><a class="" href="part-ii-exploratory-data-analysis.html">Part-II: Exploratory Data Analysis</a></li>
<li><a class="" href="visualisations-in-base-r.html"><span class="header-section-number">12</span> Visualisations in Base R</a></li>
<li><a class="" href="visualising-data-with-ggplot2.html"><span class="header-section-number">13</span> Visualising data with ggplot2</a></li>
<li><a class="" href="data-transformation-in-dplyr.html"><span class="header-section-number">14</span> Data Transformation in dplyr</a></li>
<li><a class="" href="combining-tablestabular-data.html"><span class="header-section-number">15</span> Combining Tables/tabular data</a></li>
<li><a class="" href="data-wrangling-in-tidyr.html"><span class="header-section-number">16</span> Data Wrangling in tidyr</a></li>
<li><a class="" href="generating-descriptive-statistics.html"><span class="header-section-number">17</span> Generating Descriptive statistics</a></li>
<li><a class="" href="part-iii-probability-and-sampling-in-r.html">Part-III: Probability and Sampling in R</a></li>
<li><a class="" href="probability-in-r.html"><span class="header-section-number">18</span> Probability in R</a></li>
<li><a class="" href="random-sampling-in-r.html"><span class="header-section-number">19</span> Random sampling in R</a></li>
<li><a class="" href="part-iv-machine-learning-in-r.html">Part-IV: Machine Learning in R</a></li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">20</span> Linear Regression</a></li>
<li><a class="" href="principal-component-analysis-in-r.html"><span class="header-section-number">21</span> Principal Component Analysis in R</a></li>
<li><a class="" href="clustering-in-r-using-kmeans-algorithm.html"><span class="header-section-number">22</span> Clustering in R (Using Kmeans algorithm)</a></li>
<li><a class="" href="association-rule-mining-in-r-apriori.html"><span class="header-section-number">23</span> Association Rule Mining in R (Apriori)</a></li>
<li><a class="" href="part-v-time-series.html">Part-V: Time Series</a></li>
<li><a class="" href="date-and-time-calculations.html"><span class="header-section-number">24</span> Date and Time calculations</a></li>
<li><a class="" href="time-series-analysis.html"><span class="header-section-number">25</span> Time Series Analysis</a></li>
<li><a class="" href="part-vi-network-analytics.html">Part VI: Network Analytics</a></li>
<li><a class="" href="network-analyticsgraph-theory-in-r.html"><span class="header-section-number">26</span> Network Analytics/Graph theory in R</a></li>
<li><a class="" href="applying-network-analysis-in-auditfraud-detection.html"><span class="header-section-number">27</span> Applying network analysis in audit/fraud detection</a></li>
<li><a class="" href="part-vii-text-analytics-in-r.html">Part-VII: Text Analytics in R</a></li>
<li><a class="" href="string-manipulation-in-stringr.html"><span class="header-section-number">28</span> String manipulation in stringr</a></li>
<li><a class="" href="regex---a-quick-introduction.html"><span class="header-section-number">29</span> Regex - A quick introduction</a></li>
<li><a class="" href="regex-in-human-readble-format-using-rebus.html"><span class="header-section-number">30</span> Regex in human readble format using rebus</a></li>
<li><a class="active" href="factors-1.html"><span class="header-section-number">31</span> Factors</a></li>
<li><a class="" href="text-analytics-in-r.html"><span class="header-section-number">32</span> Text Analytics in R</a></li>
<li><a class="" href="sentiment-analysis.html"><span class="header-section-number">33</span> Sentiment Analysis</a></li>
<li><a class="" href="visualising-text-analytics-through-wordcloud-etc..html"><span class="header-section-number">34</span> Visualising Text analytics through Wordcloud, etc.</a></li>
<li><a class="" href="finding-string-similarity.html"><span class="header-section-number">35</span> Finding string similarity</a></li>
<li><a class="" href="part-viii-geo-computation-in-r.html">Part-VIII: Geo computation in R</a></li>
<li><a class="" href="maps-in-r.html"><span class="header-section-number">36</span> Maps in R</a></li>
<li><a class="" href="geo-coding-in-r.html"><span class="header-section-number">37</span> Geo-Coding in R</a></li>
<li><a class="" href="reverse-geo-coding.html"><span class="header-section-number">38</span> Reverse geo-coding</a></li>
<li><a class="" href="part-ix-identifying-anamolous-observations-for-audit.html">Part-IX: Identifying anamolous observations for audit</a></li>
<li><a class="" href="benford-testsanalysis.html"><span class="header-section-number">39</span> Benford Tests/Analysis</a></li>
<li><a class="" href="anomaly-detection.html"><span class="header-section-number">40</span> Anomaly Detection</a></li>
<li><a class="" href="finding-anamolous-outliers.html"><span class="header-section-number">41</span> Finding Anamolous Outliers</a></li>
<li><a class="" href="dup.html"><span class="header-section-number">42</span> Duplicate Detection</a></li>
<li><a class="" href="detecting-gaps-in-sequences.html"><span class="header-section-number">43</span> Detecting gaps in sequences</a></li>
<li><a class="" href="data-envelopment-analysis.html"><span class="header-section-number">44</span> Data Envelopment Analysis</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="colors-in-r.html"><span class="header-section-number">A</span> Colors in R</a></li>
<li><a class="" href="various-datasets-in-base-r-used-in-this-book.html"><span class="header-section-number">B</span> Various Datasets, in base R, used in this book</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="factors-1" class="section level1" number="31">
<h1>
<span class="header-section-number">31</span> Factors<a class="anchor" aria-label="anchor" href="#factors-1"><i class="fas fa-link"></i></a>
</h1>
<p>We often have a requirement, where we need to have our character variable representing categorical data that should take values from a fixed and known set of finite values (or categories). Additionally sometimes these categories need to be sorted in a specific order which may not be alphabetical. Categorical data like this plays an important role in data analytics.</p>
<p>To deal with such categorical data, we have a special class <code>factor</code> in R. In data analytical tasks we often need to create use factors, so let us discuss about these in a bit detail.</p>
<div id="factors-in-base-r" class="section level2" number="31.1">
<h2>
<span class="header-section-number">31.1</span> Factors in base R<a class="anchor" aria-label="anchor" href="#factors-in-base-r"><i class="fas fa-link"></i></a>
</h2>
<p>Factors in R are objects built over atomic data-type <code>integer</code>. We have two primary functions to create (and coerce) factors from character vectors.</p>
<ul>
<li><code>factor</code></li>
<li><code><a href="https://rdrr.io/r/base/factor.html">as.factor()</a></code></li>
</ul>
<p>Of these, <code>factor</code> provides us with full customisation as it is the basic function to create factor objects in base R. Let us discuss both.</p>
<div id="creating-factors-from-scratch" class="section level3" number="31.1.1">
<h3>
<span class="header-section-number">31.1.1</span> Creating factors from scratch<a class="anchor" aria-label="anchor" href="#creating-factors-from-scratch"><i class="fas fa-link"></i></a>
</h3>
<p>Now, let us create factor from a character vector having values from <code>shirt_sizes</code>.</p>
<div class="sourceCode" id="cb1906"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shirt_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"M"</span>, <span class="st">"L"</span>, <span class="st">"XL"</span>, <span class="st">"XXL"</span><span class="op">)</span></span></code></pre></div>
<p>Let us say, we have 10 shirts from these sizes randomly.</p>
<div class="sourceCode" id="cb1907"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 10 shirts with following sizes</span></span>
<span><span class="co"># Notice one shirt with size small case l and one XXXL</span></span>
<span><span class="va">shirts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"s"</span>, <span class="st">"L"</span>, <span class="st">"XL"</span>, <span class="st">"XXXL"</span>, <span class="st">"S"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"L"</span>, <span class="st">"L"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let us create a factor of shirt_sizes</span></span>
<span><span class="va">shirt_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">shirts</span>, levels <span class="op">=</span> <span class="va">shirt_sizes</span><span class="op">)</span></span>
<span><span class="va">shirt_f</span></span></code></pre></div>
<pre><code>##  [1] S    &lt;NA&gt; L    XL   &lt;NA&gt; S    M    M    L    L   
## Levels: S M L XL XXL</code></pre>
<p>In the output above we get <code>NA</code>s silently in place of values that were not available in our allowed values (read levels).</p>
<p>Now check its type and class.</p>
<div class="sourceCode" id="cb1909"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">shirt_f</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "integer"</code></pre>
<div class="sourceCode" id="cb1911"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">shirt_f</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "factor"</code></pre>
<p>We can see that <code>factor</code> class is actually built upon the <code>integer</code> class underneath and labels (taking values from levels by default) shown in the output.</p>
<div class="sourceCode" id="cb1913"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">shirt_f</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1]  1 NA  3  4 NA  1  2  2  3  3
## attr(,"levels")
## [1] "S"   "M"   "L"   "XL"  "XXL"</code></pre>
<p>We can, however, modify labels without modifying the levels by providing values (in a vector) to the <code>labels</code> argument. Let us now create another factor with labels different than levels.</p>
<div class="sourceCode" id="cb1915"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># 100 Shirts</span></span>
<span><span class="va">shirts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">shirt_sizes</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">shirts2_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">shirts2</span>, levels <span class="op">=</span> <span class="va">shirt_sizes</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>, <span class="st">"Extra Large"</span>, <span class="st">"Extra Extra large"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Let's view some shirts</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">shirts2_f</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] Large             Large             Medium            Medium           
## [5] Large             Extra Extra large
## Levels: Small Medium Large Extra Large Extra Extra large</code></pre>
<div class="sourceCode" id="cb1917"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check its levels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">shirts2_f</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Small"             "Medium"            "Large"            
## [4] "Extra Large"       "Extra Extra large"</code></pre>
<p>Function <code>summary</code> gives us count for each level in the given factor.</p>
<div class="sourceCode" id="cb1919"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">shirts2_f</span><span class="op">)</span></span></code></pre></div>
<pre><code>##             Small            Medium             Large       Extra Large 
##                21                20                23                17 
## Extra Extra large 
##                19</code></pre>
</div>
<div id="coercing-objects-to-factor" class="section level3" number="31.1.2">
<h3>
<span class="header-section-number">31.1.2</span> Coercing objects to factor<a class="anchor" aria-label="anchor" href="#coercing-objects-to-factor"><i class="fas fa-link"></i></a>
</h3>
<p>Up to now, we created a factor from set of allowable finite values (read <code>levels</code>) and displayed them using meaningful <code>labels</code>. Function <code><a href="https://rdrr.io/r/base/factor.html">is.factor()</a></code> will check whether the given vector is a factor or not. On the other hand, function <code>as.factor</code> will coerce the existing character vector to a factor variable by using all the distinct values available therein as levels, but sorted alphabetically.</p>
<div class="sourceCode" id="cb1921"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb1923"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shirts2_coerced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">shirts2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">shirts2_coerced</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] L   L   M   M   L   XXL
## Levels: L M S XL XXL</code></pre>
<div class="sourceCode" id="cb1925"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">shirts2_coerced</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "L"   "M"   "S"   "XL"  "XXL"</code></pre>
<div class="sourceCode" id="cb1927"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check summary too</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">shirts2_coerced</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   L   M   S  XL XXL 
##  23  20  21  17  19</code></pre>
<p>This problem was not there in our earlier factor created from scratch, because there it took levels from the provided vector which we sorted meaningfully ourselves, and thus having more control.</p>
</div>
<div id="ordfact" class="section level3" number="31.1.3">
<h3>
<span class="header-section-number">31.1.3</span> Order in factors<a class="anchor" aria-label="anchor" href="#ordfact"><i class="fas fa-link"></i></a>
</h3>
<p>To sort the factors in a meaningful way, we can actually create ordered factor. Ordered factor can be created either by</p>
<ul>
<li>using <code>ordered = TRUE</code> argument in function <code>factor</code>; or by</li>
<li>coercing a given factor to an ordered factor using function <code><a href="https://rdrr.io/r/base/factor.html">ordered()</a></code>.</li>
</ul>
<p>Clearly, latter method will again order the given factor as per the levels present in the factor.</p>
<div class="sourceCode" id="cb1929"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shirts2_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>  <span class="va">shirts2</span>,</span>
<span>  levels <span class="op">=</span> <span class="va">shirt_sizes</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>, </span>
<span>             <span class="st">"Extra Large"</span>, <span class="st">"Extra Extra large"</span><span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Ordering a factor in R has another benefit, we can actually perform calculations on the ordered factor.
Suppose if we want to find how many shirts do we have of sizes “Large” or greater.</p>
<div class="sourceCode" id="cb1930"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How many shirts are there of sizes L or greater?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">shirts2_ordered</span> <span class="op">&gt;=</span> <span class="st">"Large"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 59</code></pre>
<div class="sourceCode" id="cb1932"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># But unordered factor will result in error.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">shirts2_f</span> <span class="op">&gt;=</span> <span class="st">"Large"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>We can check the given factor is an ordered factor or not using function <code><a href="https://rdrr.io/r/base/factor.html">is.ordered()</a></code>. E.g.</p>
<div class="sourceCode" id="cb1934"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">is.ordered</a></span><span class="op">(</span><span class="va">shirts2_ordered</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb1936"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">is.ordered</a></span><span class="op">(</span><span class="va">shirts2_f</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
</div>
<div id="factors-in-forcats" class="section level2" number="31.2">
<h2>
<span class="header-section-number">31.2</span> Factors in <code>forcats</code><a class="anchor" aria-label="anchor" href="#factors-in-forcats"><i class="fas fa-link"></i></a>
</h2>
<p>Package <code>forcats</code> which is part of core tidyverse provides us with more robust and useful ways to create and deal with factor variables. In <code>forcats</code> we have function <code>fct</code> for creating factor variables. It will produce errors if any value is not available in the given levels, to avoid bugs/typographical errors in the code. E.g.</p>
<div class="sourceCode" id="cb1938"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/">forcats</a></span><span class="op">)</span></span>
<span><span class="va">months_31</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Jan"</span>, <span class="st">"Mar"</span>, <span class="st">"May"</span>, <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Oxt"</span>, <span class="st">"Dec"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct.html">fct</a></span><span class="op">(</span><span class="va">months_31</span>, levels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Error in `fct()`:
## ! All values of `x` must appear in `levels` or `na`
## ℹ Missing level: "Oxt"</code></pre>
</div>
<div id="inspecting-factors" class="section level2" number="31.3">
<h2>
<span class="header-section-number">31.3</span> Inspecting Factors<a class="anchor" aria-label="anchor" href="#inspecting-factors"><i class="fas fa-link"></i></a>
</h2>
<div id="summarising-factors" class="section level3" number="31.3.1">
<h3>
<span class="header-section-number">31.3.1</span> Summarising factors<a class="anchor" aria-label="anchor" href="#summarising-factors"><i class="fas fa-link"></i></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method works well to give the counts for each level.</p>
<div class="sourceCode" id="cb1940"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shirts2_fct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct.html">fct</a></span><span class="op">(</span><span class="va">shirts2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">shirts2_fct</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   L   M XXL  XL   S 
##  23  20  19  17  21</code></pre>
<p>Like <code>count</code> in <code>dplyr</code>, here we have <code><a href="https://forcats.tidyverse.org/reference/fct_count.html">fct_count()</a></code> to give us level wise counts and/or proportions. The difference from <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> is however in output type. Function <code><a href="https://forcats.tidyverse.org/reference/fct_count.html">fct_count()</a></code> returns a <code>tibble</code> instead. E.g.</p>
<div class="sourceCode" id="cb1942"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_count.html">fct_count</a></span><span class="op">(</span><span class="va">shirts2_fct</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   f         n
##   &lt;fct&gt; &lt;int&gt;
## 1 L        23
## 2 M        20
## 3 XXL      19
## 4 XL       17
## 5 S        21</code></pre>
<div class="sourceCode" id="cb1944"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sort in decreasing counts</span></span>
<span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_count.html">fct_count</a></span><span class="op">(</span><span class="va">shirts2_fct</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   f         n
##   &lt;fct&gt; &lt;int&gt;
## 1 L        23
## 2 S        21
## 3 M        20
## 4 XXL      19
## 5 XL       17</code></pre>
<div class="sourceCode" id="cb1946"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Include proportions also</span></span>
<span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_count.html">fct_count</a></span><span class="op">(</span><span class="va">shirts2_fct</span>, sort <span class="op">=</span> <span class="cn">TRUE</span>, prop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   f         n     p
##   &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;
## 1 L        23  0.23
## 2 S        21  0.21
## 3 M        20  0.2 
## 4 XXL      19  0.19
## 5 XL       17  0.17</code></pre>
</div>
<div id="unique-levels-only" class="section level3" number="31.3.2">
<h3>
<span class="header-section-number">31.3.2</span> Unique levels only<a class="anchor" aria-label="anchor" href="#unique-levels-only"><i class="fas fa-link"></i></a>
</h3>
<p>Function <code><a href="https://forcats.tidyverse.org/reference/fct_unique.html">fct_unique()</a></code> from the package, returns a factor with unique values, removing duplicates. E.g.</p>
<div class="sourceCode" id="cb1948"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_unique.html">fct_unique</a></span><span class="op">(</span><span class="va">shirts2_fct</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] L   M   XXL XL  S  
## Levels: L M XXL XL S</code></pre>
</div>
</div>
<div id="order-in-factors" class="section level2" number="31.4">
<h2>
<span class="header-section-number">31.4</span> Order in Factors<a class="anchor" aria-label="anchor" href="#order-in-factors"><i class="fas fa-link"></i></a>
</h2>
<div id="default-ordering-in-factors" class="section level3" number="31.4.1">
<h3>
<span class="header-section-number">31.4.1</span> Default ordering in factors<a class="anchor" aria-label="anchor" href="#default-ordering-in-factors"><i class="fas fa-link"></i></a>
</h3>
<p>Orders created in factor variables using <code>fct</code> are sorted as per the levels given in the level argument. If the argument is not supplied then it is sorted on the basis of first appearance (as against alphabetically in the <code>factor</code>), as we observed in output of above example.</p>
<p>To learn more functions from <code>forcats</code> we will use <code>gss_cat</code> data frame which is part of the <code>forcats</code> package itself and GSS here stands for General Social Survey. It actually consists of many factor variables. For some other use cases, we will also use <code>economics_long</code> data which is part of <code>tidyr</code> package.</p>
</div>
<div id="reordering-factors" class="section level3" number="31.4.2">
<h3>
<span class="header-section-number">31.4.2</span> Reordering factors<a class="anchor" aria-label="anchor" href="#reordering-factors"><i class="fas fa-link"></i></a>
</h3>
<p>If we analyse the (mean) number of hours spent per day on TV watching across different religions in <code>gss_cat</code>, we can see that -</p>
<div class="sourceCode" id="cb1950"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">gss_cat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>tv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">tvhours</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">relig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">relig</span>, <span class="va">tv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reord"></span>
<img src="DauR_files/figure-html/reord-1.png" alt="Factors with default order" width="672"><p class="caption">
Figure 31.1: Factors with default order
</p>
</div>
<p>In above case (<a href="factors-1.html#fig:reord">31.1</a>), the order of <code>relig</code> factor is meaningful when sorted on the basis of summarised values of another numerical variable present in the data. Function <code>fct_reorder</code> is helpful in these scenarios.</p>
<pre><code>fct_reorder(
  .f,
  .x,
  .fun = median,
  ...,
  .na_rm = NULL,
  .default = Inf,
  .desc = FALSE
)</code></pre>
<p>Where -</p>
<ul>
<li>
<code>.f</code> is the factor variable to be sorted.</li>
<li>
<code>.x</code> is the numerical variable based on which <code>.f</code> is to be sorted.</li>
<li>
<code>.fun</code> is the optional function (default is <code>median</code>) to be used when there are multiple values of .x for any of the level in <code>.f</code>.</li>
</ul>
<p>So, in above example, we can re-order the levels using this function. See figure <a href="factors-1.html#fig:reord2">31.2</a> -</p>
<div class="sourceCode" id="cb1952"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_cat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>tv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">tvhours</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">relig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">relig</span>, <span class="va">tv</span><span class="op">)</span>, <span class="va">tv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Religion"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reord2"></span>
<img src="DauR_files/figure-html/reord2-1.png" alt="Factors with reordered levels" width="672"><p class="caption">
Figure 31.2: Factors with reordered levels
</p>
</div>
<p>This function is also useful in sorting box-plots. As an example refer Figure <a href="factors-1.html#fig:reord3">31.3</a>.</p>
<div class="sourceCode" id="cb1953"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">economics_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value01</span>, y <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Unsorted Boxes"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reord3"></span>
<img src="DauR_files/figure-html/reord3-1.png" alt="Unsorted boxes with unordered levels" width="672"><p class="caption">
Figure 31.3: Unsorted boxes with unordered levels
</p>
</div>
<div class="sourceCode" id="cb1954"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">economics_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">value01</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value01</span>, y <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Boxes sorted on Median"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reord4"></span>
<img src="DauR_files/figure-html/reord4-1.png" alt="Boxes sorted on Median reordering factor levels" width="672"><p class="caption">
Figure 31.4: Boxes sorted on Median reordering factor levels
</p>
</div>
</div>
<div id="reordering-factors-with-two-other-variables." class="section level3" number="31.4.3">
<h3>
<span class="header-section-number">31.4.3</span> Reordering factors with two other variables.<a class="anchor" aria-label="anchor" href="#reordering-factors-with-two-other-variables."><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes, a factor variable needs to be sorted on the basis of first (or last) values of two other variables. In such <code><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder2()</a></code> is useful. As compared to <code><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder()</a></code> it takes an extra argument <code>.y</code> and is having syntax like</p>
<pre><code>fct_reorder2(
  .f,
  .x,
  .y,
  .fun = last2,
  ...,
  .na_rm = NULL,
  .default = -Inf,
  .desc = TRUE
)</code></pre>
<p>Here default function is <code>last2</code> which simply means that levels of <code>.f</code> are sorted on the basis of last values of <code>.y</code> when plotted against <code>.x</code> as in grouped line charts. E.g. See Figure <a href="factors-1.html#fig:reord5">31.5</a>.</p>
<div class="sourceCode" id="cb1956"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://conflicted.r-lib.org/">conflicted</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://conflicted.r-lib.org/reference/conflicts_prefer.html">conflicts_prefer</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">default</span> <span class="op">&lt;-</span> <span class="va">economics_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&lt;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="st">"31122003"</span><span class="op">)</span>, <span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="st">"01011995"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">value01</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">variable</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Default legend"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">aligned</span> <span class="op">&lt;-</span> <span class="va">economics_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&lt;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="st">"31122003"</span><span class="op">)</span>, <span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="st">"01011995"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder2</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">date</span>, <span class="va">value01</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">value01</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">variable</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Legend aligned with \nlast values of each line"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">default</span> <span class="op">+</span> <span class="va">aligned</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reord5"></span>
<img src="DauR_files/figure-html/reord5-1.png" alt="Factors reordered on two criteria" width="672"><p class="caption">
Figure 31.5: Factors reordered on two criteria
</p>
</div>
</div>
<div id="changing-orders-of-few-factor-labels-only" class="section level3" number="31.4.4">
<h3>
<span class="header-section-number">31.4.4</span> Changing orders of few factor labels only<a class="anchor" aria-label="anchor" href="#changing-orders-of-few-factor-labels-only"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes, we may have a factor whose levels are already meaningfully sorted. E.g. income levels in <code>gss_cat</code>. Check the plot in Figure <a href="factors-1.html#fig:reord6">31.6</a>.</p>
<div class="sourceCode" id="cb1957"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_cat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">rincome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reord6"></span>
<img src="DauR_files/figure-html/reord6-1.png" alt="Default Income levels" width="672"><p class="caption">
Figure 31.6: Default Income levels
</p>
</div>
<p>The levels of income are already sorted in a meaningful way. However, sometimes we may want to change order of a few levels only. E.g. <code>Not applicable</code> in the Figure <a href="factors-1.html#fig:reord6">31.6</a> which if re-leveled in the end may be more meaningful. In such cases, we may use <code>fct_relevel</code>. The function takes a factor variable and thereafter we may pass all those levels as arguments which we want to move in the end. After rearranging the bars (levels), the plot will look like as in Figure <a href="factors-1.html#fig:reord7">31.7</a></p>
<div class="sourceCode" id="cb1958"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_cat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">rincome</span>, <span class="st">"Not applicable"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span> <span class="st">"Income levels"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reord7"></span>
<img src="DauR_files/figure-html/reord7-1.png" alt="Modifying levels manually" width="672"><p class="caption">
Figure 31.7: Modifying levels manually
</p>
</div>
</div>
<div id="infreq" class="section level3" number="31.4.5">
<h3>
<span class="header-section-number">31.4.5</span> Ordering bar charts in order of frequency<a class="anchor" aria-label="anchor" href="#infreq"><i class="fas fa-link"></i></a>
</h3>
<p>Function <code><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq()</a></code> is helpful in sorting the factor in decreasing order of frequency and thus, can be used to sort the bar charts (Refer charts in Figure <a href="factors-1.html#fig:fct16">31.8</a>).</p>
<div class="sourceCode" id="cb1959"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default</span> <span class="op">&lt;-</span> <span class="va">mpg</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">trans</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">increasing</span> <span class="op">&lt;-</span> <span class="va">mpg</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">trans</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">default</span> <span class="op">+</span> <span class="va">increasing</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fct16"></span>
<img src="DauR_files/figure-html/fct16-1.png" alt="Default and increasing order by Frequency" width="672"><p class="caption">
Figure 31.8: Default and increasing order by Frequency
</p>
</div>
</div>
<div id="reversing-the-factor-levels" class="section level3" number="31.4.6">
<h3>
<span class="header-section-number">31.4.6</span> Reversing the factor levels<a class="anchor" aria-label="anchor" href="#reversing-the-factor-levels"><i class="fas fa-link"></i></a>
</h3>
<p>Using <code><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev()</a></code> we can reverse the order of levels in any factor. E.g. Figure <a href="factors-1.html#fig:reord8">31.9</a>.</p>
<div class="sourceCode" id="cb1960"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mpg</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">trans</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">trans</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reord8"></span>
<img src="DauR_files/figure-html/reord8-1.png" alt="Reversing levels" width="672"><p class="caption">
Figure 31.9: Reversing levels
</p>
</div>
</div>
<div id="other-reordering" class="section level3" number="31.4.7">
<h3>
<span class="header-section-number">31.4.7</span> Other reordering<a class="anchor" aria-label="anchor" href="#other-reordering"><i class="fas fa-link"></i></a>
</h3>
<p>There are two more functions which can be used to reorder factor levels -</p>
<ul>
<li>
<code><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_inorder()</a></code>: by the order in which they first appear.</li>
<li>
<code><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_inseq()</a></code>: by numeric value of level.</li>
</ul>
<p>Readers may explore these functions by themselves.</p>
</div>
<div id="more-on-ordering-factors" class="section level3" number="31.4.8">
<h3>
<span class="header-section-number">31.4.8</span> More on ordering factors<a class="anchor" aria-label="anchor" href="#more-on-ordering-factors"><i class="fas fa-link"></i></a>
</h3>
<p>In section <a href="factors-1.html#ordfact">31.1.3</a> we saw how an unordered factor can be turned into an ordered factor. This ordering can cause one side effect while plotting in ggplot2. Ordered factor use <code>scale_color_viridis</code> by default whereas unordered factor doesn’t. See following example (Notice how the color scale has been Figure <a href="factors-1.html#fig:moreord">31.10</a> to Figure <a href="factors-1.html#fig:moreord2">31.11</a>).</p>
<div class="sourceCode" id="cb1961"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cyl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Ordered Factor"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:moreord"></span>
<img src="DauR_files/figure-html/moreord-1.png" alt="Use of color scale in ordered and unordered factors" width="672"><p class="caption">
Figure 31.10: Use of color scale in ordered and unordered factors
</p>
</div>
<div class="sourceCode" id="cb1962"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cyl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Unordered Factor"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:moreord2"></span>
<img src="DauR_files/figure-html/moreord2-1.png" alt="Use of color scale in ordered and unordered factors" width="672"><p class="caption">
Figure 31.11: Use of color scale in ordered and unordered factors
</p>
</div>
</div>
</div>
<div id="levels-in-factors" class="section level2" number="31.5">
<h2>
<span class="header-section-number">31.5</span> Levels in Factors<a class="anchor" aria-label="anchor" href="#levels-in-factors"><i class="fas fa-link"></i></a>
</h2>
<div id="modifying-factor-levels-by-applying-a-function" class="section level3" number="31.5.1">
<h3>
<span class="header-section-number">31.5.1</span> Modifying factor levels by applying a function<a class="anchor" aria-label="anchor" href="#modifying-factor-levels-by-applying-a-function"><i class="fas fa-link"></i></a>
</h3>
<p>Function <code>fct_relabel</code> in <code>forcats</code> powerhouse applies a function <code>.fun</code> to each of the level in <code>.f</code> factor supplied to it. E.g. Change the case of each of the variable name in <code>economics_long</code> (Figure <a href="factors-1.html#fig:reord9">31.12</a>).</p>
<div class="sourceCode" id="cb1963"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">economics_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relabel.html">fct_relabel</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">str_to_upper</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value01</span>, y <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reord9"></span>
<img src="DauR_files/figure-html/reord9-1.png" alt="Applying a function to all labels" width="672"><p class="caption">
Figure 31.12: Applying a function to all labels
</p>
</div>
</div>
<div id="modifying-factor-levels-manually" class="section level3" number="31.5.2">
<h3>
<span class="header-section-number">31.5.2</span> Modifying factor levels manually<a class="anchor" aria-label="anchor" href="#modifying-factor-levels-manually"><i class="fas fa-link"></i></a>
</h3>
<p>Using function <code><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode()</a></code> we can change the levels from the given factor manually. We have to provide new levels manually through a sequence of named character vectors where the name gives the new level, and the value gives the old level. Levels not otherwise mentioned will be left as is. Levels can be removed by naming them <code>NULL</code>. See Example</p>
<div class="sourceCode" id="cb1964"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"apple"</span>, <span class="st">"bear"</span>, <span class="st">"banana"</span>, <span class="st">"dear"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">x</span>, fruit <span class="op">=</span> <span class="st">"apple"</span>, fruit <span class="op">=</span> <span class="st">"banana"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] fruit bear  fruit dear 
## Levels: fruit bear dear</code></pre>
<p>To collapse multiple levels (lumping) into one we can use its cousin <code><a href="https://forcats.tidyverse.org/reference/fct_collapse.html">fct_collapse()</a></code>. Example</p>
<div class="sourceCode" id="cb1966"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"apple"</span>, <span class="st">"bear"</span>, <span class="st">"banana"</span>, <span class="st">"dear"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_collapse.html">fct_collapse</a></span><span class="op">(</span><span class="va">x</span>, fruit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"apple"</span>, <span class="st">"banana"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] fruit bear  fruit dear 
## Levels: fruit bear dear</code></pre>
</div>
<div id="lump-uncommon-factor-levels-into-other" class="section level3" number="31.5.3">
<h3>
<span class="header-section-number">31.5.3</span> Lump uncommon factor levels into <code>other</code><a class="anchor" aria-label="anchor" href="#lump-uncommon-factor-levels-into-other"><i class="fas fa-link"></i></a>
</h3>
<p>Package <code>forcats</code> provides us a family of 4 functions that are useful in lumping together the levels meeting some given criteria. These are</p>
<ul>
<li>
<code><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump_min()</a></code>: lumps levels that appear fewer than min times.</li>
<li>
<code><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump_prop()</a></code>: lumps levels that appear in fewer than (or equal to) <code>prop</code> * <code>n</code> times.</li>
<li>
<code><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump_n()</a></code> lumps all levels except for the n most frequent (or least frequent if <code>n</code> &lt; 0)</li>
<li>
<code><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump_lowfreq()</a></code> lumps together the least frequent levels, ensuring that <code>"other"</code> is still the smallest level.</li>
</ul>
<p>These all functions, apart from taking factors <code>f</code> as argument, also take one or more argument, which fits into the case-</p>
<ul>
<li>
<code>n</code> Positive <code>n</code> preserves the most common <code>n</code> values. Negative <code>n</code> preserves the least common <code>-n</code> values.</li>
<li>
<code>prop</code> Positive <code>prop</code> lumps values which do not appear at least <code>prop</code> of the time. Negative prop lumps values that do not appear at most <code>-prop</code> of the time.</li>
<li>
<code>min</code> Preserve levels that appear at least <code>min</code> number of times.</li>
<li>
<code>w</code> An optional numeric vector giving weights for frequency of each value (not level) in <code>f</code>.</li>
<li>
<code>other_level</code>: Value of level used for <code>"other"</code>(default) values. Always placed at end of levels.</li>
</ul>
<p>Some examples-</p>
<div class="sourceCode" id="cb1968"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We can check the religion in `gss_cat` and followers count</span></span>
<span><span class="va">gss_cat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">relig</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 15 × 2
##    relig                       n
##    &lt;fct&gt;                   &lt;int&gt;
##  1 No answer                  93
##  2 Don't know                 15
##  3 Inter-nondenominational   109
##  4 Native american            23
##  5 Christian                 689
##  6 Orthodox-christian         95
##  7 Moslem/islam              104
##  8 Other eastern              32
##  9 Hinduism                   71
## 10 Buddhism                  147
## 11 Other                     224
## 12 None                     3523
## 13 Jewish                    388
## 14 Catholic                 5124
## 15 Protestant              10846</code></pre>
<div class="sourceCode" id="cb1970"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's restrict these to 5 religions only</span></span>
<span><span class="va">gss_cat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump_n</a></span><span class="op">(</span><span class="va">relig</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fctlump"></span>
<img src="DauR_files/figure-html/fctlump-1.png" alt="Lumping Factors" width="672"><p class="caption">
Figure 31.13: Lumping Factors
</p>
</div>
<p>In Figure <a href="factors-1.html#fig:fctlump">31.13</a> we can see that there are five religions plus <code>"other"</code> category placed in last. We may also notice that bars are not sorted yet.</p>
<p>We may also make use of <code>w</code> argument, if we already have our factor and its counts of levels in another vector. See figure <a href="factors-1.html#fig:fctlump2">31.14</a> -</p>
<div class="sourceCode" id="cb1971"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_cat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">relig</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Making use of `w` argument</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>relig <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump_n</a></span><span class="op">(</span><span class="va">relig</span>, n <span class="op">=</span> <span class="fl">5</span>, w <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">relig</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fctlump2"></span>
<img src="DauR_files/figure-html/fctlump2-1.png" alt="Lumping Factors by making use of w argument" width="672"><p class="caption">
Figure 31.14: Lumping Factors by making use of w argument
</p>
</div>
<p>To sort the levels in increasing order of frequency we can use <code><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq()</a></code> function which we learnt in section <a href="factors-1.html#infreq">31.4.5</a>. It may also take <code>w</code> argument (optionally, of course) if we have our factor levels already counted. So, to sort the levels in Figure <a href="factors-1.html#fig:fctlump2">31.14</a>, we may make use of this function one step before lumping. See figure <a href="factors-1.html#fig:fctlump3">31.15</a>.</p>
<div class="sourceCode" id="cb1972"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_cat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">relig</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Sorting making use of `w` argument</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>relig <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">relig</span>, w <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>         relig <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump_n</a></span><span class="op">(</span><span class="va">relig</span>, n <span class="op">=</span> <span class="fl">5</span>, w <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">relig</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fctlump3"></span>
<img src="DauR_files/figure-html/fctlump3-1.png" alt="Sorting and Lumping Factors" width="672"><p class="caption">
Figure 31.15: Sorting and Lumping Factors
</p>
</div>
<hr>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="regex-in-human-readble-format-using-rebus.html"><span class="header-section-number">30</span> Regex in human readble format using rebus</a></div>
<div class="next"><a href="text-analytics-in-r.html"><span class="header-section-number">32</span> Text Analytics in R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#factors-1"><span class="header-section-number">31</span> Factors</a></li>
<li>
<a class="nav-link" href="#factors-in-base-r"><span class="header-section-number">31.1</span> Factors in base R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#creating-factors-from-scratch"><span class="header-section-number">31.1.1</span> Creating factors from scratch</a></li>
<li><a class="nav-link" href="#coercing-objects-to-factor"><span class="header-section-number">31.1.2</span> Coercing objects to factor</a></li>
<li><a class="nav-link" href="#ordfact"><span class="header-section-number">31.1.3</span> Order in factors</a></li>
</ul>
</li>
<li><a class="nav-link" href="#factors-in-forcats"><span class="header-section-number">31.2</span> Factors in forcats</a></li>
<li>
<a class="nav-link" href="#inspecting-factors"><span class="header-section-number">31.3</span> Inspecting Factors</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#summarising-factors"><span class="header-section-number">31.3.1</span> Summarising factors</a></li>
<li><a class="nav-link" href="#unique-levels-only"><span class="header-section-number">31.3.2</span> Unique levels only</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#order-in-factors"><span class="header-section-number">31.4</span> Order in Factors</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#default-ordering-in-factors"><span class="header-section-number">31.4.1</span> Default ordering in factors</a></li>
<li><a class="nav-link" href="#reordering-factors"><span class="header-section-number">31.4.2</span> Reordering factors</a></li>
<li><a class="nav-link" href="#reordering-factors-with-two-other-variables."><span class="header-section-number">31.4.3</span> Reordering factors with two other variables.</a></li>
<li><a class="nav-link" href="#changing-orders-of-few-factor-labels-only"><span class="header-section-number">31.4.4</span> Changing orders of few factor labels only</a></li>
<li><a class="nav-link" href="#infreq"><span class="header-section-number">31.4.5</span> Ordering bar charts in order of frequency</a></li>
<li><a class="nav-link" href="#reversing-the-factor-levels"><span class="header-section-number">31.4.6</span> Reversing the factor levels</a></li>
<li><a class="nav-link" href="#other-reordering"><span class="header-section-number">31.4.7</span> Other reordering</a></li>
<li><a class="nav-link" href="#more-on-ordering-factors"><span class="header-section-number">31.4.8</span> More on ordering factors</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#levels-in-factors"><span class="header-section-number">31.5</span> Levels in Factors</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#modifying-factor-levels-by-applying-a-function"><span class="header-section-number">31.5.1</span> Modifying factor levels by applying a function</a></li>
<li><a class="nav-link" href="#modifying-factor-levels-manually"><span class="header-section-number">31.5.2</span> Modifying factor levels manually</a></li>
<li><a class="nav-link" href="#lump-uncommon-factor-levels-into-other"><span class="header-section-number">31.5.3</span> Lump uncommon factor levels into other</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Audit Analytics</strong>" was written by Anil Goyal. It was last built on 2024-08-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
