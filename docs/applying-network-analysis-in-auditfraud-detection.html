<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 27 Applying network analysis in audit/fraud detection | R for Audit Analytics</title>

    <meta name="author" content="Anil Goyal" />
  
   <meta name="description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 27 Applying network analysis in audit/fraud detection | R for Audit Analytics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://anilyayavar.github.io/new-book/" />
  <meta property="og:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <meta property="og:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 27 Applying network analysis in audit/fraud detection | R for Audit Analytics" />
  
  <meta name="twitter:description" content="This book is intended for auditors performing exploratory data analytics using R programming language, mainly Base R and Tidyverse." />
  <meta name="twitter:image" content="https://anilyayavar.github.io/new-book/images/cover.jpg" />
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.8.0/transition.js"></script>
    <script src="libs/bs3compat-0.8.0/tabs.js"></script>
    <script src="libs/bs3compat-0.8.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
    <style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Audit Analytics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="applying-network-analysis-in-auditfraud-detection" class="section level1" number="27">
<h1><span class="header-section-number">Chapter 27</span> Applying network analysis in audit/fraud detection</h1>
<div id="dup_net" class="section level2" number="27.1">
<h2><span class="header-section-number">27.1</span> Use case-1: Finding network of related entities/persons - Identity Theft</h2>
<p><strong>The Following Content is Under Development.</strong></p>
<p>Imagine a scenario when users may have multiple IDs such as mobile numbers, email ids, and say some other ID issued by a Government Department say Income Tax Department (e.g. PAN number in Indian Scenario). Using techniques mentioned in section <a href="dup.html#dup">42</a>, we may easily find out duplicate users, i.e. duplicates on the basis of one ID. Sometimes need arise where we have to find out network of all the duplicate users where they have changed one or two IDs but retained another. E.g. There may be a social sector scheme where any beneficiary is expected to be registered only once for getting that scheme benefits. Scheme audit(s) may require auditors to check duplicate beneficiaries using multiple IDs.</p>
<p>Understand this with the table <a href="applying-network-analysis-in-auditfraud-detection.html#tab:gra101">27.1</a>.</p>
<table>
<caption><span id="tab:gra101">Table 27.1: </span>Dummy Data</caption>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="left">Mobile</th>
<th align="left">Email</th>
<th align="left">PAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">9111111111</td>
<td align="left"><a href="mailto:aaaa@gmail.com" class="email">aaaa@gmail.com</a></td>
<td align="left">PANNO0000A</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">9222222222</td>
<td align="left"><a href="mailto:bbbb@gmail.com" class="email">bbbb@gmail.com</a></td>
<td align="left">PANNO0000A</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">9333333333</td>
<td align="left"><a href="mailto:cccc@gmail.com" class="email">cccc@gmail.com</a></td>
<td align="left">PANNO1111B</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">9444444444</td>
<td align="left"><a href="mailto:dddd@gmail.com" class="email">dddd@gmail.com</a></td>
<td align="left">PANNO2222C</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">9111111111</td>
<td align="left"><a href="mailto:eeee@gmail.com" class="email">eeee@gmail.com</a></td>
<td align="left">PANNO3333D</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">9111111111</td>
<td align="left"><a href="mailto:ffff@gmail.com" class="email">ffff@gmail.com</a></td>
<td align="left">PANNO4444E</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">9555555555</td>
<td align="left"><a href="mailto:gggg@gmail.com" class="email">gggg@gmail.com</a></td>
<td align="left">PANNO5555F</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">9666666666</td>
<td align="left"><a href="mailto:hhhh@gmail.com" class="email">hhhh@gmail.com</a></td>
<td align="left">PANNO5555F</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">9333333333</td>
<td align="left"><a href="mailto:iiii@gmail.com" class="email">iiii@gmail.com</a></td>
<td align="left">PANNO6666G</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">9222222222</td>
<td align="left"><a href="mailto:bbbb@gmail.com" class="email">bbbb@gmail.com</a></td>
<td align="left">PANNO7777H</td>
</tr>
</tbody>
</table>
<p>It may be seen that out of ten persons, two with IDs 6 and 10 respectively share none of IDs out of Email, PAN and Telephone number. But if we see closely, ID-6 shares mobile number with ID-1 who in turn share PAN number with ID-2. ID-2 further shares both Email and Mobile number with ID-6 thus establishing a relation and a network between ID-6 and ID-10. This is clear in figure at <a href="applying-network-analysis-in-auditfraud-detection.html#fig:igraph11">27.1</a>. <em>Note that we are not considering names while finding out duplicates.</em></p>
<div class="sourceCode" id="cb1508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1508-1"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1508-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;images/canvas.png&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:igraph11"></span>
<img src="images/canvas.png" alt="Network diagram of connected entities" width="75%" />
<p class="caption">
Figure 27.1: Network diagram of connected entities
</p>
</div>
<p>We may find these duplicates using a branch of mathematics called <em>Graph Theory</em>.<a href="#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a> We won’t be discussing any core concepts of graph theory here. There are a few packages to work with graph theory concepts in R, and we will be using <code>igraph</code><span class="citation"><a href="#fn34" class="footnote-ref" id="fnref34"><sup>34</sup></a></span> for our analysis here. Let’s load the library.</p>
<div class="sourceCode" id="cb1509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1509-1"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1509-1" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code></pre></div>
<div class="sourceCode" id="cb1510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1510-1"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1510-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1510-2"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1510-2" tabindex="-1"></a>  <span class="at">MainID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb1510-3"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1510-3" tabindex="-1"></a>  <span class="at">Name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;H&quot;</span>),</span>
<span id="cb1510-4"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1510-4" tabindex="-1"></a>  <span class="at">ID1 =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">17</span>),</span>
<span id="cb1510-5"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1510-5" tabindex="-1"></a>  <span class="at">ID2 =</span> <span class="fu">c</span>(<span class="st">&quot;1a&quot;</span>, <span class="st">&quot;1b&quot;</span>,<span class="st">&quot;1b&quot;</span>, <span class="st">&quot;2a&quot;</span>, <span class="st">&quot;2b&quot;</span>, <span class="st">&quot;2c&quot;</span>, <span class="st">&quot;2c&quot;</span>, <span class="st">&quot;2e&quot;</span>, <span class="st">&quot;3a&quot;</span>),</span>
<span id="cb1510-6"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1510-6" tabindex="-1"></a>  <span class="at">ID3 =</span> <span class="fu">c</span>(<span class="st">&quot;AB&quot;</span>, <span class="st">&quot;AB&quot;</span>, <span class="st">&quot;BC&quot;</span>, <span class="st">&quot;CD&quot;</span>, <span class="st">&quot;EF&quot;</span>, <span class="st">&quot;GH&quot;</span>, <span class="st">&quot;HI&quot;</span>, <span class="st">&quot;HI&quot;</span>, <span class="st">&quot;JK&quot;</span>)</span>
<span id="cb1510-7"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1510-7" tabindex="-1"></a>)</span>
<span id="cb1510-8"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1510-8" tabindex="-1"></a><span class="co"># A preview of our sample data</span></span>
<span id="cb1510-9"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1510-9" tabindex="-1"></a>dat</span></code></pre></div>
<pre><code>##   MainID Name ID1 ID2 ID3
## 1      1    A  11  1a  AB
## 2      2    B  12  1b  AB
## 3      3    C  13  1b  BC
## 4      4    B  13  2a  CD
## 5      5    E  14  2b  EF
## 6      6    A  15  2c  GH
## 7      7    F  16  2c  HI
## 8      8    G  17  2e  HI
## 9      9    H  17  3a  JK</code></pre>
<p>Now the complete algorithm is as under-</p>
<div class="sourceCode" id="cb1512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1512-1"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-1" tabindex="-1"></a>id_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ID1&quot;</span>, <span class="st">&quot;ID2&quot;</span>, <span class="st">&quot;ID3&quot;</span>)</span>
<span id="cb1512-2"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-2" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb1512-3"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">all_of</span>(id_cols), as.character)) <span class="sc">%&gt;%</span> </span>
<span id="cb1512-4"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(id_cols), </span>
<span id="cb1512-5"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-5" tabindex="-1"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1512-6"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-6" tabindex="-1"></a>  <span class="fu">select</span>(MainID, value) <span class="sc">%&gt;%</span> </span>
<span id="cb1512-7"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-7" tabindex="-1"></a>  <span class="fu">graph_from_data_frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1512-8"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-8" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1512-9"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-9" tabindex="-1"></a>  <span class="fu">pluck</span>(membership) <span class="sc">%&gt;%</span></span>
<span id="cb1512-10"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-10" tabindex="-1"></a>  <span class="fu">stack</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1512-11"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-11" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">&#39;UNIQUE_ID&#39;</span>, <span class="st">&#39;MainID&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1512-12"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-12" tabindex="-1"></a>  <span class="fu">right_join</span>(dat <span class="sc">%&gt;%</span> </span>
<span id="cb1512-13"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-13" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">MainID =</span> <span class="fu">as.factor</span>(MainID)), </span>
<span id="cb1512-14"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1512-14" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;MainID&#39;</span>))</span></code></pre></div>
<pre><code>##   UNIQUE_ID MainID Name ID1 ID2 ID3
## 1         1      1    A  11  1a  AB
## 2         1      2    B  12  1b  AB
## 3         1      3    C  13  1b  BC
## 4         1      4    B  13  2a  CD
## 5         2      5    E  14  2b  EF
## 6         3      6    A  15  2c  GH
## 7         3      7    F  16  2c  HI
## 8         3      8    G  17  2e  HI
## 9         3      9    H  17  3a  JK</code></pre>
<p>We may see that we have got unique ID of users based on all three IDs. Let us understand the algorithm used step by step.</p>
<p><strong>Step-1</strong>: First we have to ensure that all the ID columns (Store names of these columns in one vector say <code>id_cols</code>) must be of same type. Since we had a mix of character (Alphanumeric) and numeric IDs, using <code>dplyr::across</code> with <code>dplyr::mutate</code> we can convert all the three ID columns to character type. Readers may refer to section <a href="r-programming-language.html#vectors">1.4.1</a> for type change, and section <a href="DPLYRR.html#across">14.14</a> for changing data type of multiple columns simultaneously using <code>dplyr::across</code>.</p>
<p>Thus, first two lines of code above correspond to this step only.</p>
<pre><code>id_cols &lt;- c(&quot;ID1&quot;, &quot;ID2&quot;, &quot;ID3&quot;)
dat %&gt;%
  mutate(across(.cols = id_cols, as.character))</code></pre>
<p><strong>Step-2</strong>: Pivot all id columns to longer format so that all Ids are linked with one main ID. Now two things should be kept in mind. One that there should be a main_Id column in the data frame. If not create one using <code>dplyr::row_number()</code> before pivoting. Secondly, if there are <code>NA</code>s in any of the IDs these have to be removed while pivoting. Use argument <code>values_drop_na = TRUE</code> inside the <code>tidyr::pivot_longer</code>. Thus, this step will correspond to this line-</p>
<pre><code>pivot_longer(cols = all_of(id_cols), values_drop_na = TRUE)</code></pre>
<p>where - first argument data is invisibly passed through dplyr pipe i.e. <code>%&gt;%</code>. Upto this step, our data frame will look like -</p>
<pre><code>## # A tibble: 27 × 4
##    MainID Name  name  value
##     &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
##  1      1 A     ID1   11   
##  2      1 A     ID2   1a   
##  3      1 A     ID3   AB   
##  4      2 B     ID1   12   
##  5      2 B     ID2   1b   
##  6      2 B     ID3   AB   
##  7      3 C     ID1   13   
##  8      3 C     ID2   1b   
##  9      3 C     ID3   BC   
## 10      4 B     ID1   13   
## # ℹ 17 more rows</code></pre>
<p><strong>Step-3:</strong> Now we need only two columns, one is <code>mainID</code> and another is <code>value</code> which is created by pivoting all ID columns. We will use <code>select(MainID, value)</code> for that.</p>
<p><strong>Step-4:</strong> Thereafter we will create a graph object from this data (output after step-3), using <code>igraph</code> package. Interested readers may see how the graph object will look like, using <code>plot()</code> function. The output is shown in figure <a href="applying-network-analysis-in-auditfraud-detection.html#fig:igraph2">27.2</a>. <strong>However, this step is entirely optional and it may also be kept in mind that graph output of large data will be highly cluttered and may not be comprehensible at all.</strong></p>
<div class="sourceCode" id="cb1517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1517-1"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1517-1" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb1517-2"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1517-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">all_of</span>(id_cols), as.character)) <span class="sc">%&gt;%</span> </span>
<span id="cb1517-3"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1517-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(id_cols), </span>
<span id="cb1517-4"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1517-4" tabindex="-1"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1517-5"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1517-5" tabindex="-1"></a>  <span class="fu">select</span>(MainID, value) <span class="sc">%&gt;%</span> </span>
<span id="cb1517-6"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1517-6" tabindex="-1"></a>  <span class="fu">graph_from_data_frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1517-7"><a href="applying-network-analysis-in-auditfraud-detection.html#cb1517-7" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:igraph2"></span>
<img src="DauR_files/figure-html/igraph2-1.png" alt="Plot of graph object" width="672" />
<p class="caption">
Figure 27.2: Plot of graph object
</p>
</div>
<p><strong>Step-5:</strong> This step will be a combination of three lines of codes which will number each ID based on connectivity of all components in the graph objects. Actually <code>components</code> will give us an object where <code>$membership</code> will give us <code>unique_ids</code> for each component in the graph.</p>
<pre><code>## $membership
##  1  2  3  4  5  6  7  8  9 11 1a AB 12 1b 13 BC 2a CD 14 2b EF 15 2c GH 16 HI 
##  1  1  1  1  2  3  3  3  3  1  1  1  1  1  1  1  1  1  2  2  2  3  3  3  3  3 
## 17 2e 3a JK 
##  3  3  3  3 
## 
## $csize
## [1] 13  4 13
## 
## $no
## [1] 3</code></pre>
<p>Next we have to <code>purrr::pluck</code>, <code>$membership</code> only from this object, which will return a named vector.</p>
<pre><code>##  1  2  3  4  5  6  7  8  9 11 1a AB 12 1b 13 BC 2a CD 14 2b EF 15 2c GH 16 HI 
##  1  1  1  1  2  3  3  3  3  1  1  1  1  1  1  1  1  1  2  2  2  3  3  3  3  3 
## 17 2e 3a JK 
##  3  3  3  3</code></pre>
<p>We can then <code>stack</code> this named vector into a data frame using <code>stack</code> and <code>set_names</code></p>
<pre><code>##    UNIQUE_ID MainID
## 1          1      1
## 2          1      2
## 3          1      3
## 4          1      4
## 5          2      5
## 6          3      6
## 7          3      7
## 8          3      8
## 9          3      9
## 10         1     11
## 11         1     1a
## 12         1     AB
## 13         1     12
## 14         1     1b
## 15         1     13
## 16         1     BC
## 17         1     2a
## 18         1     CD
## 19         2     14
## 20         2     2b
## 21         2     EF
## 22         3     15
## 23         3     2c
## 24         3     GH
## 25         3     16
## 26         3     HI
## 27         3     17
## 28         3     2e
## 29         3     3a
## 30         3     JK</code></pre>
<p>I suggest to purposefully name second column in the output data as <code>MainID</code> so that it can be joined with original data frame in the last step. <code>UNIQUE_ID</code> in this data will give us the new column which will allocate same ID to all possible duplicates in network of three IDs.</p>
<p><strong>Step-6:</strong> In the last step we have to join the data frame back to original data frame. Since the type of <code>MainID</code> is now factor type, we can convert type of this column in original data frame before <code>right_join</code> the same. Hence the final step, <code>right_join(dat %&gt;% mutate(MainID = as.factor(MainID)), by = c('MainID'))</code>.</p>
</div>
<div id="use-case-2-classification-using-graph-theory" class="section level2" number="27.2">
<h2><span class="header-section-number">27.2</span> Use case-2: Classification using graph theory</h2>
<p><em>The Content is Under Development.</em></p>
</div>
<div id="use-case-3-finding-circular-transactions" class="section level2" number="27.3">
<h2><span class="header-section-number">27.3</span> Use case-3: Finding circular transactions</h2>
<p><em>The Content is Under Development.</em></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="33">
<li id="fn33"><p><a href="https://en.wikipedia.org/wiki/Graph_theory">https://en.wikipedia.org/wiki/Graph_theory</a><a href="applying-network-analysis-in-auditfraud-detection.html#fnref33" class="footnote-back">↩︎</a></p></li>
<li id="fn34"><p>Gábor Csárdi et al., <em>Igraph: Network Analysis and Visualization</em>, 2024, <a href="https://r.igraph.org/">https://r.igraph.org/</a>.<a href="applying-network-analysis-in-auditfraud-detection.html#fnref34" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Audit Analytics</strong>" was written by Anil Goyal. It was last built on 2024-11-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
